import{j as t,g as le,r as c,c as ne}from"./index-24976792.js";let re=[{label:"File"},{label:"Edit"},{label:"View"},{label:"Insert"},{label:"Format"},{label:"Data"},{label:"Tools"},{label:"Extensions"},{label:"Help"}];const oe=()=>{const f=j=>{console.log(j.target.innerText)};return t.jsxs("div",{className:"bg-light-silver h-[var(--toolbar-height)]",children:[t.jsxs("div",{className:"flex items-center h-[65px]",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{className:"w-[60px] h-[42px]",src:le("/logo.png")}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-dark-gray font-medium text-base border border-transparent px-1 outline-none rounded-sm hover:border-gray-500 focus:border-gray-500",contentEditable:!0,onInput:f,dangerouslySetInnerHTML:{__html:"Untitled Spreadsheet"}}),t.jsx("i",{className:"icon-star-outline"}),t.jsx("i",{className:"icon-folder-move-outline"}),t.jsx("i",{className:"icon-cloud-check-outline"})]}),t.jsx("div",{className:"flex gap-1",children:re.map(({label:j},g)=>t.jsx("button",{className:"px-2 bg-transparent transition-background duration-100 hover:bg-light-gray text-[15px] rounded",children:j},g))})]})]}),t.jsx("div",{className:""})]}),t.jsx("div",{className:"flex items-center h-[45px] px-2 mx-[15px] rounded-full",children:"Toolbar"})]})},se=()=>t.jsxs("div",{className:"flex gap-2 px-2 items-center h-[var(--typing-bar-height)]",children:[t.jsx("input",{name:"id",className:"outline-none w-[100px] px-2 bg-transparent text-sm border-2 rounded-sm border-transparent hover:bg-[#ededed] focus:border-dark-blue"}),t.jsx("div",{className:"w-[2px] bg-[#dadce0] h-[50%] border-none"}),t.jsxs("div",{className:"flex items-center w-full",children:[t.jsx("i",{className:"icon-format-text text-[#a8a9a9] font-bold"}),t.jsx("input",{name:"content",className:"w-full border-none outline-none bg-transparent px-2 text-sm"})]})]}),ie=({cell:f,onDoubleClick:j})=>{let{columnId:g,height:n,id:v,rowId:y,width:b,x:u,y:h}=f;const k=p=>{p.stopPropagation()};return t.jsxs(c.Fragment,{children:[t.jsx("div",{className:"absolute flex text-sm bg-transparent border-2 border-blue p-1",style:{left:u,top:h,width:b,height:n},onClick:k,onDoubleClick:j}),t.jsx("div",{className:"absolute flex justify-center items-center top-0 h-[var(--row-height)] bg-light-blue border border-light-gray",style:{left:u,width:b},children:t.jsx("span",{className:"text-xs font-medium",children:g})}),t.jsx("div",{className:"absolute flex justify-center items-center left-0 w-[var(--col-width)] bg-light-blue border border-light-gray",style:{top:h,height:n},children:t.jsx("span",{className:"text-xs font-medium",children:y})})]})},ae=({cell:f,data:j,onWheel:g})=>{c.useRef(null);let{x:n,y:v,rowId:y,height:b,id:u,columnId:h,width:k}=f,{color:p,backgroundColor:R="white",content:C=""}=j??{};const a=m=>{m.stopPropagation()},w=m=>{m&&m.focus()};return t.jsxs("div",{className:"absolute flex border-2 border-dark-blue outline outline-3 outline-light-blue p-1 z-10",style:{width:k,height:b,left:n,top:v,backgroundColor:R},onClick:a,onWheel:g,children:[t.jsx("div",{ref:w,className:"w-full h-full outline-none text-xs",contentEditable:!0,dangerouslySetInnerHTML:{__html:C}}),t.jsx("div",{className:"absolute -top-7 left-0 bg-blue text-xs font-medium text-white rounded-sm px-2 py-1",children:u})]})},de=({columns:f,onClick:j,onResize:g})=>{const[n,v]=c.useState(null),[y,b]=c.useState(!1),u=c.useRef(null),h=c.useRef(null),k=a=>{!u.current||!n||(h.current=a.pageX,u.current.setPointerCapture(a.pointerId),u.current.addEventListener("pointermove",p),u.current.addEventListener("pointerup",R,{once:!0}),b(!0))},p=a=>{if(!u.current||!h.current||!n)return;let{pageX:w}=a,m=n.width+-(h.current-w);m<50||v({...n,width:m})},R=a=>{if(!u.current||!n||!h.current)return;let{pageX:w}=a;u.current.removeEventListener("pointermove",p);let m=n.width+-(h.current-w);g(n.id,Math.max(50,m)),h.current=null,v(null),b(!1)},C=a=>{v({...a})};return t.jsxs(c.Fragment,{children:[t.jsxs("div",{className:"absolute left-0 top-0 w-full h-[var(--row-height)]",children:[f.map(a=>{let{x:w,height:m,columnId:M,id:P,width:z,y:S}=a;return t.jsx("div",{className:"absolute",style:{width:z,height:m,left:w,top:S},onClick:()=>j(P),children:t.jsx("div",{className:"absolute top-0 -right-3 w-6 h-full bg-transparent",onMouseEnter:()=>C(a)})},M)}),n&&t.jsx(c.Fragment,{children:t.jsxs("div",{ref:u,className:"absolute flex gap-[5px] items-center h-full cursor-col-resize",style:{left:n.x+n.width-6,top:0},onPointerDown:k,children:[t.jsx("div",{className:"bg-black rounded-md w-[3px]",style:{height:n.height-8}}),t.jsx("div",{className:"bg-black rounded-md w-[3px]",style:{height:n.height-8}})]})})]}),n&&y&&t.jsx("div",{className:"absolute w-[3px] h-full bg-slate-400",style:{left:n.x+n.width-2,top:0}})]})},ce={rows:{1:{height:200},2:{height:35},3:{height:39},4:{height:50},5:{height:128},6:{height:77},7:{height:99},13:{height:100},15:{height:35},33:{height:39},24:{height:50},45:{height:128},50:{height:150},66:{height:77},37:{height:99}},columns:{A:{width:150},B:{width:175},C:{width:220},E:{width:270},I:{width:125}},cells:{B50:{backgroundColor:"#CADAF8",color:"white",content:"<span>Loreum Ispum</span>"},A1:{content:"Loreum Ispum Loreum Ispum",backgroundColor:"#EA9999",color:"white"},B4:{backgroundColor:"#B7E1CD",content:"<b>Loreum Ispum</b>"},C6:{backgroundColor:"#CADAF8",content:"<span>Loreum Ispum</span>"},E5:{content:"Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#FEE599"},H2:{content:"Lorem Ipsum",backgroundColor:"#B3A7D6"},F12:{backgroundColor:"#FFF2CC",content:"<b>Loreum Ispum</b>"},D25:{backgroundColor:"#B7B7B7",content:"<span>Loreum</span>"},C9:{content:"Loreum Ispum"},E80:{content:"Loreum Ispum",backgroundColor:"#766CEB",color:"white"}}},ue=({rows:f,onClick:j,onResize:g})=>{const[n,v]=c.useState(null),[y,b]=c.useState(!1),u=c.useRef(null),h=c.useRef(null),k=a=>{!u.current||!n||(h.current=a.pageY,u.current.setPointerCapture(a.pointerId),u.current.addEventListener("pointermove",p),u.current.addEventListener("pointerup",R,{once:!0}),b(!0))},p=a=>{if(!u.current||!h.current||!n)return;let{pageY:w}=a,m=n.height+-(h.current-w);m<=25||v({...n,height:m})},R=a=>{if(!u.current||!n||!h.current)return;let{pageY:w}=a;u.current.removeEventListener("pointermove",p);let m=n.height+-(h.current-w);g(n.id,Math.max(25,m)),h.current=null,v(null),b(!1)},C=a=>{v({...a})};return t.jsxs(c.Fragment,{children:[t.jsxs("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-full",children:[f.map(a=>{let{x:w,height:m,rowId:M,id:P,width:z,y:S}=a;return t.jsx("div",{className:"absolute",style:{width:z,height:m,left:w,top:S},onClick:()=>j(P),children:t.jsx("div",{className:"absolute left-0 -bottom-3 w-full h-6 bg-transparent",onMouseEnter:()=>C(a)})},M)}),n&&t.jsx(c.Fragment,{children:t.jsxs("div",{ref:u,className:"absolute flex flex-col items-center gap-[5px] w-full cursor-row-resize",style:{left:0,top:n.y+n.height-6},onPointerDown:k,children:[t.jsx("div",{className:"bg-black rounded-md h-[3px]",style:{width:n.width/2}}),t.jsx("div",{className:"bg-black rounded-md h-[3px]",style:{width:n.width/2}})]})})]}),n&&y&&t.jsx("div",{className:"absolute h-[3px] w-full bg-slate-400",style:{left:0,top:n.y+n.height-2}})]})},T=46,B=25,H={width:100,height:25},he=()=>{const[f,j]=c.useState([]),[g,n]=c.useState([]),[v,y]=c.useState({}),[b,u]=c.useState(""),[h,k]=c.useState(null),[p,R]=c.useState(ce),C=c.useRef(null),a=c.useRef(null),w=c.useMemo(()=>v[b],[f,g,b]);c.useEffect(()=>{m()},[p]),c.useEffect(()=>(window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m)}),[f,g,p]);const m=()=>{if(!C.current||!a.current)return;let{clientWidth:e,clientHeight:o}=C.current,l=a.current;l.width=e,l.height=o;let{rowId:d=1,y:s=B}=f[0]??{},{columnId:i=1,x:r=T}=g[0]??{};S({offsetX:r,offsetY:s,rowStart:d,colStart:i})},M=(e,{height:o,id:l,rowId:d,width:s,x:i,y:r})=>{e.save(),e.clearRect(i,r,s,o),e.beginPath(),e.moveTo(i+s,r),e.lineTo(i+s,r+o),e.lineTo(i,r+o),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.beginPath(),e.textAlign="center",e.textBaseline="middle",e.font="12px Open-Sans",e.fillStyle="#575a5a",e.fillText(l,i+s/2,r+o/2),e.restore()},P=(e,{columnId:o,height:l,id:d,width:s,x:i,y:r})=>{e.save(),e.clearRect(i,r,s,l),e.beginPath(),e.moveTo(i,r),e.lineTo(i+s,r),e.lineTo(i+s,r+l),e.lineTo(i,r+l),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.textAlign="center",e.textBaseline="middle",e.font="12px Open-Sans",e.fillStyle="#575a5a",e.fillText(d,i+s/2,r+l/2),e.restore()},z=(e,{id:o,rowId:l,columnId:d,height:s,width:i,x:r,y:N})=>{let{backgroundColor:D,color:F,content:A}=p.cells[o]??{};e.save(),e.clearRect(r,N,i,s),e.beginPath(),e.moveTo(r,N+s),e.lineTo(r+i,N+s),e.lineTo(r+i,N),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),D&&(e.fillStyle=D,e.beginPath(),e.moveTo(r,N),e.fillRect(r,N,i,s),e.fill()),e.restore()},S=({offsetX:e,offsetY:o,rowStart:l,colStart:d})=>{var G,U;if(!a.current)return;let s=a.current,{clientWidth:i,clientHeight:r}=s,N=s.getContext("2d"),D=[],F=[],A={};for(let x=l,I=o;I<r;x++){let E=((G=p.rows[x])==null?void 0:G.height)||H.height;I+E>B&&D.push({y:I,x:0,id:`${x}`,rowId:x,height:E,width:T}),I+=E}for(let x=d,I=e;I<i;x++){let E=ne(x),L=((U=p.columns[E])==null?void 0:U.width)||H.width;I+L>T&&F.push({x:I,y:0,id:E,columnId:x,width:L,height:B}),I+=L}for(let{id:x,height:I,y:E}of D)for(let{id:L,width:ee,x:te}of F){let W=`${L}${x}`;A[W]={id:W,x:te,y:E,rowId:x,columnId:L,width:ee,height:I},z(N,A[W])}for(let x of D)M(N,x);for(let x of F)P(N,x);j(D),n(F),y(A)},X=e=>{if(!C.current)return;let o=e.pageX,l=e.pageY-C.current.getBoundingClientRect().top,d=_(o,l);d&&(u(d),k(null))},_=(e,o)=>{let l=0,d=f.length-1,s=null;for(;l<d;){let r=Math.floor((l+d)/2);f[r].y<=o?(l=r+1,s=f[r].id):d=r}if(!s)return null;l=0,d=g.length-1;let i=null;for(;l<d;){let r=Math.floor((l+d)/2);g[r].x<=e?(l=r+1,i=g[r].id):d=r}return i?i+s:null},$=e=>{var i;if(!f.length||!g.length)return;let{rowId:o,y:l}=f[0],{columnId:d,x:s}=g[0];if(e<0){for(l+=-e,o--;o>0&&l>B;)l-=((i=p.rows[o])==null?void 0:i.height)??H.height,o--;S({offsetX:s,offsetY:Math.min(B,l),rowStart:o+1,colStart:d})}else S({offsetX:s,offsetY:l+-e,rowStart:o,colStart:d})},O=e=>{var i;if(!f.length||!g.length)return;let{rowId:o,y:l}=f[0],{columnId:d,x:s}=g[0];if(e<0){for(s+=-e,d--;d>0&&s>T;)s-=((i=p.columns[d])==null?void 0:i.width)??H.width,d--;S({offsetX:Math.min(T,s),offsetY:l,rowStart:o,colStart:d+1})}else S({offsetX:s+-e,offsetY:l,rowStart:o,colStart:d})},Y=e=>{let{deltaX:o,deltaY:l}=e;o===0?$(l):O(o)},V=()=>{if(!C.current||!b||!v[b])return;let{columnId:e,id:o,width:l,height:d,rowId:s,x:i,y:r}=v[b],{top:N}=C.current.getBoundingClientRect();k({columnId:e,id:o,width:l,height:d,rowId:s,x:Math.max(T,i),y:Math.max(B+N,r+N)})},q=e=>{e.preventDefault(),X(e)},J=e=>{console.log(e)},K=e=>{console.log(e)},Q=(e,o)=>{let l={...p};l.columns[e]||(l.columns[e]={}),l.columns[e].width=o,R(l)},Z=(e,o)=>{let l={...p};l.rows[e]||(l.columns[e]={}),l.rows[e].height=o,R(l)};return t.jsxs(c.Fragment,{children:[t.jsxs("div",{ref:C,className:"relative h-[var(--grid-height)] select-none overflow-hidden",onClick:X,onContextMenu:q,onWheel:Y,children:[t.jsx("canvas",{ref:a,className:"relative"}),!h&&w&&t.jsx(ie,{cell:w,onDoubleClick:V}),t.jsx(de,{columns:g,onClick:J,onResize:Q}),t.jsx(ue,{rows:f,onClick:K,onResize:Z}),t.jsx("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-[var(--row-height)] border border-light-gray bg-white z-10 after:absolute after:right-0 after:h-full after:w-1 after:bg-dark-silver before:absolute before:bottom-0 before:w-full before:h-1 before:bg-dark-silver"})]}),h&&t.jsx(ae,{cell:h,data:p.cells[h.id],onWheel:Y})]})},me=()=>t.jsx("div",{className:"fixed left-0 bottom-0 w-full h-[var(--bottom-bar-height)] bg-light-silver border-t border-mild-silver",children:"Bottom Bar"}),ge=()=>t.jsxs(c.Fragment,{children:[t.jsx(oe,{}),t.jsx(se,{}),t.jsx(he,{}),t.jsx(me,{})]});export{ge as default};
