import{j as i,r as h,t as V}from"./index-745db12b.js";const Z="_container_bkn9l_1",q={container:Z},ee=()=>i.jsx("div",{className:q.container,children:"Header"}),te="_container_szppa_1",re={container:te},ne=()=>i.jsx("div",{className:re.container,children:"Toolbar"}),ie="_container_19fs4_1",le="_id_field_19fs4_8",oe="_content_field_19fs4_25",se="_seperator_19fs4_40",j={container:ie,id_field:le,content_field:oe,seperator:se},ae=()=>i.jsxs("div",{className:j.container,children:[i.jsx("div",{className:j.id_field,children:i.jsx("input",{name:"id"})}),i.jsx("div",{className:j.seperator}),i.jsxs("div",{className:j.content_field,children:[i.jsx("i",{className:"bx-text"}),i.jsx("input",{name:"content"})]})]}),he={meta:{totalRows:50,dimension:{width:26*100,height:100*25},columnIds:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]},rows:{50:{height:250},1:{height:100},2:{height:35},3:{height:39},4:{height:50},5:{height:128},6:{height:77},7:{height:99},13:{height:100},15:{height:35},33:{height:39},24:{height:50},45:{height:128},66:{height:77},37:{height:99}},columns:{A:{width:150},B:{width:175},C:{width:220},E:{width:270},H:{width:125}},cells:{A1:{text:"Loreum Ispum",backgroundColor:"#EA9999",color:"white"},B4:{text:"Loreum Ispum",backgroundColor:"#B7E1CD"},C6:{text:"Loreum Ispum",backgroundColor:"#CADAF8"},E5:{text:"Loreum Ispum",backgroundColor:"#FEE599"},H2:{text:"Loreum Ispum",backgroundColor:"#B3A7D6"},F12:{text:"Loreum Ispum",backgroundColor:"#FFF2CC"},D25:{text:"Loreum Ispum",backgroundColor:"#B7B7B7"},C9:{text:"Loreum Ispum"},E80:{text:"Loreum Ispum",backgroundColor:"#766CEB",color:"white"}}},de="_container_y6wec_1",ue={container:de};let l={width:100,height:25},b=3;const ce=()=>{let f=h.useRef(null),d=h.useRef(null),p=h.useRef(null),I=h.useRef([]),u=h.useRef([]),c=h.useRef([]),E=h.useRef(!1),A=h.useRef(!1);h.useEffect(()=>{if(z(),!!p.current)return B({rowStart:1,colStart:1}),window.addEventListener("resize",G),()=>{window.addEventListener("resize",G)}},[]);let G=()=>{if(!f.current||!d.current)return;let{clientWidth:e,clientHeight:r}=f.current;d.current.width=e,d.current.height=r;let t=+u.current[0].id,n=+c.current[0].id;B({rowStart:t,colStart:n})},x=e=>{e.clearRect(0,0,l.width/2,l.height),w(e),e.beginPath(),e.moveTo(0,l.height),e.lineTo(l.width/2,l.height),e.lineTo(l.width/2,1),e.lineTo(0,1),e.stroke(),_(e)},z=()=>{if(!f.current||!d.current)return;let{clientWidth:e,clientHeight:r}=f.current,t=d.current,n=t.getContext("2d");n&&(p.current=n,t.width=e,t.height=r)},M=(e,{x:r,width:t,id:n})=>{w(e),e.beginPath(),e.moveTo(r,1),e.lineTo(r+t,1),e.lineTo(r+t,l.height),e.lineTo(r,l.height),e.fillText(n,r+t/2,l.height/2),e.stroke(),_(e)},W=(e,{x:r,y:t,height:n,id:o})=>{w(e),e.beginPath(),e.moveTo(r,t+n),e.lineTo(l.width/2,t+n),e.fillText(o,l.width/4,t+n/2),e.stroke(),_(e)},X=e=>{e.fillStyle="#000000",e.font="10px sans-serif",e.textAlign="start",e.textBaseline="alphabetic"},w=e=>{e.strokeStyle="silver",e.fillStyle="#566164",e.font="14px Poppins",e.textAlign="center",e.textBaseline="middle"},_=e=>{e.strokeStyle="#000000",e.fillStyle="#000000",e.font="10px sans-serif",e.textAlign="start",e.textBaseline="alphabetic"},Y=(e,{x:r,y:t,width:n,height:o})=>{w(e),e.beginPath(),e.moveTo(r,t),e.lineTo(r,t+o),e.lineTo(r+n,t+o),e.stroke(),_(e)},J=(e,r,t)=>{if(Y(e,r),!t)return;let{x:n,y:o,width:s,height:a}=r,{text:g,color:T,backgroundColor:C}=t;e.font="14px Poppins",e.textBaseline="middle",C&&(e.beginPath(),e.fillStyle=C||"#000000",e.fillRect(n,o,s,a),e.fill()),g&&(e.beginPath(),e.fillStyle=T||"#000000",e.fillText(g,n+5,o+a-10),e.fill()),X(e)},B=({colStart:e,rowStart:r})=>{var $,P;let t=p.current;if(!t)return;let n=t.canvas.width,o=t.canvas.height,s=l.height;I.current=[],u.current=[],c.current=[],t.clearRect(0,0,n,o);let{meta:{columnIds:a,totalRows:g},rows:T,columns:C,cells:Q}=he,N=!1;for(let S=r;S<=g&&s<o;S++){let L=S.toString(),y=(($=T[L])==null?void 0:$.height)||l.height,m=l.width/2,D={x:0,y:s,height:y,id:L};W(t,D),u.current.push(D);for(let v=e;v<=a.length&&m<n;v++){let k=a[v-1],F=`${k}${L}`,R=((P=C[k])==null?void 0:P.width)||l.width,U=Q[F],H={x:m,y:s,width:R,height:y,id:F};I.current.push(H),J(t,H,U),N||(M(t,{x:m,width:R,id:k}),c.current.push({x:m,width:R,id:v.toString(),y:0})),m+=R}s+=y,N=!0}x(t),u.current.length&&(E.current=+u.current.at(-1).id===g),c.current.length&&(A.current=+c.current.at(-1).id===a.length)};const K=e=>{if(!p.current)return;let{deltaY:t,deltaX:n}=e,o=t===0?"left":"top",s=+u.current[0].id,a=+c.current[0].id;if(o==="top"){if(t>0&&E.current)return;s=Math.max(1,t>0?s+b:s-b)}else{if(n>0&&A.current)return;a=Math.max(1,n>0?a+b:a-b)}B({rowStart:s,colStart:a})},O=e=>{e.preventDefault()};return i.jsx("div",{ref:f,className:ue.container,onContextMenu:O,onWheel:V(K,50),children:i.jsx("canvas",{ref:d})})},fe="_container_1hzjj_1",ge={container:fe},me=()=>i.jsx("div",{className:ge.container,children:"Bottom Bar"}),we=()=>i.jsxs(h.Fragment,{children:[i.jsx(ee,{}),i.jsx(ne,{}),i.jsx(ae,{}),i.jsx(ce,{}),i.jsx(me,{})]});export{we as default};
