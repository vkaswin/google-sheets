import{j as t,g as ae,r as d,c as W}from"./index-aa798c3b.js";let de=[{label:"File"},{label:"Edit"},{label:"View"},{label:"Insert"},{label:"Format"},{label:"Data"},{label:"Tools"},{label:"Extensions"},{label:"Help"}];const ce=()=>{const h=b=>{console.log(b.target.innerText)};return t.jsxs("div",{className:"bg-light-silver h-[var(--toolbar-height)]",children:[t.jsxs("div",{className:"flex items-center h-[65px]",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{className:"w-[60px] h-[42px]",src:ae("/logo.png")}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-dark-gray font-medium text-base border border-transparent px-1 outline-none rounded-sm hover:border-gray-500 focus:border-gray-500",contentEditable:!0,onInput:h,dangerouslySetInnerHTML:{__html:"Untitled Spreadsheet"}}),t.jsx("i",{className:"icon-star-outline"}),t.jsx("i",{className:"icon-folder-move-outline"}),t.jsx("i",{className:"icon-cloud-check-outline"})]}),t.jsx("div",{className:"flex gap-1",children:de.map(({label:b},m)=>t.jsx("button",{className:"px-2 bg-transparent transition-background duration-100 hover:bg-light-gray text-[15px] rounded",children:b},m))})]})]}),t.jsx("div",{className:""})]}),t.jsx("div",{className:"flex items-center h-[45px] px-2 mx-[15px] rounded-full",children:"Toolbar"})]})},ue=()=>t.jsxs("div",{className:"flex gap-2 px-2 items-center h-[var(--typing-bar-height)]",children:[t.jsx("input",{name:"id",className:"outline-none w-[100px] px-2 bg-transparent text-sm border-2 rounded-sm border-transparent hover:bg-[#ededed] focus:border-dark-blue"}),t.jsx("div",{className:"w-[2px] bg-[#dadce0] h-[50%] border-none"}),t.jsxs("div",{className:"flex items-center w-full",children:[t.jsx("i",{className:"icon-format-text text-[#a8a9a9] font-bold"}),t.jsx("input",{name:"content",className:"w-full border-none outline-none bg-transparent px-2 text-sm"})]})]}),he=({selectedGrid:{cell:h,column:b,row:m},onDoubleClick:i})=>{let{columnId:I,height:R,cellId:v,rowId:f,width:g,x:y,y:j}=h;return t.jsxs(d.Fragment,{children:[t.jsx("div",{className:"absolute flex text-sm bg-transparent border-2 border-blue p-1",style:{left:y,top:j,width:g,height:R},onDoubleClick:i}),t.jsx("div",{className:"absolute top-0 h-[var(--row-height)] bg-light-blue border border-light-gray",style:{left:y,width:g},children:t.jsx("span",{className:"absolute text-xs font-medium",style:{left:b.width/2-5,top:b.height/2-10},children:W(I)})}),t.jsx("div",{className:"absolute left-0 w-[var(--col-width)] bg-light-blue border border-light-gray",style:{top:j,height:R},children:t.jsx("span",{className:"absolute text-xs font-medium",style:{left:m.width/2-5,top:m.height/2-10},children:f})})]})},me=({cell:h,data:b,onWheel:m})=>{const i=d.useRef(null);let{x:I,y:R,rowId:v,height:f,columnId:g,width:y}=h,{color:j="#000000",backgroundColor:E="#FFFFFF",html:C=""}=b??{};d.useEffect(()=>{i.current&&a(i.current)},[h]);const a=p=>{let c=window.getSelection();if(!c)return;let w=document.createRange();w.setStart(p,p.childNodes.length),w.collapse(!0),c.removeAllRanges(),c.addRange(w)};return t.jsxs("div",{className:"absolute flex border-1 outline outline-3 outline-light-blue p-[2px] z-10",style:{width:y,height:f,left:I,top:R,backgroundColor:E,color:j},onWheel:m,children:[t.jsx("div",{ref:i,className:"w-full h-full text-sm outline outline-2 outline-dark-blue p-[2px]",contentEditable:!0,dangerouslySetInnerHTML:{__html:C}}),t.jsxs("div",{className:"absolute -top-7 left-0 bg-blue text-xs font-medium text-white rounded-sm px-2 py-1",children:[W(g),v]})]})},fe=({columns:h,onClick:b,onResize:m})=>{const[i,I]=d.useState(null),[R,v]=d.useState(!1),f=d.useRef(null),g=d.useRef(null),y=a=>{!f.current||!i||(g.current=a.pageX,f.current.setPointerCapture(a.pointerId),f.current.addEventListener("pointermove",j),f.current.addEventListener("pointerup",E,{once:!0}),v(!0))},j=a=>{if(!f.current||!g.current||!i)return;let{pageX:p}=a,c=i.width+-(g.current-p);c<50||I({...i,width:c})},E=a=>{if(!f.current||!i||!g.current)return;let{pageX:p}=a;f.current.removeEventListener("pointermove",j);let c=i.width+-(g.current-p);m(i.columnId,Math.max(50,c)),g.current=null,I(null),v(!1)},C=a=>{I({...a})};return t.jsxs(d.Fragment,{children:[t.jsx("div",{className:"absolute left-0 top-0 w-full h-[var(--row-height)]",children:h.map(a=>{let{x:p,height:c,columnId:w,width:D,y:F}=a;return t.jsx("div",{className:"absolute",style:{width:D,height:c,left:p,top:F},onClick:()=>b(w),children:t.jsx("div",{className:"absolute top-0 -right-3 w-6 h-full bg-transparent",onMouseEnter:()=>C(a)})},w)})}),i&&t.jsxs(d.Fragment,{children:[t.jsxs("div",{ref:f,className:"absolute flex gap-[5px] items-center cursor-col-resize",style:{left:i.x+i.width-6,top:0,height:i.height},onPointerDown:y,children:[t.jsx("div",{className:"bg-black rounded-md w-[3px]",style:{height:i.height-8}}),t.jsx("div",{className:"bg-black rounded-md w-[3px]",style:{height:i.height-8}})]}),R&&t.jsx("div",{className:"absolute w-[3px] h-full bg-slate-400 z-30",style:{left:i.x+i.width-2,top:0}})]})]})},ge=({rows:h,onClick:b,onResize:m})=>{const[i,I]=d.useState(null),[R,v]=d.useState(!1),f=d.useRef(null),g=d.useRef(null),y=a=>{!f.current||!i||(g.current=a.pageY,f.current.setPointerCapture(a.pointerId),f.current.addEventListener("pointermove",j),f.current.addEventListener("pointerup",E,{once:!0}),v(!0))},j=a=>{if(!f.current||!g.current||!i)return;let{pageY:p}=a,c=i.height+-(g.current-p);c<=25||I({...i,height:c})},E=a=>{if(!f.current||!i||!g.current)return;let{pageY:p}=a;f.current.removeEventListener("pointermove",j);let c=i.height+-(g.current-p);m(i.rowId,Math.max(25,c)),g.current=null,I(null),v(!1)},C=a=>{I({...a})};return t.jsxs(d.Fragment,{children:[t.jsx("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-ful",children:h.map(a=>{let{x:p,height:c,rowId:w,width:D,y:F}=a;return t.jsx("div",{style:{width:D,height:c,left:p,top:F},onClick:()=>b(w),children:t.jsx("div",{className:"absolute left-0 -bottom-3 w-full h-6 bg-transparent",onMouseEnter:()=>C(a)})},w)})}),i&&t.jsxs(d.Fragment,{children:[t.jsxs("div",{ref:f,className:"absolute flex flex-col items-center gap-[5px] cursor-row-resize",style:{left:0,top:i.y+i.height-6,width:i.width},onPointerDown:y,children:[t.jsx("div",{className:"bg-black rounded-md h-[3px]",style:{width:i.width/2}}),t.jsx("div",{className:"bg-black rounded-md h-[3px]",style:{width:i.width/2}})]}),R&&t.jsx("div",{className:"absolute h-[3px] w-full bg-slate-400 z-20",style:{left:0,top:i.y+i.height-2}})]})]})},pe={rows:[{height:200,rowId:1},{height:35,rowId:2},{height:39,rowId:3},{height:50,rowId:4},{height:128,rowId:5},{height:77,rowId:6},{height:99,rowId:7},{height:100,rowId:13},{height:35,rowId:15},{height:39,rowId:33},{height:50,rowId:24},{height:128,rowId:45},{height:150,rowId:50},{height:77,rowId:66},{height:99,rowId:37}],columns:[{width:350,columnId:1},{width:175,columnId:2},{width:220,columnId:3},{width:270,columnId:5},{width:125,columnId:9}],cells:[{backgroundColor:"#CADAF8",color:"white",html:"<span>Loreum Ispum</span>",rowId:50,columnId:2},{html:"Loreum Ispum",backgroundColor:"#EA9999",color:"white",rowId:1,columnId:1},{backgroundColor:"#B7E1CD",html:"<b>Loreum Ispum</b>",rowId:4,columnId:2},{backgroundColor:"#CADAF8",html:"<span>Loreum Ispum</span>",columnId:3,rowId:6},{html:"Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#FEE599",rowId:5,columnId:5},{html:"Lorem Ipsum Lorem Ipsum is simply dummy text of the printing Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#B3A7D6",rowId:2,columnId:8},{backgroundColor:"#FFF2CC",html:"<b>Loreum Ispum</b>",rowId:12,columnId:6},{backgroundColor:"#B7B7B7",html:"<span>Loreum</span>",rowId:25,columnId:4},{html:"Loreum Ispum",rowId:9,columnId:3},{html:"Loreum Ispum",backgroundColor:"#766CEB",color:"white",rowId:80,columnId:5}]},M=46,z=25,A={width:100,height:25},we=()=>{const[h,b]=d.useState([]),[m,i]=d.useState([]),[I,R]=d.useState([]),[v,f]=d.useState(""),[g,y]=d.useState(null),[j,E]=d.useState(0),{current:C}=d.useRef({}),{current:a}=d.useRef({}),{current:p}=d.useRef({}),c=d.useRef(null),w=d.useRef(null),D=d.useMemo(()=>{let e=I.find(({cellId:s})=>s===v);if(!e)return null;let[r,n]=v.split(","),l=h.find(s=>s.rowId===+n);return{column:m.find(s=>s.columnId===+r),row:l,cell:e}},[h,m,v]);d.useEffect(()=>{if(!c.current||!w.current)return;let e=w.current,{clientWidth:r,clientHeight:n}=c.current;e.width=r,e.height=n;let{rows:l,cells:o,columns:s}=pe;for(let u of l)C[u.rowId]=u;for(let u of s)a[u.columnId]=u;for(let u of o){let N=`${u.columnId},${u.rowId}`;p[N]=u}},[]),d.useEffect(()=>{F()},[j]),d.useEffect(()=>(window.addEventListener("resize",F),()=>{window.removeEventListener("resize",F)}),[h,m]);const F=()=>{if(!c.current||!w.current)return;let{clientWidth:e,clientHeight:r}=c.current,n=w.current;n.width=e,n.height=r;let{rowId:l=1,y:o=z}=h[0]??{},{columnId:s=1,x:u=M}=m[0]??{};B({offsetX:u,offsetY:o,rowStart:l,colStart:s})},$=(e,{height:r,rowId:n,width:l,x:o,y:s})=>{e.save(),e.clearRect(o,s,l,r),e.beginPath(),e.moveTo(o+l,s),e.lineTo(o+l,s+r),e.lineTo(o,s+r),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.beginPath(),e.textAlign="center",e.textBaseline="middle",e.font="12px Open-Sans",e.fillStyle="#575a5a",e.fillText(n.toString(),o+l/2,s+r/2),e.restore()},U=(e,{columnId:r,height:n,width:l,x:o,y:s})=>{e.save(),e.clearRect(o,s,l,n),e.beginPath(),e.moveTo(o,s),e.lineTo(o+l,s),e.lineTo(o+l,s+n),e.lineTo(o,s+n),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.textAlign="center",e.textBaseline="middle",e.font="12px Open-Sans",e.fillStyle="#575a5a",e.fillText(W(r),o+l/2,s+n/2),e.restore()},_=(e,r,{x:n,y:l,height:o,width:s})=>{e.save(),e.fillStyle=r,e.beginPath(),e.moveTo(n,l),e.fillRect(n,l,s,o),e.fill(),e.restore()},O=(e,{height:r,width:n,x:l,y:o})=>{e.save(),e.beginPath(),e.moveTo(l,o+r),e.lineTo(l+n,o+r),e.lineTo(l+n,o),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.restore()},V=(e,r,{height:n,width:l,x:o,y:s})=>{e.font="14px Open-Sans",e.beginPath(),e.fillText(r,o,s+14)},q=(e,{cellId:r,rowId:n,columnId:l,height:o,width:s,x:u,y:N})=>{let{backgroundColor:L="#FFFFFF",color:P="#000000",html:H=""}=p[r]??{},T={x:u,y:N,width:s,height:o};e.clearRect(u,N,s,o),_(e,L,T),V(e,H,T),O(e,T)},B=({offsetX:e,offsetY:r,rowStart:n,colStart:l})=>{var H,T;if(!c.current||!w.current)return;let o=w.current.getContext("2d"),{clientWidth:s,clientHeight:u}=c.current,N=[],L=[],P=[];for(let x=n,S=r;S<u;x++){let k=((H=C[x])==null?void 0:H.height)||A.height;S+k>z&&N.push({y:S,x:0,rowId:x,height:k,width:M}),S+=k}for(let x=l,S=e;S<s;x++){let k=((T=a[x])==null?void 0:T.width)||A.width;S+k>M&&L.push({x:S,y:0,columnId:x,width:k,height:z}),S+=k}for(let{rowId:x,height:S,y:k}of N)for(let{width:ne,x:se,columnId:G}of L){let ie=`${G},${x}`;P.push({x:se,y:k,rowId:x,columnId:G,width:ne,height:S,cellId:ie}),q(o,P.at(-1))}for(let x of N)$(o,x);for(let x of L)U(o,x);b(N),i(L),R(P)},X=e=>{if(!c.current)return;let r=e.pageX,n=e.pageY-c.current.getBoundingClientRect().top,l=J(r,n);l&&(f(l),y(null))},J=(e,r)=>{let n=0,l=h.length-1,o=null;for(;n<=l;){let u=Math.floor((n+l)/2);h[u].y<=r?(n=u+1,o=h[u].rowId):l=u-1}if(!o)return null;n=0,l=m.length-1;let s=null;for(;n<=l;){let u=Math.floor((n+l)/2);m[u].x<=e?(n=u+1,s=m[u].columnId):l=u-1}return s?`${s},${o}`:null},K=e=>{var s;if(!h.length||!m.length)return;let{rowId:r,y:n}=h[0],{columnId:l,x:o}=m[0];if(e<0){for(n+=-e,r--;r>0&&n>z;)n-=((s=C[r])==null?void 0:s.height)??A.height,r--;B({offsetX:o,offsetY:Math.min(z,n),rowStart:r+1,colStart:l})}else B({offsetX:o,offsetY:n+-e,rowStart:r,colStart:l})},Q=e=>{var s;if(!h.length||!m.length)return;let{rowId:r,y:n}=h[0],{columnId:l,x:o}=m[0];if(e<0){for(o+=-e,l--;l>0&&o>M;)o-=((s=a[l])==null?void 0:s.width)??A.width,l--;B({offsetX:Math.min(M,o),offsetY:n,rowStart:r,colStart:l+1})}else B({offsetX:o+-e,offsetY:n,rowStart:r,colStart:l})},Y=e=>{let{deltaX:r,deltaY:n}=e;r===0?K(n):Q(r)},Z=()=>{if(!c.current||!D)return;let{columnId:e,cellId:r,width:n,height:l,rowId:o,x:s,y:u}=D.cell,{top:N}=c.current.getBoundingClientRect();y({cellId:r,columnId:e,width:n,height:l,rowId:o,x:Math.max(M,s),y:Math.max(z+N,u+N)})},ee=e=>{e.preventDefault(),X(e)},te=e=>{console.log(e)},le=e=>{console.log(e)},re=(e,r)=>{a[e]?a[e].width=r:a[e]={columnId:e,width:r},E(Math.random())},oe=(e,r)=>{C[e]?C[e].height=r:C[e]={rowId:e,height:r},E(Math.random())};return t.jsxs(d.Fragment,{children:[t.jsxs("div",{ref:c,className:"relative h-[var(--grid-height)] select-none overflow-hidden",onClick:X,onContextMenu:ee,onWheel:Y,children:[t.jsx("canvas",{ref:w,className:"relative"}),t.jsx("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-[var(--row-height)] border border-light-gray bg-white z-20 after:absolute after:right-0 after:h-full after:w-1 after:bg-dark-silver before:absolute before:bottom-0 before:w-full before:h-1 before:bg-dark-silver"}),t.jsx(fe,{columns:m,onClick:te,onResize:re}),t.jsx(ge,{rows:h,onClick:le,onResize:oe}),!g&&D&&t.jsx(he,{selectedGrid:D,onDoubleClick:Z})]}),g&&t.jsx(me,{cell:g,data:p[g.cellId],onWheel:Y})]})},be=()=>t.jsx("div",{className:"fixed left-0 bottom-0 w-full h-[var(--bottom-bar-height)] bg-light-silver border-t border-mild-silver",children:"Bottom Bar"}),Ie=()=>t.jsxs(d.Fragment,{children:[t.jsx(ce,{}),t.jsx(ue,{}),t.jsx(we,{}),t.jsx(be,{})]});export{Ie as default};
