import{r as w,j as f,g as Yt,c as at,d as Ut,a as Ot,b as qt}from"./index-83b7f35c.js";const Gt=({user:e,logout:t})=>{let r=w.useMemo(()=>{if(!e)return"";let[n,o=""]=e.name.split(" ");return`${n.charAt(0)}${o?o.charAt(0):""}`.trim()},[e]);return f.jsx(w.Fragment,{children:f.jsx("div",{className:"w-10 h-10 flex justify-center items-center rounded-full bg-blue cursor-pointer",children:f.jsx("span",{className:"text-base text-white font-medium",children:r||"AK"})})})},Kt=({user:e,onLogout:t})=>{const r=n=>{console.log(n.target.value)};return f.jsxs("div",{className:"flex justify-between items-center h-[var(--header-height)] pr-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("img",{className:"w-[60px] h-[42px]",src:Yt("/logo.png")}),f.jsx("input",{className:"text-dark-gray font-medium text-base border border-transparent px-1 outline-none rounded-sm hover:border-gray-500 focus:border-gray-500",type:"text",onChange:r,value:"Untitled Spreadsheet"})]}),f.jsx(Gt,{user:e,logout:t})]})},_t=()=>f.jsxs("div",{className:"flex gap-2 px-2 items-center h-[var(--formula-bar-height)]",children:[f.jsx("input",{name:"id",className:"outline-none w-[100px] px-2 bg-transparent text-sm border-2 rounded-sm border-transparent hover:bg-[#ededed] focus:border-dark-blue"}),f.jsx("div",{className:"w-[2px] bg-[#dadce0] h-[50%] border-none"}),f.jsxs("div",{className:"flex items-center w-full",children:[f.jsx("i",{className:"icon-format-text text-[#a8a9a9] font-bold"}),f.jsx("input",{name:"content",className:"w-full border-none outline-none bg-transparent px-2 text-sm"})]})]}),Jt=({selectedCell:e,onDoubleClick:t})=>{let{columnId:r,height:n,cellId:o,rowId:i,width:c,x:s,y:l}=e,d=`calc(${s}px - var(--col-width))`,u=`calc(${l}px - var(--row-height))`;return f.jsx("div",{className:"absolute flex text-sm bg-transparent border-2 border-blue p-1 z-10",style:{left:d,top:u,width:c,height:n},onDoubleClick:t})},Qt=({cell:e,data:t,onWheel:r})=>{const n=w.useRef(null);let{x:o,y:i,rowId:c,height:s,columnId:l,width:d}=e,{color:u="#000000",backgroundColor:h="#FFFFFF",html:y=""}=t??{};w.useEffect(()=>{n.current&&m(n.current)},[e]);const m=E=>{let j=window.getSelection();if(!j)return;let x=document.createRange();x.setStart(E,E.childNodes.length),x.collapse(!0),j.removeAllRanges(),j.addRange(x)};return f.jsxs("div",{className:"absolute flex border-1 outline outline-3 outline-light-blue p-[2px] z-10",style:{width:d,height:s,left:o,top:i,backgroundColor:h,color:u},onWheel:r,children:[f.jsx("div",{ref:n,className:"w-full h-full text-sm outline outline-2 outline-dark-blue p-[2px]",contentEditable:!0,dangerouslySetInnerHTML:{__html:y}}),f.jsxs("div",{className:"absolute -top-7 left-0 bg-blue text-xs font-medium text-white rounded-sm px-2 py-1",children:[at(l),c]})]})},Zt=({columns:e,onClick:t,onResize:r})=>{const[n,o]=w.useState(null),[i,c]=w.useState(!1),[s,l]=w.useState(!1),d=w.useRef(null),u=w.useRef(null),h=C=>{!d.current||!n||(u.current=C.pageX,d.current.setPointerCapture(C.pointerId),d.current.addEventListener("pointermove",y),d.current.addEventListener("pointerup",m,{once:!0}),c(!0))},y=C=>{if(!d.current||!u.current||!n)return;let{pageX:g}=C,I=n.width+-(u.current-g);I<50||o({...n,width:I})},m=C=>{if(!d.current||!n||!u.current)return;let{pageX:g}=C;d.current.removeEventListener("pointermove",y);let I=n.width+-(u.current-g);r(n.columnId,Math.max(50,I)),u.current=null,o(null),c(!1)},E=()=>{l(!s)},j=C=>{let g=0,I=e.length-1,N=null;for(;g<=I;){let A=Math.floor((g+I)/2);e[A].x<=C?(g=A+1,N=A):I=A-1}return N===null?null:e[N]},x=C=>{if(i)return;let g=j(C.pageX);!g||(n==null?void 0:n.columnId)===g.columnId||o({...g})},O=()=>{o(null)},k=()=>{n&&t(n.columnId)};return f.jsxs(w.Fragment,{children:[f.jsx("div",{className:"absolute left-0 top-0 w-full h-[var(--row-height)] z-20",onMouseMove:x,onMouseLeave:O,children:n&&f.jsxs("div",{className:"absolute",style:{width:n.width,height:n.height,left:n.x,top:n.y},onClick:k,onContextMenu:k,children:[f.jsx("div",{className:"absolute top-0 -right-3 w-6 h-full bg-transparent",onMouseEnter:E}),f.jsxs("div",{ref:d,className:"absolute top-0 -right-[5px] flex gap-[5px] items-center h-full cursor-col-resize",onPointerDown:h,children:[f.jsx("div",{className:"bg-black rounded-md w-[3px] h-2/3"}),f.jsx("div",{className:"bg-black rounded-md w-[3px] h-2/3"})]})]})}),n&&i&&f.jsx("div",{className:"absolute w-[3px] h-full bg-slate-400 z-10",style:{left:n.x+n.width-2,top:0}})]})},er=({rows:e,onClick:t,onResize:r})=>{const[n,o]=w.useState(null),[i,c]=w.useState(!1),s=w.useRef(null),l=w.useRef(null),d=w.useRef(null),u=O=>{!s.current||!n||(l.current=O.pageY,s.current.setPointerCapture(O.pointerId),s.current.addEventListener("pointermove",h),s.current.addEventListener("pointerup",y,{once:!0}),c(!0))},h=O=>{if(!s.current||!l.current||!n)return;let{pageY:k}=O,C=n.height+-(l.current-k);C<=25||o({...n,height:C})},y=O=>{if(!s.current||!n||!l.current)return;let{pageY:k}=O;s.current.removeEventListener("pointermove",h);let C=n.height+-(l.current-k);r(n.rowId,Math.max(25,C)),l.current=null,o(null),c(!1)},m=O=>{let k=0,C=e.length-1,g=null;for(;k<=C;){let I=Math.floor((k+C)/2);e[I].y<=O?(k=I+1,g=I):C=I-1}return g===null?null:e[g]},E=O=>{if(!d.current||i)return;let{top:k}=d.current.getBoundingClientRect(),C=m(O.pageY-k);!C||(n==null?void 0:n.rowId)===C.rowId||o({...C})},j=()=>{o(null)},x=()=>{n&&t(n.rowId)};return f.jsxs(w.Fragment,{children:[f.jsx("div",{ref:d,className:"absolute left-0 top-0 w-[var(--col-width)] h-full z-20",onMouseMove:E,onMouseLeave:j,children:n&&f.jsx("div",{className:"absolute",style:{width:n.width,height:n.height,left:n.x,top:n.y},onClick:x,onContextMenu:x,children:f.jsxs("div",{ref:s,className:"absolute left-0 -bottom-[5px] flex flex-col items-center gap-[5px] w-full cursor-row-resize",onPointerDown:u,children:[f.jsx("div",{className:"bg-black rounded-md h-[3px] w-3/5"}),f.jsx("div",{className:"bg-black rounded-md h-[3px] w-3/5"})]})})}),n&&i&&f.jsx("div",{className:"absolute h-[3px] w-full bg-slate-400 z-10",style:{left:0,top:n.y+n.height-2}})]})},tr=({count:e,activeIndex:t,onPrevious:r,onNext:n,onSearch:o,onClose:i})=>{const c=s=>{o(s.target.value)};return f.jsxs("div",{className:"fixed flex items-center gap-2 top-6 right-6 bg-white border border-mild-gray rounded-md px-4 py-5",children:[f.jsxs("div",{className:"relative w-44 h-9",children:[f.jsx("input",{placeholder:"Find in sheet",className:"w-full h-full outline-dark-blue border border-mild-gray text-sm rounded px-2 py-2 pr-14",onChange:Ut(c,500),autoFocus:!0}),e>0&&f.jsxs("span",{className:"absolute flex top-1/2 -translate-y-1/2 right-3 text-xs text-light-gray",children:[t+1," of ",e]})]}),f.jsx("button",{className:"text-gray-400 text-xl disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e,children:f.jsx("i",{className:"bx-chevron-up",onClick:r})}),f.jsx("button",{className:"text-gray-400 text-xl disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e,children:f.jsx("i",{className:"bx-chevron-down ",onClick:n})}),f.jsx("button",{className:"text-xl text-dark-gray",children:f.jsx("i",{className:"bx-x",onClick:i})})]})},rr={rows:[{height:200,rowId:1},{height:35,rowId:2},{height:39,rowId:3},{height:50,rowId:4},{height:128,rowId:5},{height:77,rowId:6},{height:99,rowId:7},{height:100,rowId:13},{height:35,rowId:15},{height:39,rowId:33},{height:50,rowId:24},{height:128,rowId:45},{height:150,rowId:50},{height:77,rowId:66},{height:99,rowId:37}],columns:[{width:350,columnId:1},{width:175,columnId:2},{width:220,columnId:3},{width:270,columnId:5},{width:125,columnId:9}],cells:[{rowId:1,columnId:5,html:"Loreum Ispum"},{rowId:2,columnId:2,html:"Loreum Ispum"},{backgroundColor:"#CADAF8",color:"white",html:"<span>Loreum Ispum</span><br><span style='font-size:20px; font-color: red'>Loreum Ispum</span>",rowId:50,columnId:2},{backgroundColor:"#EA9999",color:"white",rowId:1,columnId:1,html:"<span>Loreum Ispum</span><br><span style='font-size:20px; font-color: red'>Loreum Ispum</span>"},{backgroundColor:"#B7E1CD",html:"<b>Loreum Ispum</b>",rowId:4,columnId:2},{backgroundColor:"#CADAF8",html:"<span>Loreum Ispum</span>",columnId:3,rowId:6},{html:"Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#FEE599",rowId:5,columnId:5},{html:"Lorem Ipsum Lorem Ipsum is simply dummy text of the printing Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#B3A7D6",rowId:2,columnId:8},{backgroundColor:"#FFF2CC",html:"<b>Loreum Ispum</b>",rowId:12,columnId:6},{backgroundColor:"#B7B7B7",html:"<span>Loreum</span>",rowId:25,columnId:4},{html:"Loreum Ispum",rowId:9,columnId:3},{html:"Loreum Ispum",backgroundColor:"#766CEB",color:"white",rowId:80,columnId:5}]};var Rt={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function r(){for(var n=[],o=0;o<arguments.length;o++){var i=arguments[o];if(i){var c=typeof i;if(c==="string"||c==="number")n.push(i);else if(Array.isArray(i)){if(i.length){var s=r.apply(null,i);s&&n.push(s)}}else if(c==="object"){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){n.push(i.toString());continue}for(var l in i)t.call(i,l)&&i[l]&&n.push(l)}}}return n.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(Rt);var nr=Rt.exports;const or=Ot(nr),ir=({activeIndex:e,cellIds:t,visibleCells:r})=>{const n=w.useMemo(()=>new Set(t),[t]);return f.jsx(w.Fragment,{children:r.map(({cellId:o,columnId:i,height:c,rowId:s,width:l,x:d,y:u})=>{if(!n.has(o))return null;let h=`calc(${d}px - var(--col-width))`,y=`calc(${u}px - var(--row-height))`;return f.jsx("div",{className:or("absolute",o===t[e]?"bg-[rgba(55,190,95,.702)] shadow-[0_0_0_2px_#146c2e] border border-white":"bg-[rgba(109,213,140,.4)]"),style:{width:l,height:c,left:h,top:y}},o)})})},ar=({selectedColumn:e})=>{const{columnId:t,height:r,width:n,x:o,y:i}=e;let c=`calc(${o}px - var(--col-width))`;return f.jsx("div",{className:"absolute left-[var(--col-width)] top-0 w-[calc(100%-var(--col-width))] h-[var(--row-height)] overflow-hidden z-10",children:f.jsx("div",{className:"absolute flex justify-center items-center bg-dark-blue",style:{left:c,top:i,width:n,height:r},children:f.jsx("span",{className:"text-white text-xs font-medium",children:at(t)})})})},sr=({selectedRow:e})=>{const{height:t,rowId:r,width:n,x:o,y:i}=e;let c=`calc(${i}px - var(--row-height))`;return f.jsx("div",{className:"absolute left-0 top-[var(--row-height)] w-[var(--col-width)] h-[calc(100%-var(--row-height))] overflow-hidden z-10",children:f.jsx("div",{className:"absolute flex justify-center items-center bg-dark-blue",style:{left:o,top:c,width:n,height:t},children:f.jsx("span",{className:"text-white text-xs font-medium",children:r})})})},lr=({selectedColumn:e})=>{let{columnId:t,height:r,width:n,x:o,y:i}=e,c=`calc(${o}px - var(--col-width))`,s=`calc(${i}px - var(--row-height))`;return f.jsx("div",{className:"absolute top-[var(--col-height)] left-0 w-[var(--col-width)] border-dark-blue border-r border-l bg-light-sky-blue h-full",style:{width:n,left:c,top:s}})},cr=({selectedRow:e})=>{let{rowId:t,height:r,width:n,x:o,y:i}=e,c=`calc(${o}px - var(--col-width))`,s=`calc(${i}px - var(--row-height))`;return f.jsx("div",{className:"absolute top-[var(--col-height)] left-0 w-full border-dark-blue border-t border-b bg-light-sky-blue",style:{height:r,left:c,top:s}})};var vt=function(t){return t.reduce(function(r,n){var o=n[0],i=n[1];return r[o]=i,r},{})},mt=typeof window<"u"&&window.document&&window.document.createElement?w.useLayoutEffect:w.useEffect,H="top",K="bottom",_="right",z="left",st="auto",Me=[H,K,_,z],Ce="start",Ae="end",ur="clippingParents",Et="viewport",ke="popper",fr="reference",gt=Me.reduce(function(e,t){return e.concat([t+"-"+Ce,t+"-"+Ae])},[]),kt=[].concat(Me,[st]).reduce(function(e,t){return e.concat([t,t+"-"+Ce,t+"-"+Ae])},[]),dr="beforeRead",pr="read",hr="afterRead",vr="beforeMain",mr="main",gr="afterMain",wr="beforeWrite",xr="write",br="afterWrite",yr=[dr,pr,hr,vr,mr,gr,wr,xr,br];function te(e){return e?(e.nodeName||"").toLowerCase():null}function Y(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function ve(e){var t=Y(e).Element;return e instanceof t||e instanceof Element}function G(e){var t=Y(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function lt(e){if(typeof ShadowRoot>"u")return!1;var t=Y(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Cr(e){var t=e.state;Object.keys(t.elements).forEach(function(r){var n=t.styles[r]||{},o=t.attributes[r]||{},i=t.elements[r];!G(i)||!te(i)||(Object.assign(i.style,n),Object.keys(o).forEach(function(c){var s=o[c];s===!1?i.removeAttribute(c):i.setAttribute(c,s===!0?"":s)}))})}function Ir(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(n){var o=t.elements[n],i=t.attributes[n]||{},c=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:r[n]),s=c.reduce(function(l,d){return l[d]="",l},{});!G(o)||!te(o)||(Object.assign(o.style,s),Object.keys(i).forEach(function(l){o.removeAttribute(l)}))})}}const jr={name:"applyStyles",enabled:!0,phase:"write",fn:Cr,effect:Ir,requires:["computeStyles"]};function ee(e){return e.split("-")[0]}var he=Math.max,Ke=Math.min,Ie=Math.round;function ot(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Nt(){return!/^((?!chrome|android).)*safari/i.test(ot())}function je(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),o=1,i=1;t&&G(e)&&(o=e.offsetWidth>0&&Ie(n.width)/e.offsetWidth||1,i=e.offsetHeight>0&&Ie(n.height)/e.offsetHeight||1);var c=ve(e)?Y(e):window,s=c.visualViewport,l=!Nt()&&r,d=(n.left+(l&&s?s.offsetLeft:0))/o,u=(n.top+(l&&s?s.offsetTop:0))/i,h=n.width/o,y=n.height/i;return{width:h,height:y,top:u,right:d+h,bottom:u+y,left:d,x:d,y:u}}function ct(e){var t=je(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function Pt(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&lt(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function ae(e){return Y(e).getComputedStyle(e)}function Sr(e){return["table","td","th"].indexOf(te(e))>=0}function ue(e){return((ve(e)?e.ownerDocument:e.document)||window.document).documentElement}function _e(e){return te(e)==="html"?e:e.assignedSlot||e.parentNode||(lt(e)?e.host:null)||ue(e)}function wt(e){return!G(e)||ae(e).position==="fixed"?null:e.offsetParent}function Or(e){var t=/firefox/i.test(ot()),r=/Trident/i.test(ot());if(r&&G(e)){var n=ae(e);if(n.position==="fixed")return null}var o=_e(e);for(lt(o)&&(o=o.host);G(o)&&["html","body"].indexOf(te(o))<0;){var i=ae(o);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||t&&i.willChange==="filter"||t&&i.filter&&i.filter!=="none")return o;o=o.parentNode}return null}function Fe(e){for(var t=Y(e),r=wt(e);r&&Sr(r)&&ae(r).position==="static";)r=wt(r);return r&&(te(r)==="html"||te(r)==="body"&&ae(r).position==="static")?t:r||Or(e)||t}function ut(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Ne(e,t,r){return he(e,Ke(t,r))}function Rr(e,t,r){var n=Ne(e,t,r);return n>r?r:n}function At(){return{top:0,right:0,bottom:0,left:0}}function Dt(e){return Object.assign({},At(),e)}function Mt(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var Er=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,Dt(typeof t!="number"?t:Mt(t,Me))};function kr(e){var t,r=e.state,n=e.name,o=e.options,i=r.elements.arrow,c=r.modifiersData.popperOffsets,s=ee(r.placement),l=ut(s),d=[z,_].indexOf(s)>=0,u=d?"height":"width";if(!(!i||!c)){var h=Er(o.padding,r),y=ct(i),m=l==="y"?H:z,E=l==="y"?K:_,j=r.rects.reference[u]+r.rects.reference[l]-c[l]-r.rects.popper[u],x=c[l]-r.rects.reference[l],O=Fe(i),k=O?l==="y"?O.clientHeight||0:O.clientWidth||0:0,C=j/2-x/2,g=h[m],I=k-y[u]-h[E],N=k/2-y[u]/2+C,A=Ne(g,N,I),B=l;r.modifiersData[n]=(t={},t[B]=A,t.centerOffset=A-N,t)}}function Nr(e){var t=e.state,r=e.options,n=r.element,o=n===void 0?"[data-popper-arrow]":n;o!=null&&(typeof o=="string"&&(o=t.elements.popper.querySelector(o),!o)||Pt(t.elements.popper,o)&&(t.elements.arrow=o))}const Pr={name:"arrow",enabled:!0,phase:"main",fn:kr,effect:Nr,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Se(e){return e.split("-")[1]}var Ar={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Dr(e,t){var r=e.x,n=e.y,o=t.devicePixelRatio||1;return{x:Ie(r*o)/o||0,y:Ie(n*o)/o||0}}function xt(e){var t,r=e.popper,n=e.popperRect,o=e.placement,i=e.variation,c=e.offsets,s=e.position,l=e.gpuAcceleration,d=e.adaptive,u=e.roundOffsets,h=e.isFixed,y=c.x,m=y===void 0?0:y,E=c.y,j=E===void 0?0:E,x=typeof u=="function"?u({x:m,y:j}):{x:m,y:j};m=x.x,j=x.y;var O=c.hasOwnProperty("x"),k=c.hasOwnProperty("y"),C=z,g=H,I=window;if(d){var N=Fe(r),A="clientHeight",B="clientWidth";if(N===Y(r)&&(N=ue(r),ae(N).position!=="static"&&s==="absolute"&&(A="scrollHeight",B="scrollWidth")),N=N,o===H||(o===z||o===_)&&i===Ae){g=K;var L=h&&N===I&&I.visualViewport?I.visualViewport.height:N[A];j-=L-n.height,j*=l?1:-1}if(o===z||(o===H||o===K)&&i===Ae){C=_;var W=h&&N===I&&I.visualViewport?I.visualViewport.width:N[B];m-=W-n.width,m*=l?1:-1}}var D=Object.assign({position:s},d&&Ar),F=u===!0?Dr({x:m,y:j},Y(r)):{x:m,y:j};if(m=F.x,j=F.y,l){var $;return Object.assign({},D,($={},$[g]=k?"0":"",$[C]=O?"0":"",$.transform=(I.devicePixelRatio||1)<=1?"translate("+m+"px, "+j+"px)":"translate3d("+m+"px, "+j+"px, 0)",$))}return Object.assign({},D,(t={},t[g]=k?j+"px":"",t[C]=O?m+"px":"",t.transform="",t))}function Mr(e){var t=e.state,r=e.options,n=r.gpuAcceleration,o=n===void 0?!0:n,i=r.adaptive,c=i===void 0?!0:i,s=r.roundOffsets,l=s===void 0?!0:s,d={placement:ee(t.placement),variation:Se(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,xt(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:c,roundOffsets:l})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,xt(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const Fr={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Mr,data:{}};var Ue={passive:!0};function Lr(e){var t=e.state,r=e.instance,n=e.options,o=n.scroll,i=o===void 0?!0:o,c=n.resize,s=c===void 0?!0:c,l=Y(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&d.forEach(function(u){u.addEventListener("scroll",r.update,Ue)}),s&&l.addEventListener("resize",r.update,Ue),function(){i&&d.forEach(function(u){u.removeEventListener("scroll",r.update,Ue)}),s&&l.removeEventListener("resize",r.update,Ue)}}const Br={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Lr,data:{}};var Wr={left:"right",right:"left",bottom:"top",top:"bottom"};function qe(e){return e.replace(/left|right|bottom|top/g,function(t){return Wr[t]})}var $r={start:"end",end:"start"};function bt(e){return e.replace(/start|end/g,function(t){return $r[t]})}function ft(e){var t=Y(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function dt(e){return je(ue(e)).left+ft(e).scrollLeft}function Tr(e,t){var r=Y(e),n=ue(e),o=r.visualViewport,i=n.clientWidth,c=n.clientHeight,s=0,l=0;if(o){i=o.width,c=o.height;var d=Nt();(d||!d&&t==="fixed")&&(s=o.offsetLeft,l=o.offsetTop)}return{width:i,height:c,x:s+dt(e),y:l}}function Hr(e){var t,r=ue(e),n=ft(e),o=(t=e.ownerDocument)==null?void 0:t.body,i=he(r.scrollWidth,r.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),c=he(r.scrollHeight,r.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-n.scrollLeft+dt(e),l=-n.scrollTop;return ae(o||r).direction==="rtl"&&(s+=he(r.clientWidth,o?o.clientWidth:0)-i),{width:i,height:c,x:s,y:l}}function pt(e){var t=ae(e),r=t.overflow,n=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+o+n)}function Ft(e){return["html","body","#document"].indexOf(te(e))>=0?e.ownerDocument.body:G(e)&&pt(e)?e:Ft(_e(e))}function Pe(e,t){var r;t===void 0&&(t=[]);var n=Ft(e),o=n===((r=e.ownerDocument)==null?void 0:r.body),i=Y(n),c=o?[i].concat(i.visualViewport||[],pt(n)?n:[]):n,s=t.concat(c);return o?s:s.concat(Pe(_e(c)))}function it(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function zr(e,t){var r=je(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function yt(e,t,r){return t===Et?it(Tr(e,r)):ve(t)?zr(t,r):it(Hr(ue(e)))}function Xr(e){var t=Pe(_e(e)),r=["absolute","fixed"].indexOf(ae(e).position)>=0,n=r&&G(e)?Fe(e):e;return ve(n)?t.filter(function(o){return ve(o)&&Pt(o,n)&&te(o)!=="body"}):[]}function Vr(e,t,r,n){var o=t==="clippingParents"?Xr(e):[].concat(t),i=[].concat(o,[r]),c=i[0],s=i.reduce(function(l,d){var u=yt(e,d,n);return l.top=he(u.top,l.top),l.right=Ke(u.right,l.right),l.bottom=Ke(u.bottom,l.bottom),l.left=he(u.left,l.left),l},yt(e,c,n));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Lt(e){var t=e.reference,r=e.element,n=e.placement,o=n?ee(n):null,i=n?Se(n):null,c=t.x+t.width/2-r.width/2,s=t.y+t.height/2-r.height/2,l;switch(o){case H:l={x:c,y:t.y-r.height};break;case K:l={x:c,y:t.y+t.height};break;case _:l={x:t.x+t.width,y:s};break;case z:l={x:t.x-r.width,y:s};break;default:l={x:t.x,y:t.y}}var d=o?ut(o):null;if(d!=null){var u=d==="y"?"height":"width";switch(i){case Ce:l[d]=l[d]-(t[u]/2-r[u]/2);break;case Ae:l[d]=l[d]+(t[u]/2-r[u]/2);break}}return l}function De(e,t){t===void 0&&(t={});var r=t,n=r.placement,o=n===void 0?e.placement:n,i=r.strategy,c=i===void 0?e.strategy:i,s=r.boundary,l=s===void 0?ur:s,d=r.rootBoundary,u=d===void 0?Et:d,h=r.elementContext,y=h===void 0?ke:h,m=r.altBoundary,E=m===void 0?!1:m,j=r.padding,x=j===void 0?0:j,O=Dt(typeof x!="number"?x:Mt(x,Me)),k=y===ke?fr:ke,C=e.rects.popper,g=e.elements[E?k:y],I=Vr(ve(g)?g:g.contextElement||ue(e.elements.popper),l,u,c),N=je(e.elements.reference),A=Lt({reference:N,element:C,strategy:"absolute",placement:o}),B=it(Object.assign({},C,A)),L=y===ke?B:N,W={top:I.top-L.top+O.top,bottom:L.bottom-I.bottom+O.bottom,left:I.left-L.left+O.left,right:L.right-I.right+O.right},D=e.modifiersData.offset;if(y===ke&&D){var F=D[o];Object.keys(W).forEach(function($){var U=[_,K].indexOf($)>=0?1:-1,q=[H,K].indexOf($)>=0?"y":"x";W[$]+=F[q]*U})}return W}function Yr(e,t){t===void 0&&(t={});var r=t,n=r.placement,o=r.boundary,i=r.rootBoundary,c=r.padding,s=r.flipVariations,l=r.allowedAutoPlacements,d=l===void 0?kt:l,u=Se(n),h=u?s?gt:gt.filter(function(E){return Se(E)===u}):Me,y=h.filter(function(E){return d.indexOf(E)>=0});y.length===0&&(y=h);var m=y.reduce(function(E,j){return E[j]=De(e,{placement:j,boundary:o,rootBoundary:i,padding:c})[ee(j)],E},{});return Object.keys(m).sort(function(E,j){return m[E]-m[j]})}function Ur(e){if(ee(e)===st)return[];var t=qe(e);return[bt(e),t,bt(t)]}function qr(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var o=r.mainAxis,i=o===void 0?!0:o,c=r.altAxis,s=c===void 0?!0:c,l=r.fallbackPlacements,d=r.padding,u=r.boundary,h=r.rootBoundary,y=r.altBoundary,m=r.flipVariations,E=m===void 0?!0:m,j=r.allowedAutoPlacements,x=t.options.placement,O=ee(x),k=O===x,C=l||(k||!E?[qe(x)]:Ur(x)),g=[x].concat(C).reduce(function(le,Q){return le.concat(ee(Q)===st?Yr(t,{placement:Q,boundary:u,rootBoundary:h,padding:d,flipVariations:E,allowedAutoPlacements:j}):Q)},[]),I=t.rects.reference,N=t.rects.popper,A=new Map,B=!0,L=g[0],W=0;W<g.length;W++){var D=g[W],F=ee(D),$=Se(D)===Ce,U=[H,K].indexOf(F)>=0,q=U?"width":"height",T=De(t,{placement:D,boundary:u,rootBoundary:h,altBoundary:y,padding:d}),X=U?$?_:z:$?K:H;I[q]>N[q]&&(X=qe(X));var se=qe(X),re=[];if(i&&re.push(T[F]<=0),s&&re.push(T[X]<=0,T[se]<=0),re.every(function(le){return le})){L=D,B=!1;break}A.set(D,re)}if(B)for(var me=E?3:1,fe=function(Q){var ce=g.find(function(pe){var V=A.get(pe);if(V)return V.slice(0,Q).every(function(we){return we})});if(ce)return L=ce,"break"},de=me;de>0;de--){var ge=fe(de);if(ge==="break")break}t.placement!==L&&(t.modifiersData[n]._skip=!0,t.placement=L,t.reset=!0)}}const Gr={name:"flip",enabled:!0,phase:"main",fn:qr,requiresIfExists:["offset"],data:{_skip:!1}};function Ct(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function It(e){return[H,_,K,z].some(function(t){return e[t]>=0})}function Kr(e){var t=e.state,r=e.name,n=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,c=De(t,{elementContext:"reference"}),s=De(t,{altBoundary:!0}),l=Ct(c,n),d=Ct(s,o,i),u=It(l),h=It(d);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:u,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}const _r={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Kr};function Jr(e,t,r){var n=ee(e),o=[z,H].indexOf(n)>=0?-1:1,i=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,c=i[0],s=i[1];return c=c||0,s=(s||0)*o,[z,_].indexOf(n)>=0?{x:s,y:c}:{x:c,y:s}}function Qr(e){var t=e.state,r=e.options,n=e.name,o=r.offset,i=o===void 0?[0,0]:o,c=kt.reduce(function(u,h){return u[h]=Jr(h,t.rects,i),u},{}),s=c[t.placement],l=s.x,d=s.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=d),t.modifiersData[n]=c}const Zr={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Qr};function en(e){var t=e.state,r=e.name;t.modifiersData[r]=Lt({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const tn={name:"popperOffsets",enabled:!0,phase:"read",fn:en,data:{}};function rn(e){return e==="x"?"y":"x"}function nn(e){var t=e.state,r=e.options,n=e.name,o=r.mainAxis,i=o===void 0?!0:o,c=r.altAxis,s=c===void 0?!1:c,l=r.boundary,d=r.rootBoundary,u=r.altBoundary,h=r.padding,y=r.tether,m=y===void 0?!0:y,E=r.tetherOffset,j=E===void 0?0:E,x=De(t,{boundary:l,rootBoundary:d,padding:h,altBoundary:u}),O=ee(t.placement),k=Se(t.placement),C=!k,g=ut(O),I=rn(g),N=t.modifiersData.popperOffsets,A=t.rects.reference,B=t.rects.popper,L=typeof j=="function"?j(Object.assign({},t.rects,{placement:t.placement})):j,W=typeof L=="number"?{mainAxis:L,altAxis:L}:Object.assign({mainAxis:0,altAxis:0},L),D=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,F={x:0,y:0};if(N){if(i){var $,U=g==="y"?H:z,q=g==="y"?K:_,T=g==="y"?"height":"width",X=N[g],se=X+x[U],re=X-x[q],me=m?-B[T]/2:0,fe=k===Ce?A[T]:B[T],de=k===Ce?-B[T]:-A[T],ge=t.elements.arrow,le=m&&ge?ct(ge):{width:0,height:0},Q=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:At(),ce=Q[U],pe=Q[q],V=Ne(0,A[T],le[T]),we=C?A[T]/2-me-V-ce-W.mainAxis:fe-V-ce-W.mainAxis,Je=C?-A[T]/2+me+V+pe+W.mainAxis:de+V+pe+W.mainAxis,Oe=t.elements.arrow&&Fe(t.elements.arrow),Qe=Oe?g==="y"?Oe.clientTop||0:Oe.clientLeft||0:0,Re=($=D==null?void 0:D[g])!=null?$:0,Ze=X+we-Re-Qe,et=X+Je-Re,Le=Ne(m?Ke(se,Ze):se,X,m?he(re,et):re);N[g]=Le,F[g]=Le-X}if(s){var Be,tt=g==="x"?H:z,rt=g==="x"?K:_,ne=N[I],xe=I==="y"?"height":"width",We=ne+x[tt],$e=ne-x[rt],Ee=[H,z].indexOf(O)!==-1,Te=(Be=D==null?void 0:D[I])!=null?Be:0,He=Ee?We:ne-A[xe]-B[xe]-Te+W.altAxis,ze=Ee?ne+A[xe]+B[xe]-Te-W.altAxis:$e,Xe=m&&Ee?Rr(He,ne,ze):Ne(m?He:We,ne,m?ze:$e);N[I]=Xe,F[I]=Xe-ne}t.modifiersData[n]=F}}const on={name:"preventOverflow",enabled:!0,phase:"main",fn:nn,requiresIfExists:["offset"]};function an(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function sn(e){return e===Y(e)||!G(e)?ft(e):an(e)}function ln(e){var t=e.getBoundingClientRect(),r=Ie(t.width)/e.offsetWidth||1,n=Ie(t.height)/e.offsetHeight||1;return r!==1||n!==1}function cn(e,t,r){r===void 0&&(r=!1);var n=G(t),o=G(t)&&ln(t),i=ue(t),c=je(e,o,r),s={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((te(t)!=="body"||pt(i))&&(s=sn(t)),G(t)?(l=je(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):i&&(l.x=dt(i))),{x:c.left+s.scrollLeft-l.x,y:c.top+s.scrollTop-l.y,width:c.width,height:c.height}}function un(e){var t=new Map,r=new Set,n=[];e.forEach(function(i){t.set(i.name,i)});function o(i){r.add(i.name);var c=[].concat(i.requires||[],i.requiresIfExists||[]);c.forEach(function(s){if(!r.has(s)){var l=t.get(s);l&&o(l)}}),n.push(i)}return e.forEach(function(i){r.has(i.name)||o(i)}),n}function fn(e){var t=un(e);return yr.reduce(function(r,n){return r.concat(t.filter(function(o){return o.phase===n}))},[])}function dn(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function pn(e){var t=e.reduce(function(r,n){var o=r[n.name];return r[n.name]=o?Object.assign({},o,n,{options:Object.assign({},o.options,n.options),data:Object.assign({},o.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var jt={placement:"bottom",modifiers:[],strategy:"absolute"};function St(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function hn(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,o=t.defaultOptions,i=o===void 0?jt:o;return function(s,l,d){d===void 0&&(d=i);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},jt,i),modifiersData:{},elements:{reference:s,popper:l},attributes:{},styles:{}},h=[],y=!1,m={state:u,setOptions:function(O){var k=typeof O=="function"?O(u.options):O;j(),u.options=Object.assign({},i,u.options,k),u.scrollParents={reference:ve(s)?Pe(s):s.contextElement?Pe(s.contextElement):[],popper:Pe(l)};var C=fn(pn([].concat(n,u.options.modifiers)));return u.orderedModifiers=C.filter(function(g){return g.enabled}),E(),m.update()},forceUpdate:function(){if(!y){var O=u.elements,k=O.reference,C=O.popper;if(St(k,C)){u.rects={reference:cn(k,Fe(C),u.options.strategy==="fixed"),popper:ct(C)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(W){return u.modifiersData[W.name]=Object.assign({},W.data)});for(var g=0;g<u.orderedModifiers.length;g++){if(u.reset===!0){u.reset=!1,g=-1;continue}var I=u.orderedModifiers[g],N=I.fn,A=I.options,B=A===void 0?{}:A,L=I.name;typeof N=="function"&&(u=N({state:u,options:B,name:L,instance:m})||u)}}}},update:dn(function(){return new Promise(function(x){m.forceUpdate(),x(u)})}),destroy:function(){j(),y=!0}};if(!St(s,l))return m;m.setOptions(d).then(function(x){!y&&d.onFirstUpdate&&d.onFirstUpdate(x)});function E(){u.orderedModifiers.forEach(function(x){var O=x.name,k=x.options,C=k===void 0?{}:k,g=x.effect;if(typeof g=="function"){var I=g({state:u,name:O,instance:m,options:C}),N=function(){};h.push(I||N)}})}function j(){h.forEach(function(x){return x()}),h=[]}return m}}var vn=[Br,tn,Fr,jr,Zr,Gr,on,Pr,_r],mn=hn({defaultModifiers:vn}),gn=typeof Element<"u",wn=typeof Map=="function",xn=typeof Set=="function",bn=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function Ge(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n,o;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!Ge(e[n],t[n]))return!1;return!0}var i;if(wn&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;for(i=e.entries();!(n=i.next()).done;)if(!Ge(n.value[1],t.get(n.value[0])))return!1;return!0}if(xn&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(bn&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[n]))return!1;if(gn&&e instanceof Element)return!1;for(n=r;n--!==0;)if(!((o[n]==="_owner"||o[n]==="__v"||o[n]==="__o")&&e.$$typeof)&&!Ge(e[o[n]],t[o[n]]))return!1;return!0}return e!==e&&t!==t}var yn=function(t,r){try{return Ge(t,r)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}};const Cn=Ot(yn);var In=[],jn=function(t,r,n){n===void 0&&(n={});var o=w.useRef(null),i={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||In},c=w.useState({styles:{popper:{position:i.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),s=c[0],l=c[1],d=w.useMemo(function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(m){var E=m.state,j=Object.keys(E.elements);qt.flushSync(function(){l({styles:vt(j.map(function(x){return[x,E.styles[x]||{}]})),attributes:vt(j.map(function(x){return[x,E.attributes[x]]}))})})},requires:["computeStyles"]}},[]),u=w.useMemo(function(){var y={onFirstUpdate:i.onFirstUpdate,placement:i.placement,strategy:i.strategy,modifiers:[].concat(i.modifiers,[d,{name:"applyStyles",enabled:!1}])};return Cn(o.current,y)?o.current||y:(o.current=y,y)},[i.onFirstUpdate,i.placement,i.strategy,i.modifiers,d]),h=w.useRef();return mt(function(){h.current&&h.current.setOptions(u)},[u]),mt(function(){if(!(t==null||r==null)){var y=n.createPopper||mn,m=y(t,r,u);return h.current=m,function(){m.destroy(),h.current=null}}},[t,r,n.createPopper]),{state:h.current?h.current.state:null,styles:s.styles,attributes:s.attributes,update:h.current?h.current.update:null,forceUpdate:h.current?h.current.forceUpdate:null}};const nt=[[{icon:"bx-cut",label:"Cut",shortcut:"Ctrl+X",eventName:"onCut"},{icon:"bx-copy",label:"Copy",shortcut:"Ctrl+C",eventName:"onCopy"},{icon:"bx-paste",label:"Paste",shortcut:"Ctrl+P",eventName:"onPaste"}],[{icon:"bx-plus",label:"Insert one row top",eventName:"onInsertRowTop"},{icon:"bx-plus",label:"Insert one row bottom",eventName:"onInsertRowBottom"},{icon:"bx-plus",label:"Insert one column left",eventName:"onInsertColumnLeft"},{icon:"bx-plus",label:"Insert one column right",eventName:"onInsertColumnRight"}],[{icon:"bx-trash",label:"Delete row",eventName:"onDeleteRow"},{icon:"bx-trash",label:"Delete column",eventName:"onDeleteColumn"},{icon:"bx-trash",label:"Delete cell",eventName:"onDeleteCell"}]],Sn=({position:{x:e,y:t},...r})=>{const[n,o]=w.useState(null),i=w.useMemo(()=>({getBoundingClientRect:()=>({width:0,height:0,right:0,bottom:0,left:e,top:t})}),[e,t]),{attributes:c,styles:s}=jn(i,n,{placement:"right"});return f.jsx("div",{ref:o,className:"w-72 shadow-[0_2px_6px_2px_rgba(60,64,67,.15)] border border-transparent rounded bg-white z-20",style:s.popper,...c.popper,children:f.jsxs("div",{className:"flex flex-col py-3 font-medium",children:[nt[0].map(({icon:l,label:d,shortcut:u,eventName:h},y)=>f.jsxs("button",{className:"flex justify-between items-center h-8 hover:bg-[#F1F3F4] text-mild-black font-medium px-3",onClick:r[h],children:[f.jsxs("span",{className:"flex items-center gap-3",children:[f.jsx("i",{className:`${l} text-xl`}),d]}),f.jsx("span",{children:u})]},y)),f.jsx("div",{className:"w-full h-[1px] bg-[#dadce0] my-3"}),nt[1].map(({icon:l,label:d,eventName:u},h)=>f.jsxs("button",{className:"flex gap-3 items-center h-8 hover:bg-[#F1F3F4] text-mild-black font-medium px-3",onClick:r[u],children:[f.jsx("i",{className:`${l} text-xl`}),f.jsx("span",{children:d})]},h)),f.jsx("div",{className:"w-full h-[1px] bg-[#dadce0] my-3"}),nt[2].map(({icon:l,label:d,eventName:u},h)=>f.jsxs("button",{className:"flex gap-3 items-center h-8 hover:bg-[#F1F3F4] text-mild-black font-medium px-3",onClick:r[u],children:[f.jsx("i",{className:`${l} text-xl`}),f.jsx("span",{children:d})]},h))]})})},R={lineWidth:2,strokeStyle:"#C4C7C5",cellHeight:25,cellWidth:100,colWidth:46,rowHeight:25},On=()=>{const[e,t]=w.useState([]),[r,n]=w.useState([]),[o,i]=w.useState([]),[c,s]=w.useState(""),[l,d]=w.useState(1/0),[u,h]=w.useState(1/0),[y,m]=w.useState(null),[E,j]=w.useState(0),[x,O]=w.useState([]),[k,C]=w.useState(!1),[g,I]=w.useState(null),[N,A]=w.useState(0),{current:B}=w.useRef({}),{current:L}=w.useRef({}),{current:W}=w.useRef({}),D=w.useRef(null),F=w.useRef(null),$=w.useMemo(()=>o.find(({cellId:a})=>a===c),[e,r,c]),U=w.useMemo(()=>e.find(({rowId:a})=>a===u),[e,u]),q=w.useMemo(()=>r.find(({columnId:a})=>a===l),[r,l]);w.useEffect(()=>(window.addEventListener("keydown",T),()=>{window.removeEventListener("keydown",T)}),[]),w.useEffect(()=>{if(!D.current||!F.current)return;let a=F.current,{clientWidth:p,clientHeight:b}=D.current;a.width=p,a.height=b,X()},[]),w.useEffect(()=>{se()},[N]),w.useEffect(()=>(window.addEventListener("resize",se),()=>{window.removeEventListener("resize",se)}),[e,r]),w.useEffect(()=>{ce(e),pe(r)},[c,l,u]);const T=a=>{let{ctrlKey:p,key:b}=a;p&&b==="f"&&!k&&(a.preventDefault(),C(!0))},X=()=>{let{rows:a,cells:p,columns:b}=rr;for(let v of a)B[v.rowId]=v;for(let v of b)L[v.columnId]=v;for(let v of p){let S=`${v.columnId},${v.rowId}`;W[S]=v}},se=()=>{if(!D.current||!F.current)return;let{clientWidth:a,clientHeight:p}=D.current,b=F.current;b.width=a,b.height=p;let{rowId:v=1,y:S=R.rowHeight}=e[0]??{},{columnId:P=1,x:M=R.colWidth}=r[0]??{};V({offsetX:M,offsetY:S,rowStart:v,colStart:P})},re=(a,p,{height:b,rowId:v,width:S,x:P,y:M})=>{fe(a,p?"#D3E3FD":"#FFFFFF",{height:b,width:S,x:P,y:M}),a.save(),a.strokeStyle=R.strokeStyle,a.lineWidth=R.lineWidth,a.textAlign="center",a.textBaseline="middle",a.font=p?"12px Open-Sans-Medium":"12px Open-Sans",a.fillStyle=p?"#000000":"#575a5a",a.beginPath(),a.moveTo(P,M+b),a.lineTo(P+S,M+b),a.stroke(),a.fillText(v.toString(),P+S/2+1,M+b/2+1),a.restore()},me=(a,p,{columnId:b,height:v,width:S,x:P,y:M})=>{fe(a,p?"#D3E3FD":"#FFFFFF",{height:v,width:S,x:P,y:M}),a.save(),a.strokeStyle=R.strokeStyle,a.lineWidth=R.lineWidth,a.textAlign="center",a.textBaseline="middle",a.font=p?"12px Open-Sans-Medium":"12px Open-Sans",a.fillStyle=p?"#000000":"#575a5a",a.beginPath(),a.moveTo(P+S,M),a.lineTo(P+S,M+v),a.stroke(),a.fillText(at(b),P+S/2+1,M+v/2+1),a.restore()},fe=(a,p,{x:b,y:v,height:S,width:P})=>{a.save(),a.fillStyle=p,a.beginPath(),a.moveTo(b,v),a.fillRect(b,v,P,S),a.fill(),a.restore()},de=(a,{height:p,width:b,x:v,y:S})=>{a.save(),a.strokeStyle=R.strokeStyle,a.lineWidth=R.lineWidth,a.beginPath(),a.moveTo(v,S+p),a.lineTo(v+b,S+p),a.lineTo(v+b,S),a.stroke(),a.restore()},ge=(a,p,{height:b,width:v,x:S,y:P})=>{a.font="14px Open-Sans",a.beginPath(),a.fillText(p,S,P+14)},le=(a,{cellId:p,rowId:b,columnId:v,height:S,width:P,x:M,y:oe})=>{let{backgroundColor:be="#FFFFFF",color:Ve="#000000",html:Ye=""}=W[p]??{},ye={x:M,y:oe,width:P,height:S};fe(a,be,ye),ge(a,Ye,ye),de(a,ye)},Q=a=>{a.save(),a.fillStyle="#FFFFFF",a.strokeStyle=R.strokeStyle,a.lineWidth=R.lineWidth-.5,a.beginPath(),a.moveTo(0,0),a.fillRect(0,0,R.colWidth,R.rowHeight),a.beginPath(),a.moveTo(0,0),a.strokeRect(0,1,R.colWidth,R.rowHeight-1),a.stroke(),a.restore()},ce=a=>{if(!F.current||!a.length)return;let p=F.current.getContext("2d"),b=+c.split(",")[1];for(let v of a){let S=v.rowId===b||l!==1/0;re(p,S,v)}p.save(),p.strokeStyle=R.strokeStyle,p.lineWidth=R.lineWidth-.5,p.beginPath(),p.moveTo(0,R.rowHeight),p.lineTo(0,F.current.clientHeight),p.stroke(),p.beginPath(),p.moveTo(R.colWidth,R.rowHeight),p.lineTo(R.colWidth,F.current.clientHeight),p.stroke(),p.restore()},pe=a=>{if(!F.current||!a.length)return;let p=F.current.getContext("2d"),b=+c.split(",")[0];for(let v of a){let S=v.columnId===b||u!==1/0;me(p,S,v)}p.save(),p.beginPath(),p.strokeStyle=R.strokeStyle,p.lineWidth=R.lineWidth-.5,p.moveTo(R.colWidth,R.rowHeight),p.lineTo(F.current.clientWidth,R.rowHeight),p.stroke(),p.beginPath(),p.moveTo(R.colWidth,1),p.lineTo(F.current.clientWidth,1),p.stroke(),p.restore()},V=({offsetX:a,offsetY:p,rowStart:b,colStart:v})=>{var Ye,ye;if(!D.current||!F.current)return;let S=F.current.getContext("2d"),{clientWidth:P,clientHeight:M}=D.current;S.clearRect(0,0,P,M);let oe=[],be=[],Ve=[];for(let Z=b,J=p;J<M;Z++){let ie=((Ye=B[Z])==null?void 0:Ye.height)||R.cellHeight;J+ie>R.rowHeight&&oe.push({y:J,x:0,rowId:Z,height:ie,width:R.colWidth}),J+=ie}for(let Z=v,J=a;J<P;Z++){let ie=((ye=L[Z])==null?void 0:ye.width)||R.cellWidth;J+ie>R.colWidth&&be.push({x:J,y:0,columnId:Z,width:ie,height:R.rowHeight}),J+=ie}for(let{rowId:Z,height:J,y:ie}of oe)for(let{width:zt,x:Xt,columnId:ht}of be){let Vt=`${ht},${Z}`;Ve.push({x:Xt,y:ie,rowId:Z,columnId:ht,width:zt,height:J,cellId:Vt}),le(S,Ve.at(-1))}ce(oe),pe(be),Q(S),t(oe),n(be),i(Ve)},we=a=>{if(!D.current)return;let p=a.pageX,b=a.pageY-D.current.getBoundingClientRect().top,v=Je(p,b);v&&(s(v),m(null),d(1/0),h(1/0),I(null))},Je=(a,p)=>{let b=0,v=e.length-1,S=null;for(;b<=v;){let M=Math.floor((b+v)/2);e[M].y<=p?(b=M+1,S=e[M].rowId):v=M-1}if(!S)return null;b=0,v=r.length-1;let P=null;for(;b<=v;){let M=Math.floor((b+v)/2);r[M].x<=a?(b=M+1,P=r[M].columnId):v=M-1}return P?`${P},${S}`:null},Oe=a=>{var P;if(!e.length||!r.length)return;let{rowId:p,y:b}=e[0],{columnId:v,x:S}=r[0];if(a<0){for(b+=-a,p--;p>0&&b>R.rowHeight;)b-=((P=B[p])==null?void 0:P.height)??R.cellHeight,p--;V({offsetX:S,offsetY:Math.min(R.rowHeight,b),rowStart:p+1,colStart:v})}else V({offsetX:S,offsetY:b+-a,rowStart:p,colStart:v})},Qe=a=>{var P;if(!e.length||!r.length)return;let{rowId:p,y:b}=e[0],{columnId:v,x:S}=r[0];if(a<0){for(S+=-a,v--;v>0&&S>R.colWidth;)S-=((P=L[v])==null?void 0:P.width)??R.cellWidth,v--;V({offsetX:Math.min(R.colWidth,S),offsetY:b,rowStart:p,colStart:v+1})}else V({offsetX:S+-a,offsetY:b,rowStart:p,colStart:v})},Re=a=>{let{deltaX:p,deltaY:b}=a;p===0?Oe(b):Qe(p)},Ze=()=>{if(!D.current||!$)return;let{columnId:a,cellId:p,width:b,height:v,rowId:S,x:P,y:M}=$,{top:oe}=D.current.getBoundingClientRect();m({cellId:p,columnId:a,width:b,height:v,rowId:S,x:Math.max(R.colWidth,P),y:Math.max(R.rowHeight+oe,M+oe)})},et=a=>{a.preventDefault(),we(a),I({x:a.pageX,y:a.pageY})},Le=a=>{d(a),h(1/0),s(""),m(null),I(null)},Be=a=>{h(a),d(1/0),s(""),m(null),I(null)},tt=(a,p)=>{L[a]?L[a].width=p:L[a]={columnId:a,width:p},A(Math.random())},rt=(a,p)=>{B[a]?B[a].height=p:B[a]={rowId:a,height:p},A(Math.random())},ne=()=>{j(a=>(a++,a===x.length?0:a))},xe=()=>{j(a=>(a--,a<0?x.length-1:a))},We=a=>{O(["1,1","2,5","4,5","5,1","2,2"])},$e=()=>{C(!1),O([])},Ee=()=>{console.log("copy")},Te=()=>{console.log("cut")},He=()=>{console.log("paste")},ze=()=>{console.log("delete cell")},Xe=()=>{console.log("delete row")},Bt=()=>{console.log("delete column")},Wt=()=>{console.log("insert column left")},$t=()=>{console.log("insert column right")},Tt=()=>{console.log("insert row bottom")},Ht=()=>{console.log("insert row top")};return f.jsxs(w.Fragment,{children:[f.jsxs("div",{ref:D,className:"relative h-[var(--grid-height)] select-none overflow-hidden",onClick:we,onContextMenu:et,onWheel:Re,children:[f.jsx("canvas",{ref:F}),f.jsx(Zt,{columns:r,onClick:Le,onResize:tt}),f.jsx(er,{rows:e,onClick:Be,onResize:rt}),q&&f.jsx(ar,{selectedColumn:q}),U&&f.jsx(sr,{selectedRow:U}),f.jsxs("div",{className:"absolute left-[var(--col-width)] top-[var(--row-height)] w-full h-full overflow-hidden",children:[!y&&$&&f.jsx(Jt,{selectedCell:$,onDoubleClick:Ze}),k&&x.length>0&&f.jsx(ir,{activeIndex:E,visibleCells:o,cellIds:x}),q&&f.jsx(lr,{selectedColumn:q}),U&&f.jsx(cr,{selectedRow:U})]})]}),y&&f.jsx(Qt,{cell:y,data:W[y.cellId],onWheel:Re}),k&&f.jsx(tr,{count:x.length,activeIndex:E,onNext:ne,onPrevious:xe,onSearch:We,onClose:$e}),g&&f.jsx(Sn,{position:g,onCopy:Ee,onCut:Te,onPaste:He,onDeleteCell:ze,onDeleteColumn:Bt,onDeleteRow:Xe,onInsertColumnLeft:Wt,onInsertColumnRight:$t,onInsertRowBottom:Tt,onInsertRowTop:Ht})]})},Rn=()=>f.jsx("div",{className:"fixed left-0 bottom-0 w-full h-[var(--bottom-bar-height)] bg-light-silver border-t border-mild-silver",children:"Bottom Bar"}),kn=()=>{const e={_id:"1",email:"vkaswin@gmail.com",name:"Aswin Kumar"},t=()=>{console.log("logout")};return f.jsxs(w.Fragment,{children:[f.jsx(Kt,{user:e,onLogout:t}),f.jsx(_t,{}),f.jsx(On,{}),f.jsx(Rn,{})]})};export{kn as default};
