import{j as t,g as Ye,r as c,c as ee,d as Oe,a as Ue}from"./index-b800108f.js";let Ge=[{label:"File"},{label:"Edit"},{label:"View"},{label:"Insert"},{label:"Format"},{label:"Data"},{label:"Tools"},{label:"Extensions"},{label:"Help"}];const Ke=()=>{const s=g=>{};return t.jsxs("div",{className:"bg-light-silver h-[var(--toolbar-height)]",children:[t.jsxs("div",{className:"flex items-center h-[65px]",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{className:"w-[60px] h-[42px]",src:Ye("/logo.png")}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-dark-gray font-medium text-base border border-transparent px-1 outline-none rounded-sm hover:border-gray-500 focus:border-gray-500",contentEditable:!0,onInput:s,dangerouslySetInnerHTML:{__html:"Untitled Spreadsheet"}}),t.jsx("i",{className:"icon-star-outline"}),t.jsx("i",{className:"icon-folder-move-outline"}),t.jsx("i",{className:"icon-cloud-check-outline"})]}),t.jsx("div",{className:"flex gap-1",children:Ge.map(({label:g},a)=>t.jsx("button",{className:"px-2 bg-transparent transition-background duration-100 hover:bg-light-gray text-[15px] rounded",children:g},a))})]})]}),t.jsx("div",{className:""})]}),t.jsx("div",{className:"flex items-center h-[45px] px-2 mx-[15px] rounded-full",children:"Toolbar"})]})},Ve=()=>t.jsxs("div",{className:"flex gap-2 px-2 items-center h-[var(--typing-bar-height)]",children:[t.jsx("input",{name:"id",className:"outline-none w-[100px] px-2 bg-transparent text-sm border-2 rounded-sm border-transparent hover:bg-[#ededed] focus:border-dark-blue"}),t.jsx("div",{className:"w-[2px] bg-[#dadce0] h-[50%] border-none"}),t.jsxs("div",{className:"flex items-center w-full",children:[t.jsx("i",{className:"icon-format-text text-[#a8a9a9] font-bold"}),t.jsx("input",{name:"content",className:"w-full border-none outline-none bg-transparent px-2 text-sm"})]})]}),qe=({selectedCell:s,onDoubleClick:g})=>{let{columnId:a,height:l,cellId:u,rowId:d,width:m,x:p,y:w}=s,b=`calc(${p}px - var(--col-width))`,I=`calc(${w}px - var(--row-height))`;return t.jsx("div",{className:"absolute flex text-sm bg-transparent border-2 border-blue p-1 z-10",style:{left:b,top:I,width:m,height:l},onDoubleClick:g})},Je=({cell:s,data:g,onWheel:a})=>{const l=c.useRef(null);let{x:u,y:d,rowId:m,height:p,columnId:w,width:b}=s,{color:I="#000000",backgroundColor:S="#FFFFFF",html:N=""}=g??{};c.useEffect(()=>{l.current&&L(l.current)},[s]);const L=z=>{let M=window.getSelection();if(!M)return;let v=document.createRange();v.setStart(z,z.childNodes.length),v.collapse(!0),M.removeAllRanges(),M.addRange(v)};return t.jsxs("div",{className:"absolute flex border-1 outline outline-3 outline-light-blue p-[2px] z-10",style:{width:b,height:p,left:u,top:d,backgroundColor:S,color:I},onWheel:a,children:[t.jsx("div",{ref:l,className:"w-full h-full text-sm outline outline-2 outline-dark-blue p-[2px]",contentEditable:!0,dangerouslySetInnerHTML:{__html:N}}),t.jsxs("div",{className:"absolute -top-7 left-0 bg-blue text-xs font-medium text-white rounded-sm px-2 py-1",children:[ee(w),m]})]})},Qe=({columns:s,onClick:g,onResize:a})=>{const[l,u]=c.useState(null),[d,m]=c.useState(!1),[p,w]=c.useState(!1),b=c.useRef(null),I=c.useRef(null),S=x=>{!b.current||!l||(I.current=x.pageX,b.current.setPointerCapture(x.pointerId),b.current.addEventListener("pointermove",N),b.current.addEventListener("pointerup",L,{once:!0}),m(!0))},N=x=>{if(!b.current||!I.current||!l)return;let{pageX:C}=x,j=l.width+-(I.current-C);j<50||u({...l,width:j})},L=x=>{if(!b.current||!l||!I.current)return;let{pageX:C}=x;b.current.removeEventListener("pointermove",N);let j=l.width+-(I.current-C);a(l.columnId,Math.max(50,j)),I.current=null,u(null),m(!1)},z=()=>{w(!p)},M=x=>{let C=0,j=s.length-1,$=null;for(;C<=j;){let H=Math.floor((C+j)/2);s[H].x<=x?(C=H+1,$=H):j=H-1}return $===null?null:s[$]},v=x=>{if(d)return;let C=M(x.pageX);!C||(l==null?void 0:l.columnId)===C.columnId||u({...C})},y=()=>{u(null)};return t.jsxs(c.Fragment,{children:[t.jsx("div",{className:"absolute left-0 top-0 w-full h-[var(--row-height)] z-10",onMouseMove:v,onMouseLeave:y,children:l&&t.jsxs("div",{className:"absolute",style:{width:l.width,height:l.height,left:l.x,top:l.y},onClick:()=>g(l.columnId),children:[t.jsx("div",{className:"absolute top-0 -right-3 w-6 h-full bg-transparent",onMouseEnter:z}),t.jsxs("div",{ref:b,className:"absolute top-0 -right-[5px] flex gap-[5px] items-center h-full cursor-col-resize",onPointerDown:S,children:[t.jsx("div",{className:"bg-black rounded-md w-[3px] h-2/3"}),t.jsx("div",{className:"bg-black rounded-md w-[3px] h-2/3"})]})]})}),l&&d&&t.jsx("div",{className:"absolute w-[3px] h-full bg-slate-400 z-10",style:{left:l.x+l.width-2,top:0}})]})},Ze=({rows:s,onClick:g,onResize:a})=>{const[l,u]=c.useState(null),[d,m]=c.useState(!1),p=c.useRef(null),w=c.useRef(null),b=c.useRef(null),I=v=>{!p.current||!l||(w.current=v.pageY,p.current.setPointerCapture(v.pointerId),p.current.addEventListener("pointermove",S),p.current.addEventListener("pointerup",N,{once:!0}),m(!0))},S=v=>{if(!p.current||!w.current||!l)return;let{pageY:y}=v,x=l.height+-(w.current-y);x<=25||u({...l,height:x})},N=v=>{if(!p.current||!l||!w.current)return;let{pageY:y}=v;p.current.removeEventListener("pointermove",S);let x=l.height+-(w.current-y);a(l.rowId,Math.max(25,x)),w.current=null,u(null),m(!1)},L=v=>{let y=0,x=s.length-1,C=null;for(;y<=x;){let j=Math.floor((y+x)/2);s[j].y<=v?(y=j+1,C=j):x=j-1}return C===null?null:s[C]},z=v=>{if(!b.current||d)return;let{top:y}=b.current.getBoundingClientRect(),x=L(v.pageY-y);!x||(l==null?void 0:l.rowId)===x.rowId||u({...x})},M=()=>{u(null)};return t.jsxs(c.Fragment,{children:[t.jsx("div",{ref:b,className:"absolute left-0 top-0 w-[var(--col-width)] h-full z-10",onMouseMove:z,onMouseLeave:M,children:l&&t.jsx("div",{className:"absolute",style:{width:l.width,height:l.height,left:l.x,top:l.y},onClick:()=>g(l.rowId),children:t.jsxs("div",{ref:p,className:"absolute left-0 -bottom-[5px] flex flex-col items-center gap-[5px] w-full cursor-row-resize",onPointerDown:I,children:[t.jsx("div",{className:"bg-black rounded-md h-[3px] w-3/5"}),t.jsx("div",{className:"bg-black rounded-md h-[3px] w-3/5"})]})})}),l&&d&&t.jsx("div",{className:"absolute h-[3px] w-full bg-slate-400 z-10",style:{left:0,top:l.y+l.height-2}})]})},et=({count:s,activeIndex:g,onPrevious:a,onNext:l,onSearch:u,onClose:d})=>{const m=p=>{u(p.target.value)};return t.jsxs("div",{className:"fixed flex items-center gap-2 top-6 right-6 border border-mild-gray rounded-md px-4 py-5",children:[t.jsxs("div",{className:"relative w-44 h-9",children:[t.jsx("input",{placeholder:"Find in sheet",className:"w-full h-full outline-dark-blue border border-mild-gray text-sm rounded px-2 py-2 pr-14",onChange:Oe(m,500)}),s>0&&t.jsxs("span",{className:"absolute flex top-1/2 -translate-y-1/2 right-3 text-xs text-light-gray",children:[g+1," of ",s]})]}),t.jsx("button",{className:"text-gray-400 text-xl disabled:opacity-50 disabled:cursor-not-allowed",disabled:!s,children:t.jsx("i",{className:"bx-chevron-up",onClick:a})}),t.jsx("button",{className:"text-gray-400 text-xl disabled:opacity-50 disabled:cursor-not-allowed",disabled:!s,children:t.jsx("i",{className:"bx-chevron-down ",onClick:l})}),t.jsx("button",{className:"text-xl text-dark-gray",children:t.jsx("i",{className:"bx-x",onClick:d})})]})},tt={rows:[{height:200,rowId:1},{height:35,rowId:2},{height:39,rowId:3},{height:50,rowId:4},{height:128,rowId:5},{height:77,rowId:6},{height:99,rowId:7},{height:100,rowId:13},{height:35,rowId:15},{height:39,rowId:33},{height:50,rowId:24},{height:128,rowId:45},{height:150,rowId:50},{height:77,rowId:66},{height:99,rowId:37}],columns:[{width:350,columnId:1},{width:175,columnId:2},{width:220,columnId:3},{width:270,columnId:5},{width:125,columnId:9}],cells:[{rowId:1,columnId:5,html:"Loreum Ispum"},{rowId:2,columnId:2,html:"Loreum Ispum"},{backgroundColor:"#CADAF8",color:"white",html:"<span>Loreum Ispum</span><br><span style='font-size:20px; font-color: red'>Loreum Ispum</span>",rowId:50,columnId:2},{backgroundColor:"#EA9999",color:"white",rowId:1,columnId:1,html:"<span>Loreum Ispum</span><br><span style='font-size:20px; font-color: red'>Loreum Ispum</span>"},{backgroundColor:"#B7E1CD",html:"<b>Loreum Ispum</b>",rowId:4,columnId:2},{backgroundColor:"#CADAF8",html:"<span>Loreum Ispum</span>",columnId:3,rowId:6},{html:"Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#FEE599",rowId:5,columnId:5},{html:"Lorem Ipsum Lorem Ipsum is simply dummy text of the printing Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#B3A7D6",rowId:2,columnId:8},{backgroundColor:"#FFF2CC",html:"<b>Loreum Ispum</b>",rowId:12,columnId:6},{backgroundColor:"#B7B7B7",html:"<span>Loreum</span>",rowId:25,columnId:4},{html:"Loreum Ispum",rowId:9,columnId:3},{html:"Loreum Ispum",backgroundColor:"#766CEB",color:"white",rowId:80,columnId:5}]};var de={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(s){(function(){var g={}.hasOwnProperty;function a(){for(var l=[],u=0;u<arguments.length;u++){var d=arguments[u];if(d){var m=typeof d;if(m==="string"||m==="number")l.push(d);else if(Array.isArray(d)){if(d.length){var p=a.apply(null,d);p&&l.push(p)}}else if(m==="object"){if(d.toString!==Object.prototype.toString&&!d.toString.toString().includes("[native code]")){l.push(d.toString());continue}for(var w in d)g.call(d,w)&&d[w]&&l.push(w)}}}return l.join(" ")}s.exports?(a.default=a,s.exports=a):window.classNames=a})()})(de);var lt=de.exports;const nt=Ue(lt),ot=({activeIndex:s,cellIds:g,visibleCells:a})=>{const l=c.useMemo(()=>new Set(g),[g]);return t.jsx(c.Fragment,{children:a.map(({cellId:u,columnId:d,height:m,rowId:p,width:w,x:b,y:I})=>{if(!l.has(u))return null;let S=`calc(${b}px - var(--col-width))`,N=`calc(${I}px - var(--row-height))`;return t.jsx("div",{className:nt("absolute",u===g[s]?"bg-[rgba(55,190,95,.702)] shadow-[0_0_0_2px_#146c2e] border border-white":"bg-[rgba(109,213,140,.4)]"),style:{width:w,height:m,left:S,top:N}},u)})})},rt=({selectedColumn:s})=>{const{columnId:g,height:a,width:l,x:u,y:d}=s;return t.jsx("div",{className:"absolute flex justify-center items-center bg-dark-blue",style:{left:u,top:d,width:l,height:a},children:t.jsx("span",{className:"text-white text-xs font-medium",children:ee(g)})})},st=({selectedRow:s})=>{const{height:g,rowId:a,width:l,x:u,y:d}=s;return t.jsx("div",{className:"absolute flex justify-center items-center bg-dark-blue",style:{left:u,top:d,width:l,height:g},children:t.jsx("span",{className:"text-white text-xs font-medium",children:a})})},it=({selectedColumn:s})=>{let{columnId:g,height:a,width:l,x:u,y:d}=s,m=`calc(${u}px - var(--col-width))`,p=`calc(${d}px - var(--row-height))`;return t.jsx("div",{className:"absolute top-[var(--col-height)] left-0 w-[var(--col-width)] border-dark-blue border-r border-l bg-light-sky-blue h-full",style:{width:l,left:m,top:p}})},at=({selectedRow:s})=>{let{rowId:g,height:a,width:l,x:u,y:d}=s,m=`calc(${u}px - var(--col-width))`,p=`calc(${d}px - var(--row-height))`;return t.jsx("div",{className:"absolute top-[var(--col-height)] left-0 w-full border-dark-blue border-t border-b bg-light-sky-blue",style:{height:a,left:m,top:p}})},Z=[[{icon:"bx-cut",label:"Cut",shortcut:"Ctrl+X",eventName:"onCut"},{icon:"bx-copy",label:"Copy",shortcut:"Ctrl+C",eventName:"onCopy"},{icon:"bx-paste",label:"Paste",shortcut:"Ctrl+P",eventName:"onPaste"}],[{icon:"bx-plus",label:"Insert one row top",eventName:"onInsertRowTop"},{icon:"bx-plus",label:"Insert one row bottom",eventName:"onInsertRowBottom"},{icon:"bx-plus",label:"Insert one column left",eventName:"onInsertColumnLeft"},{icon:"bx-plus",label:"Insert one column right",eventName:"onInsertColumnRight"}],[{icon:"bx-trash",label:"Delete row",eventName:"onDeleteRow"},{icon:"bx-trash",label:"Delete column",eventName:"onDeleteColumn"},{icon:"bx-trash",label:"Delete cell",eventName:"onDeleteCell"}]],ct=({position:{x:s,y:g},...a})=>t.jsx("div",{className:"fixed w-72 shadow-[0_2px_6px_2px_rgba(60,64,67,.15)] border border-transparent rounded bg-white z-20",style:{left:s,top:g-100},children:t.jsxs("div",{className:"flex flex-col py-3 font-medium",children:[Z[0].map(({icon:l,label:u,shortcut:d,eventName:m},p)=>t.jsxs("button",{className:"flex justify-between items-center h-8 hover:bg-[#F1F3F4] text-mild-black font-medium px-3",onClick:a[m],children:[t.jsxs("span",{className:"flex items-center gap-3",children:[t.jsx("i",{className:`${l} text-xl`}),u]}),t.jsx("span",{children:d})]},p)),t.jsx("div",{className:"w-full h-[1px] bg-[#dadce0] my-3"}),Z[1].map(({icon:l,label:u,eventName:d},m)=>t.jsxs("button",{className:"flex gap-3 items-center h-8 hover:bg-[#F1F3F4] text-mild-black font-medium px-3",onClick:a[d],children:[t.jsx("i",{className:`${l} text-xl`}),t.jsx("span",{children:u})]},m)),t.jsx("div",{className:"w-full h-[1px] bg-[#dadce0] my-3"}),Z[2].map(({icon:l,label:u,eventName:d},m)=>t.jsxs("button",{className:"flex gap-3 items-center h-8 hover:bg-[#F1F3F4] text-mild-black font-medium px-3",onClick:a[d],children:[t.jsx("i",{className:`${l} text-xl`}),t.jsx("span",{children:u})]},m))]})}),B=46,T=25,ae=100,ce=25,dt=()=>{const[s,g]=c.useState([]),[a,l]=c.useState([]),[u,d]=c.useState([]),[m,p]=c.useState(""),[w,b]=c.useState(1/0),[I,S]=c.useState(1/0),[N,L]=c.useState(null),[z,M]=c.useState(0),[v,y]=c.useState([]),[x,C]=c.useState(!1),[j,$]=c.useState(null),[H,te]=c.useState(0),{current:A}=c.useRef({}),{current:X}=c.useRef({}),{current:q}=c.useRef({}),R=c.useRef(null),k=c.useRef(null),O=c.useMemo(()=>u.find(({cellId:e})=>e===m),[s,a,m]),U=c.useMemo(()=>s.find(({rowId:e})=>e===I),[s,I]),G=c.useMemo(()=>a.find(({columnId:e})=>e===w),[a,w]);c.useEffect(()=>(window.addEventListener("keydown",le),()=>{window.removeEventListener("keydown",le)}),[]),c.useEffect(()=>{if(!R.current||!k.current)return;let e=k.current,{clientWidth:o,clientHeight:r}=R.current;e.width=o,e.height=r,ue()},[]),c.useEffect(()=>{J()},[H]),c.useEffect(()=>(window.addEventListener("resize",J),()=>{window.removeEventListener("resize",J)}),[s,a]),c.useEffect(()=>{ne(s),oe(a)},[m,w,I]);const le=e=>{let{ctrlKey:o,key:r}=e;o&&r==="f"&&!x&&(e.preventDefault(),C(!0))},ue=()=>{let{rows:e,cells:o,columns:r}=tt;for(let n of e)A[n.rowId]=n;for(let n of r)X[n.columnId]=n;for(let n of o){let i=`${n.columnId},${n.rowId}`;q[i]=n}},J=()=>{if(!R.current||!k.current)return;let{clientWidth:e,clientHeight:o}=R.current,r=k.current;r.width=e,r.height=o;let{rowId:n=1,y:i=T}=s[0]??{},{columnId:h=1,x:f=B}=a[0]??{};Y({offsetX:f,offsetY:i,rowStart:n,colStart:h})},he=(e,o,{height:r,rowId:n,width:i,x:h,y:f})=>{e.clearRect(h,f,i,r),Q(e,o?"#D3E3FD":"#FFFFFF",{height:r,width:i,x:h,y:f}),e.save(),e.beginPath(),e.moveTo(h+i,f),e.lineTo(h+i,f+r),e.lineTo(h,f+r),e.strokeStyle="#C4C7C5",e.lineWidth=2,e.stroke(),e.textAlign="center",e.textBaseline="middle",e.font=o?"12px Open-Sans-Medium":"12px Open-Sans",e.fillStyle=o?"#000000":"#575a5a",e.fillText(n.toString(),h+i/2+1,f+r/2+1),e.restore()},me=(e,o,{columnId:r,height:n,width:i,x:h,y:f})=>{e.clearRect(h,f,i,n),Q(e,o?"#D3E3FD":"#FFFFFF",{height:n,width:i,x:h,y:f}),e.save(),e.beginPath(),e.moveTo(h,f),e.lineTo(h+i,f),e.lineTo(h+i,f+n),e.lineTo(h,f+n),e.strokeStyle="#C4C7C5",e.lineWidth=2,e.stroke(),e.textAlign="center",e.textBaseline="middle",e.font=o?"12px Open-Sans-Medium":"12px Open-Sans",e.fillStyle=o?"#000000":"#575a5a",e.fillText(ee(r),h+i/2+1,f+n/2+1),e.restore()},Q=(e,o,{x:r,y:n,height:i,width:h})=>{e.save(),e.fillStyle=o,e.beginPath(),e.moveTo(r,n),e.fillRect(r,n,h,i),e.fill(),e.restore()},fe=(e,{height:o,width:r,x:n,y:i})=>{e.save(),e.beginPath(),e.moveTo(n,i+o),e.lineTo(n+r,i+o),e.lineTo(n+r,i),e.strokeStyle="#C4C7C5",e.lineWidth=2,e.stroke(),e.restore()},pe=(e,o,{height:r,width:n,x:i,y:h})=>{e.font="14px Open-Sans",e.beginPath(),e.fillText(o,i,h+14)},ge=(e,{cellId:o,rowId:r,columnId:n,height:i,width:h,x:f,y:D})=>{let{backgroundColor:_="#FFFFFF",color:K="#000000",html:V=""}=q[o]??{},W={x:f,y:D,width:h,height:i};e.clearRect(f,D,h,i),Q(e,_,W),pe(e,V,W),fe(e,W)},xe=e=>{e.save(),e.clearRect(0,0,B,T),e.fillStyle="#FFFFFF",e.fillRect(0,0,B,T),e.strokeStyle="#C4C7C5",e.lineWidth=2,e.strokeRect(0,0,B,T),e.stroke(),e.restore()},ne=e=>{if(!k.current||!e.length)return;let o=k.current.getContext("2d"),r=+m.split(",")[1];for(let n of e){let i=n.rowId===r||w!==1/0;he(o,i,n)}},oe=e=>{if(!k.current||!e.length)return;let o=k.current.getContext("2d"),r=+m.split(",")[0];for(let n of e){let i=n.columnId===r||I!==1/0;me(o,i,n)}},Y=({offsetX:e,offsetY:o,rowStart:r,colStart:n})=>{var V,W;if(!R.current||!k.current)return;let i=k.current.getContext("2d"),{clientWidth:h,clientHeight:f}=R.current,D=[],_=[],K=[];for(let E=r,F=o;F<f;E++){let P=((V=A[E])==null?void 0:V.height)||ce;F+P>T&&D.push({y:F,x:0,rowId:E,height:P,width:B}),F+=P}for(let E=n,F=e;F<h;E++){let P=((W=X[E])==null?void 0:W.width)||ae;F+P>B&&_.push({x:F,y:0,columnId:E,width:P,height:T}),F+=P}for(let{rowId:E,height:F,y:P}of D)for(let{width:Xe,x:_e,columnId:ie}of _){let We=`${ie},${E}`;K.push({x:_e,y:P,rowId:E,columnId:ie,width:Xe,height:F,cellId:We}),ge(i,K.at(-1))}ne(D),oe(_),xe(i),g(D),l(_),d(K)},re=e=>{if(!R.current)return;let o=e.pageX,r=e.pageY-R.current.getBoundingClientRect().top,n=we(o,r);n&&(p(n),L(null),b(1/0),S(1/0),$(null))},we=(e,o)=>{let r=0,n=s.length-1,i=null;for(;r<=n;){let f=Math.floor((r+n)/2);s[f].y<=o?(r=f+1,i=s[f].rowId):n=f-1}if(!i)return null;r=0,n=a.length-1;let h=null;for(;r<=n;){let f=Math.floor((r+n)/2);a[f].x<=e?(r=f+1,h=a[f].columnId):n=f-1}return h?`${h},${i}`:null},be=e=>{var h;if(!s.length||!a.length)return;let{rowId:o,y:r}=s[0],{columnId:n,x:i}=a[0];if(e<0){for(r+=-e,o--;o>0&&r>T;)r-=((h=A[o])==null?void 0:h.height)??ce,o--;Y({offsetX:i,offsetY:Math.min(T,r),rowStart:o+1,colStart:n})}else Y({offsetX:i,offsetY:r+-e,rowStart:o,colStart:n})},ve=e=>{var h;if(!s.length||!a.length)return;let{rowId:o,y:r}=s[0],{columnId:n,x:i}=a[0];if(e<0){for(i+=-e,n--;n>0&&i>B;)i-=((h=X[n])==null?void 0:h.width)??ae,n--;Y({offsetX:Math.min(B,i),offsetY:r,rowStart:o,colStart:n+1})}else Y({offsetX:i+-e,offsetY:r,rowStart:o,colStart:n})},se=e=>{let{deltaX:o,deltaY:r}=e;o===0?be(r):ve(o)},Ie=()=>{if(!R.current||!O)return;let{columnId:e,cellId:o,width:r,height:n,rowId:i,x:h,y:f}=O,{top:D}=R.current.getBoundingClientRect();L({cellId:o,columnId:e,width:r,height:n,rowId:i,x:Math.max(B,h),y:Math.max(T+D,f+D)})},Ce=e=>{e.preventDefault(),re(e),$({x:e.pageX,y:e.pageY})},je=e=>{b(e),S(1/0),p(""),L(null),$(null)},ye=e=>{S(e),b(1/0),p(""),L(null),$(null)},Ne=(e,o)=>{X[e]?X[e].width=o:X[e]={columnId:e,width:o},te(Math.random())},Se=(e,o)=>{A[e]?A[e].height=o:A[e]={rowId:e,height:o},te(Math.random())},Re=()=>{M(e=>(e++,e===v.length?0:e))},ke=()=>{M(e=>(e--,e<0?v.length-1:e))},Fe=e=>{y(["1,1","2,5","4,5","5,1","2,2"])},Le=()=>{C(!1),y([])},Me=()=>{console.log("copy")},De=()=>{console.log("cut")},Ee=()=>{console.log("paste")},ze=()=>{console.log("delete cell")},Pe=()=>{console.log("delete row")},Be=()=>{console.log("delete column")},Te=()=>{console.log("insert column left")},$e=()=>{console.log("insert column right")},He=()=>{console.log("insert row bottom")},Ae=()=>{console.log("insert row top")};return t.jsxs(c.Fragment,{children:[t.jsxs("div",{ref:R,className:"relative h-[var(--grid-height)] select-none overflow-hidden",onClick:re,onContextMenu:Ce,onWheel:se,children:[t.jsx("canvas",{ref:k}),t.jsx("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-[var(--row-height)] border-b-4 border-r-4 border-t border-l border-light-gray bg-white z-20"}),t.jsx(Qe,{columns:a,onClick:je,onResize:Ne}),t.jsx(Ze,{rows:s,onClick:ye,onResize:Se}),G&&t.jsx(rt,{selectedColumn:G}),U&&t.jsx(st,{selectedRow:U}),t.jsxs("div",{className:"absolute left-[var(--col-width)] top-[var(--row-height)] w-full h-full overflow-hidden",children:[!N&&O&&t.jsx(qe,{selectedCell:O,onDoubleClick:Ie}),x&&v.length>0&&t.jsx(ot,{activeIndex:z,visibleCells:u,cellIds:v}),G&&t.jsx(it,{selectedColumn:G}),U&&t.jsx(at,{selectedRow:U})]})]}),N&&t.jsx(Je,{cell:N,data:q[N.cellId],onWheel:se}),x&&t.jsx(et,{count:v.length,activeIndex:z,onNext:Re,onPrevious:ke,onSearch:Fe,onClose:Le}),j&&t.jsx(ct,{position:j,onCopy:Me,onCut:De,onPaste:Ee,onDeleteCell:ze,onDeleteColumn:Be,onDeleteRow:Pe,onInsertColumnLeft:Te,onInsertColumnRight:$e,onInsertRowBottom:He,onInsertRowTop:Ae})]})},ut=()=>t.jsx("div",{className:"fixed left-0 bottom-0 w-full h-[var(--bottom-bar-height)] bg-light-silver border-t border-mild-silver",children:"Bottom Bar"}),mt=()=>t.jsxs(c.Fragment,{children:[t.jsx(Ke,{}),t.jsx(Ve,{}),t.jsx(dt,{}),t.jsx(ut,{})]});export{mt as default};
