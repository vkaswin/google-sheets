import{r as I,j as b}from"./index-ba7c151b.js";const M=({gridRef:m,cells:$,selectedCell:t,getCellById:P,onAutoFillCell:X,getCellIdByCoordiantes:Y})=>{const[g,v]=I.useState(null),[e,y]=I.useState(null),x=I.useRef(null),j=({nativeEvent:{pointerId:n}})=>{x.current&&(x.current.setPointerCapture(n),v(n),y({srcCellId:t.cellId,rect:{width:t.width,height:t.height,translateX:0,translateY:0}}))},E=()=>{if(!e||!e.destCellId||t.cellId===e.destCellId)return;let{translateX:n,translateY:f}=e.rect,l=e.srcCellId.split(",").map(o=>+o),a=e.destCellId.split(",").map(o=>+o),d=[],s=[],r,u,h,i;if(n>=0&&f>=0?(r=l[1],u=a[1],h=l[0],i=a[0]):n<0&&f<0?(h=a[0],i=l[0],r=a[1],u=l[1]):n<0&&f===0?(r=l[1],u=a[1],h=a[0],i=l[0]):n===0&&f<0&&(h=l[0],i=a[0],r=a[1],u=l[1]),typeof h!="number"||typeof i!="number"||typeof r!="number"||typeof u!="number")return;for(let o=h;o<=i;o++)for(let c=r;c<=u;c++){let w=`${o},${c}`;if(w===t.cellId)continue;let D=P(w);D?s.push(D._id):d.push({rowId:c,columnId:o})}if(!s.length&&!d.length)return;let p=P(e.srcCellId);p&&X({updateCells:s,createCells:d,cellId:p._id})},F=()=>{!x.current||!g||(x.current.releasePointerCapture(g),E(),v(null),y(null))},S=n=>{if(!g||!m.current||!e)return;let{left:f,top:l}=m.current.getBoundingClientRect(),a=n.pageX-f,d=n.pageY-l,s=Y(a,d);if(!s)return;let r=$.find(w=>w.cellId===s);if(!r)return;let u=a-t.x,h=d-t.y,i=0,p=0,o=0,c=0;u<0&&(o=-(t.x-r.x)),h<0&&(c=-(t.y-r.y)),s!==t.cellId?(r.x>t.x?i=r.x+r.width-t.x:i=t.x+t.width-r.x,r.y>t.y?p=r.y+r.height-t.y:p=t.y+t.height-r.y):(i=t.width,p=t.height),y({...e,destCellId:s,rect:{width:i,height:p,translateX:o,translateY:c}})};return b.jsxs("div",{className:"absolute z-10",children:[b.jsx("span",{ref:x,className:"absolute -translate-x-[6px] -translate-y-[6px] border border-white bg-dark-blue w-3 h-3 rounded-full cursor-crosshair",style:{left:`calc(${t.x+t.width}px - var(--col-width))`,top:`calc(${t.y+t.height}px - var(--row-height))`},onMouseDown:n=>n.stopPropagation(),onPointerDown:j,onPointerMove:S,onPointerUp:F}),e&&b.jsx("div",{className:"absolute border border-dashed border-black",style:{...e.rect,width:e.rect.width,height:e.rect.height,transform:`translate(${e.rect.translateX}px,${e.rect.translateY}px)`,left:`calc(${t.x}px - var(--col-width))`,top:`calc(${t.y}px - var(--row-height))`}})]})};export{M as default};
