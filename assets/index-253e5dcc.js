import{j as t,r as h,t as de}from"./index-eb456699.js";const oe=()=>t.jsxs("div",{className:"h-[var(--toolbar-height)]",children:[t.jsxs("div",{className:"flex items-center h-[65px]",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{className:"w-[60px] h-[42px]",src:"/logo.png"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-[#575a5a] font-[Poppins-Medium] text-lg",contentEditable:!1,children:"Untitled Spreadsheet"}),t.jsx("i",{className:"icon-star-outline"}),t.jsx("i",{className:"icon-folder-move-outline"}),t.jsx("i",{className:"icon-cloud-check-outline"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{children:"File"}),t.jsx("button",{children:"Edit"})]})]})]}),t.jsx("div",{className:""})]}),t.jsx("div",{className:"",children:"Toolbar"})]}),he=()=>t.jsxs("div",{className:"flex gap-2 px-2 items-center h-[var(--typing-bar-height)]",children:[t.jsx("input",{name:"id",className:"outline-none w-[100px] px-2 bg-transparent text-sm border-2 rounded-sm border-transparent hover:bg-[#ededed] focus:border-[#0b57d0]"}),t.jsx("div",{className:"w-[2px] bg-[#dadce0] h-[50%] border-none"}),t.jsxs("div",{className:"flex items-center w-full",children:[t.jsx("i",{className:"icon-format-text text-[#a8a9a9] font-bold"}),t.jsx("input",{name:"content",className:"w-full border-none outline-none bg-transparent px-2 text-sm"})]})]});let r={width:100,height:25};const ae=({sheetDetail:{meta:{columnIds:S,totalRows:D},cells:U,columns:O,rows:$}})=>{let b=h.useRef(null),R=h.useRef(null),B=h.useRef(null),T=h.useRef([]),v=h.useRef([]),y=h.useRef([]),M=h.useRef(!1),k=h.useRef(!1),[s,G]=h.useState(),[f,I]=h.useState(),[m,P]=h.useState();h.useEffect(()=>{if(K(),!!B.current)return A({rowStart:1,colStart:1}),window.addEventListener("resize",H),()=>{window.addEventListener("resize",H)}},[]);let H=()=>{if(!b.current||!R.current)return;let{clientWidth:e,clientHeight:i}=b.current;R.current.width=e,R.current.height=i;let l=v.current[0].id,n=y.current[0].id;A({rowStart:l,colStart:n})},J=e=>{e.clearRect(0,0,r.width/2,r.height),N(e),e.beginPath(),e.moveTo(0,r.height),e.lineTo(r.width/2,r.height),e.lineTo(r.width/2,1),e.lineTo(0,1),e.fillStyle="#C7C7C7",e.fillRect(0,r.height-5,r.width/2,5),e.fillRect(r.width/2-5,0,5,r.height),e.stroke(),L(e)},K=()=>{if(!b.current||!R.current)return;let{clientWidth:e,clientHeight:i}=b.current,l=R.current,n=l.getContext("2d");n&&(B.current=n,l.width=e,l.height=i)},Q=(e,{x:i,width:l,id:n})=>{N(e),e.beginPath(),e.moveTo(i,1),e.lineTo(i+l,1),e.lineTo(i+l,r.height),e.lineTo(i,r.height),e.fillText(n,i+l/2,r.height/2),e.stroke(),L(e)},V=(e,{x:i,y:l,height:n,id:a})=>{N(e),e.beginPath(),e.moveTo(i,l+n),e.lineTo(r.width/2,l+n),e.fillText(a.toString(),r.width/4,l+n/2),e.stroke(),L(e)},W=e=>{e.fillStyle="#000000",e.font="10px sans-serif",e.textAlign="start",e.textBaseline="alphabetic"},N=e=>{e.strokeStyle="silver",e.fillStyle="#566164",e.font="14px Poppins",e.textAlign="center",e.textBaseline="middle"},L=e=>{e.strokeStyle="#000000",e.fillStyle="#000000",e.font="10px sans-serif",e.textAlign="start",e.textBaseline="alphabetic"},Z=(e,{x:i,y:l,width:n,height:a})=>{N(e),e.beginPath(),e.moveTo(i,l),e.lineTo(i,l+a),e.lineTo(i+n,l+a),e.stroke(),L(e)},q=(e,i,l)=>{let{x:n,y:a,width:d,height:o}=i;if(e.clearRect(n,a+1,d,o),Z(e,i),!l)return;let{text:c,color:j,backgroundColor:p}=l;e.font="14px Poppins",e.textBaseline="middle",p&&(e.beginPath(),e.fillStyle=p||"#000000",e.fillRect(n,a,d,o),e.fill()),c&&(e.beginPath(),e.fillStyle=j||"#000000",e.fillText(c,n+5,a+o-10),e.fill()),W(e)},_=(e,{x:i,y:l})=>{N(e),e.beginPath(),e.moveTo(i,l),e.lineTo(i,e.canvas.height),e.stroke(),W(e),k.current=!0},ee=()=>{if(s){let e=T.current.find(({id:i})=>i===s.id);G(e?{...e,hidden:!1}:{...s,hidden:!0})}if(m){let e=y.current.find(({id:i})=>i===m.id);P(e?{...e,hidden:!1}:{...m,hidden:!0})}if(f){let e=v.current.find(({id:i})=>i===f.id);I(e?{...e,hidden:!1}:{...f,hidden:!0})}},A=({colStart:e,rowStart:i})=>{var c,j;let l=B.current;if(!l)return;let n=l.canvas.width,a=l.canvas.height,d=r.height;T.current=[],v.current=[],y.current=[],l.clearRect(0,0,n,a);let o=!1;k.current=!1;for(let p=i;p<=D&&d<a;p++){let g=((c=$[p])==null?void 0:c.height)||r.height,u=r.width/2,w={x:0,y:d,height:g,id:p,width:r.width/2};V(l,w),v.current.push(w);for(let x=e;x<=S.length&&u<n;x++){let C=S[x-1];if(C==="null"){if(k.current)break;_(l,{x:u,y:r.height});break}let X=`${C}${p}`,E=((j=O[C])==null?void 0:j.width)||r.width,se=U[X],Y={x:u,y:0,width:E,id:x,height:r.height},z={x:u,y:d,width:E,height:g,row:w,column:Y,id:X};o||(Q(l,{x:u,width:E,id:C}),y.current.push(Y)),q(l,z,se),T.current.push(z),u+=E}d+=g,o=!0}J(l),ee(),M.current=v.current.at(-1).id===D};const te=e=>{if(!B.current)return;let{deltaY:l,deltaX:n}=e,a=l===0?"left":"top",d=v.current[0].id,o=y.current[0].id;if(a==="top"){if(l>0&&M.current)return;let c=2;d=Math.max(1,l>0?d+c:d-c)}else{if(n>0&&k.current)return;let c=1;o=Math.max(1,n>0?o+c:o-c)}A({rowStart:d,colStart:o})},le=e=>{e.preventDefault()};let ie=e=>{if(!b.current)return;let{top:i,left:l}=b.current.getBoundingClientRect(),{clientX:n,clientY:a}=e,d=n-l,o=a-i,c,j,p;if(o<=r.height){let g=y.current.find(({x:u,y:w,width:x})=>d>=u&&d<=u+x&&o>=w&&o<=w+r.height);g&&(j={...g,hidden:!1})}else if(d<=r.width/2){let g=v.current.find(({x:u,y:w,height:x})=>d>=u&&d<=u+r.width&&o>=w&&o<=w+x);g&&(p={...g,hidden:!1})}else{let g=T.current.find(({width:u,height:w,x,y:C})=>d>=x&&d<=x+u&&o>=C&&o<=C+w);g&&(c={...g,hidden:!1})}G(c),I(p),P(j)},F=h.useMemo(()=>s?{cell:{width:s.width+"px",height:s.height+"px",top:s.y+"px",left:s.x+"px"},row:{width:s.row.width+"px",height:s.row.height+"px",top:s.row.y+"px",left:s.row.x+"px"},column:{width:s.column.width+"px",height:s.column.height+"px",top:s.column.y+"px",left:s.column.x+"px"}}:{},[s]),re=h.useMemo(()=>f?{left:f.x+"px",top:f.y+"px",height:f.height+"px","--cell-width":f.width+"px"}:{},[f]),ne=h.useMemo(()=>m?{width:m.width+"px",left:m.x+"px",top:m.y+"px","--cell-height":m.height+"px"}:{},[m]);return t.jsxs("div",{ref:b,className:"relative h-[var(--grid-height)] overflow-hidden",onContextMenu:le,onClick:ie,onWheel:de(te,50),children:[s&&!s.hidden&&t.jsxs(h.Fragment,{children:[t.jsx("div",{className:"absolute border-2 border-[#1973e8]",style:F.cell}),t.jsx("div",{className:"absolute flex items-center justify-center bg-[#d3e3fd] text-[#444746] text-sm border-1 border-silver",style:F.row,children:t.jsx("b",{children:s.row.id})}),t.jsx("div",{className:"absolute flex items-center justify-center bg-[#d3e3fd] text-[#444746] text-sm border-1 border-silver",style:F.column,children:t.jsx("b",{children:S[s.column.id-1]})})]}),f&&!f.hidden&&t.jsxs("div",{className:"absolute flex w-full border-t border-b border-[#1973e8]",style:re,children:[t.jsx("div",{className:"flex w-[var(--cell-width)] justify-center items-center bg-[#0b57d0] text-white text-sm",children:t.jsx("b",{children:f.id})}),t.jsx("div",{className:"bg-[#1973e8] opacity-10 w-[calc(100%-var(--cell-width))]"})]}),m&&!m.hidden&&t.jsxs("div",{className:"absolute w-[calc(--cell-width)] h-full border-l border-r border-[#1973e8]",style:ne,children:[t.jsx("div",{className:"flex h-[var(--cell-height)] justify-center items-center bg-[#0b57d0] text-white text-sm",children:t.jsx("b",{children:S[m.id-1]})}),t.jsx("div",{className:"bg-[#1973e8] opacity-10 h-[calc(100%-var(--cell-height))]"})]}),t.jsx("canvas",{ref:R})]})},ce=()=>t.jsx("div",{className:"fixed left-0 bottom-0 w-full h-[var(--bottom-bar-height)] bg-[#f9fbfd] border-t border-[#e8eaed]",children:"Bottom Bar"}),ue={meta:{totalRows:50,dimension:{width:26*100,height:100*25},columnIds:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","null"]},rows:{50:{height:250},1:{height:100},2:{height:35},3:{height:39},4:{height:50},5:{height:128},6:{height:77},7:{height:99},13:{height:100},15:{height:35},33:{height:39},24:{height:50},45:{height:128},66:{height:77},37:{height:99}},columns:{A:{width:150},B:{width:175},C:{width:220},E:{width:270},H:{width:125}},cells:{A1:{text:"Loreum Ispum Loreum Ispum",backgroundColor:"#EA9999",color:"white"},B4:{text:"Loreum Ispum",backgroundColor:"#B7E1CD"},C6:{text:"Loreum Ispum",backgroundColor:"#CADAF8"},E5:{text:"Loreum Ispum",backgroundColor:"#FEE599"},H2:{text:"Loreum Ispum",backgroundColor:"#B3A7D6"},F12:{text:"Loreum Ispum Loreum Ispum",backgroundColor:"#FFF2CC"},D25:{text:"Loreum",backgroundColor:"#B7B7B7"},C9:{text:"Loreum Ispum"},E80:{text:"Loreum Ispum",backgroundColor:"#766CEB",color:"white"}}},me=()=>t.jsxs(h.Fragment,{children:[t.jsx(oe,{}),t.jsx(he,{}),t.jsx(ae,{sheetDetail:ue}),t.jsx(ce,{})]});export{me as default};
