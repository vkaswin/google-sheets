import{j as e,g as re,r as n,c as G,a as le}from"./index-20a7016c.js";let oe=[{label:"File"},{label:"Edit"},{label:"View"},{label:"Insert"},{label:"Format"},{label:"Data"},{label:"Tools"},{label:"Extensions"},{label:"Help"}];const ne=()=>{const h=g=>{console.log(g.target.innerText)};return e.jsxs("div",{className:"bg-light-silver h-[var(--toolbar-height)]",children:[e.jsxs("div",{className:"flex items-center h-[65px]",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{className:"w-[60px] h-[42px]",src:re("/logo.png")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-dark-gray font-medium text-base border border-transparent px-1 outline-none rounded-sm hover:border-gray-500 focus:border-gray-500",contentEditable:!0,onInput:h,dangerouslySetInnerHTML:{__html:"Untitled Spreadsheet"}}),e.jsx("i",{className:"icon-star-outline"}),e.jsx("i",{className:"icon-folder-move-outline"}),e.jsx("i",{className:"icon-cloud-check-outline"})]}),e.jsx("div",{className:"flex gap-1",children:oe.map(({label:g},a)=>e.jsx("button",{className:"px-2 bg-transparent transition-background duration-100 hover:bg-light-gray text-[15px] rounded",children:g},a))})]})]}),e.jsx("div",{className:""})]}),e.jsx("div",{className:"flex items-center h-[45px] px-2 mx-[15px] rounded-full",children:"Toolbar"})]})},se=()=>e.jsxs("div",{className:"flex gap-2 px-2 items-center h-[var(--typing-bar-height)]",children:[e.jsx("input",{name:"id",className:"outline-none w-[100px] px-2 bg-transparent text-sm border-2 rounded-sm border-transparent hover:bg-[#ededed] focus:border-dark-blue"}),e.jsx("div",{className:"w-[2px] bg-[#dadce0] h-[50%] border-none"}),e.jsxs("div",{className:"flex items-center w-full",children:[e.jsx("i",{className:"icon-format-text text-[#a8a9a9] font-bold"}),e.jsx("input",{name:"content",className:"w-full border-none outline-none bg-transparent px-2 text-sm"})]})]}),ie=({cell:h,onDoubleClick:g})=>{let{columnId:a,height:x,cellId:t,rowId:c,width:b,x:w,y:o}=h;return e.jsx("div",{className:"absolute flex text-sm bg-transparent border-2 border-blue",style:{left:w,top:o,width:b,height:x},onDoubleClick:g})},ae=({cell:h,data:g,onWheel:a})=>{const x=n.useRef(null);let{x:t,y:c,rowId:b,height:w,columnId:o,width:f}=h,{color:k="#000000",backgroundColor:C="#FFFFFF",content:j=""}=g??{};n.useEffect(()=>{x.current&&N(x.current)},[h]);const N=s=>{let m=window.getSelection();if(!m)return;let d=document.createRange();d.setStart(s,s.childNodes.length),d.collapse(!0),m.removeAllRanges(),m.addRange(d)};return e.jsxs("div",{className:"absolute flex border-1 outline outline-3 outline-light-blue p-[2px] z-10",style:{width:f,height:w,left:t,top:c,backgroundColor:C,color:k},onWheel:a,children:[e.jsx("div",{ref:x,className:"w-full h-full text-sm outline outline-2 outline-dark-blue p-[2px]",contentEditable:!0,dangerouslySetInnerHTML:{__html:j}}),e.jsxs("div",{className:"absolute -top-7 left-0 bg-blue text-xs font-medium text-white rounded-sm px-2 py-1",children:[G(o),b]})]})};var _={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(h){(function(){var g={}.hasOwnProperty;function a(){for(var x=[],t=0;t<arguments.length;t++){var c=arguments[t];if(c){var b=typeof c;if(b==="string"||b==="number")x.push(c);else if(Array.isArray(c)){if(c.length){var w=a.apply(null,c);w&&x.push(w)}}else if(b==="object"){if(c.toString!==Object.prototype.toString&&!c.toString.toString().includes("[native code]")){x.push(c.toString());continue}for(var o in c)g.call(c,o)&&c[o]&&x.push(o)}}}return x.join(" ")}h.exports?(a.default=a,h.exports=a):window.classNames=a})()})(_);var ce=_.exports;const P=le(ce),de=({columns:h,selectedId:g,onClick:a,onResize:x})=>{const[t,c]=n.useState(null),[b,w]=n.useState(!1),o=n.useRef(null),f=n.useRef(null),k=s=>{!o.current||!t||(f.current=s.pageX,o.current.setPointerCapture(s.pointerId),o.current.addEventListener("pointermove",C),o.current.addEventListener("pointerup",j,{once:!0}),w(!0))},C=s=>{if(!o.current||!f.current||!t)return;let{pageX:m}=s,d=t.width+-(f.current-m);d<50||c({...t,width:d})},j=s=>{if(!o.current||!t||!f.current)return;let{pageX:m}=s;o.current.removeEventListener("pointermove",C);let d=t.width+-(f.current-m);x(t.columnId,Math.max(50,d)),f.current=null,c(null),w(!1)},N=s=>{c({...s})};return e.jsxs(n.Fragment,{children:[e.jsx("div",{className:"absolute left-0 top-0 w-full h-[var(--row-height)] bg-white z-10",children:h.map(s=>{let{x:m,height:d,columnId:I,width:R,y:L}=s;return e.jsxs("div",{className:P("absolute flex justify-center items-center border-t border-r border-b border-gray",{"bg-light-blue font-medium":I===g}),style:{width:R,height:d,left:m,top:L},onClick:()=>a(I),children:[e.jsx("span",{className:P("text-xs",I===g?"text-black font-medium":"text-light-gray"),children:G(I)}),e.jsx("div",{className:"absolute top-0 -right-3 w-6 h-full bg-transparent",onMouseEnter:()=>N(s)})]},I)})}),t&&e.jsxs(n.Fragment,{children:[e.jsxs("div",{ref:o,className:"absolute flex gap-[5px] items-center cursor-col-resize z-30",style:{left:t.x+t.width-6,top:0,height:t.height},onPointerDown:k,children:[e.jsx("div",{className:"bg-black rounded-md w-[3px]",style:{height:t.height-8}}),e.jsx("div",{className:"bg-black rounded-md w-[3px]",style:{height:t.height-8}})]}),b&&e.jsx("div",{className:"absolute w-[3px] h-full bg-slate-400 z-30",style:{left:t.x+t.width-2,top:0}})]})]})},ue=({rows:h,slectedId:g,onClick:a,onResize:x})=>{const[t,c]=n.useState(null),[b,w]=n.useState(!1),o=n.useRef(null),f=n.useRef(null),k=s=>{!o.current||!t||(f.current=s.pageY,o.current.setPointerCapture(s.pointerId),o.current.addEventListener("pointermove",C),o.current.addEventListener("pointerup",j,{once:!0}),w(!0))},C=s=>{if(!o.current||!f.current||!t)return;let{pageY:m}=s,d=t.height+-(f.current-m);d<=25||c({...t,height:d})},j=s=>{if(!o.current||!t||!f.current)return;let{pageY:m}=s;o.current.removeEventListener("pointermove",C);let d=t.height+-(f.current-m);x(t.rowId,Math.max(25,d)),f.current=null,c(null),w(!1)},N=s=>{c({...s})};return e.jsxs(n.Fragment,{children:[e.jsx("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-full bg-white z-10",children:h.map(s=>{let{x:m,height:d,rowId:I,width:R,y:L}=s;return e.jsxs("div",{className:P("absolute flex justify-center items-center border-r border-b border-l border-gray",{"bg-light-blue":I===g}),style:{width:R,height:d,left:m,top:L},onClick:()=>a(I),children:[e.jsx("span",{className:P("text-xs",I===g?"text-black font-medium":"text-light-gray"),children:I}),e.jsx("div",{className:"absolute left-0 -bottom-3 w-full h-6 bg-transparent",onMouseEnter:()=>N(s)})]},I)})}),t&&e.jsxs(n.Fragment,{children:[e.jsxs("div",{ref:o,className:"absolute flex flex-col items-center gap-[5px] cursor-row-resize z-20",style:{left:0,top:t.y+t.height-6,width:t.width},onPointerDown:k,children:[e.jsx("div",{className:"bg-black rounded-md h-[3px]",style:{width:t.width/2}}),e.jsx("div",{className:"bg-black rounded-md h-[3px]",style:{width:t.width/2}})]}),b&&e.jsx("div",{className:"absolute h-[3px] w-full bg-slate-400 z-20",style:{left:0,top:t.y+t.height-2}})]})]})},he=({cells:h,cellDetails:g})=>e.jsx(n.Fragment,{children:h.map(a=>{let{columnId:x,height:t,cellId:c,rowId:b,width:w,x:o,y:f}=a,{color:k="#000000",backgroundColor:C="#FFFFFF",content:j=""}=g[c]??{};return e.jsx("div",{className:"absolute border-r border-b border-gray text-sm p-1",style:{left:o,top:f,width:w,height:t,color:k,backgroundColor:C},dangerouslySetInnerHTML:{__html:j}},c)})}),me={rows:[{height:200,rowId:1},{height:35,rowId:2},{height:39,rowId:3},{height:50,rowId:4},{height:128,rowId:5},{height:77,rowId:6},{height:99,rowId:7},{height:100,rowId:13},{height:35,rowId:15},{height:39,rowId:33},{height:50,rowId:24},{height:128,rowId:45},{height:150,rowId:50},{height:77,rowId:66},{height:99,rowId:37}],columns:[{width:150,columnId:1},{width:175,columnId:2},{width:220,columnId:3},{width:270,columnId:5},{width:125,columnId:9}],cells:[{backgroundColor:"#CADAF8",color:"white",content:"<span>Loreum Ispum</span>",rowId:50,columnId:2},{content:"Loreum Ispum Loreum Ispum",backgroundColor:"#EA9999",color:"white",rowId:1,columnId:1},{backgroundColor:"#B7E1CD",content:"<b>Loreum Ispum</b>",rowId:4,columnId:2},{backgroundColor:"#CADAF8",content:"<span>Loreum Ispum</span>",columnId:3,rowId:6},{content:"Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#FEE599",rowId:5,columnId:5},{content:"Lorem Ipsum Lorem Ipsum is simply dummy text of the printing Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#B3A7D6",rowId:2,columnId:8},{backgroundColor:"#FFF2CC",content:"<b>Loreum Ispum</b>",rowId:12,columnId:6},{backgroundColor:"#B7B7B7",content:"<span>Loreum</span>",rowId:25,columnId:4},{content:"Loreum Ispum",rowId:9,columnId:3},{content:"Loreum Ispum",backgroundColor:"#766CEB",color:"white",rowId:80,columnId:5}]},z=46,D=25,B={width:100,height:25},fe=()=>{const[h,g]=n.useState([]),[a,x]=n.useState([]),[t,c]=n.useState([]),[b,w]=n.useState(""),[o,f]=n.useState(null),[k,C]=n.useState(0),{current:j}=n.useRef({}),{current:N}=n.useRef({}),{current:s}=n.useRef({}),m=n.useRef(null),d=n.useMemo(()=>t.find(({cellId:r})=>r===b),[h,a,b]);n.useEffect(()=>{let{rows:r,cells:i,columns:u}=me;for(let l of r)j[l.rowId]=l;for(let l of u)N[l.columnId]=l;for(let l of i){let p=`${l.columnId},${l.rowId}`;s[p]=l}},[]),n.useEffect(()=>{console.log(k),I()},[k]),n.useEffect(()=>(window.addEventListener("resize",I),()=>{window.removeEventListener("resize",I)}),[h,a]);const I=()=>{if(!m.current)return;let{rowId:r=1,y:i=D}=h[0]??{},{columnId:u=1,x:l=z}=a[0]??{};R({offsetX:l,offsetY:i,rowStart:r,colStart:u})},R=({offsetX:r,offsetY:i,rowStart:u,colStart:l})=>{var H,X;if(!m.current)return;let{clientWidth:p,clientHeight:y}=m.current,v=[],M=[],T=[];for(let E=u,S=i;S<y;E++){let F=((H=j[E])==null?void 0:H.height)||B.height;S+F>D&&v.push({y:S,x:0,rowId:E,height:F,width:z}),S+=F}for(let E=l,S=r;S<p;E++){let F=((X=N[E])==null?void 0:X.width)||B.width;S+F>z&&M.push({x:S,y:0,columnId:E,width:F,height:D}),S+=F}for(let{rowId:E,height:S,y:F}of v)for(let{width:Z,x:ee,columnId:Y}of M){let te=`${Y},${E}`;T.push({x:ee,y:F,rowId:E,columnId:Y,width:Z,height:S,cellId:te})}g(v),x(M),c(T)},L=r=>{if(!m.current)return;let i=r.pageX,u=r.pageY-m.current.getBoundingClientRect().top,l=$(i,u);l&&(w(l),f(null))},$=(r,i)=>{let u=0,l=h.length-1,p=null;for(;u<=l;){let v=Math.floor((u+l)/2);h[v].y<=i?(u=v+1,p=h[v].rowId):l=v-1}if(!p)return null;u=0,l=a.length-1;let y=null;for(;u<=l;){let v=Math.floor((u+l)/2);a[v].x<=r?(u=v+1,y=a[v].columnId):l=v-1}return y?`${y},${p}`:null},U=r=>{var y;if(!h.length||!a.length)return;let{rowId:i,y:u}=h[0],{columnId:l,x:p}=a[0];if(r<0){for(u+=-r,i--;i>0&&u>D;)u-=((y=j[i])==null?void 0:y.height)??B.height,i--;R({offsetX:p,offsetY:Math.min(D,u),rowStart:i+1,colStart:l})}else R({offsetX:p,offsetY:u+-r,rowStart:i,colStart:l})},W=r=>{var y;if(!h.length||!a.length)return;let{rowId:i,y:u}=h[0],{columnId:l,x:p}=a[0];if(r<0){for(p+=-r,l--;l>0&&p>z;)p-=((y=N[l])==null?void 0:y.width)??B.width,l--;R({offsetX:Math.min(z,p),offsetY:u,rowStart:i,colStart:l+1})}else R({offsetX:p+-r,offsetY:u,rowStart:i,colStart:l})},A=r=>{let{deltaX:i,deltaY:u}=r;i===0?U(u):W(i)},O=()=>{if(!m.current||!d)return;let{columnId:r,cellId:i,width:u,height:l,rowId:p,x:y,y:v}=d,{top:M}=m.current.getBoundingClientRect();f({cellId:i,columnId:r,width:u,height:l,rowId:p,x:Math.max(z,y),y:Math.max(D+M,v+M)})},V=r=>{r.preventDefault(),L(r)},q=r=>{console.log(r)},J=r=>{console.log(r)},K=(r,i)=>{N[r]?N[r].width=i:N[r]={columnId:r,width:i},C(Math.random())},Q=(r,i)=>{j[r]?j[r].height=i:j[r]={rowId:r,height:i},C(Math.random())};return e.jsxs(n.Fragment,{children:[e.jsxs("div",{ref:m,className:"relative h-[var(--grid-height)] select-none overflow-hidden",onClick:L,onContextMenu:V,onWheel:A,children:[e.jsx("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-[var(--row-height)] border border-light-gray bg-white z-20 after:absolute after:right-0 after:h-full after:w-1 after:bg-dark-silver before:absolute before:bottom-0 before:w-full before:h-1 before:bg-dark-silver"}),e.jsx(de,{columns:a,selectedId:d==null?void 0:d.columnId,onClick:q,onResize:K}),e.jsx(ue,{rows:h,slectedId:d==null?void 0:d.rowId,onClick:J,onResize:Q}),e.jsx(he,{cells:t,cellDetails:s}),!o&&d&&e.jsx(ie,{cell:d,onDoubleClick:O})]}),o&&e.jsx(ae,{cell:o,data:s[o.cellId],onWheel:A})]})},ge=()=>e.jsx("div",{className:"fixed left-0 bottom-0 w-full h-[var(--bottom-bar-height)] bg-light-silver border-t border-mild-silver",children:"Bottom Bar"}),pe=()=>e.jsxs(n.Fragment,{children:[e.jsx(ne,{}),e.jsx(se,{}),e.jsx(fe,{}),e.jsx(ge,{})]});export{pe as default};
