import{j as t,g as be,r as i,c as _,a as we,d as xe}from"./index-9a1289ee.js";let Ie=[{label:"File"},{label:"Edit"},{label:"View"},{label:"Insert"},{label:"Format"},{label:"Data"},{label:"Tools"},{label:"Extensions"},{label:"Help"}];const ve=()=>{const d=w=>{console.log(w.target.innerText)};return t.jsxs("div",{className:"bg-light-silver h-[var(--toolbar-height)]",children:[t.jsxs("div",{className:"flex items-center h-[65px]",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{className:"w-[60px] h-[42px]",src:be("/logo.png")}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-dark-gray font-medium text-base border border-transparent px-1 outline-none rounded-sm hover:border-gray-500 focus:border-gray-500",contentEditable:!0,onInput:d,dangerouslySetInnerHTML:{__html:"Untitled Spreadsheet"}}),t.jsx("i",{className:"icon-star-outline"}),t.jsx("i",{className:"icon-folder-move-outline"}),t.jsx("i",{className:"icon-cloud-check-outline"})]}),t.jsx("div",{className:"flex gap-1",children:Ie.map(({label:w},c)=>t.jsx("button",{className:"px-2 bg-transparent transition-background duration-100 hover:bg-light-gray text-[15px] rounded",children:w},c))})]})]}),t.jsx("div",{className:""})]}),t.jsx("div",{className:"flex items-center h-[45px] px-2 mx-[15px] rounded-full",children:"Toolbar"})]})},je=()=>t.jsxs("div",{className:"flex gap-2 px-2 items-center h-[var(--typing-bar-height)]",children:[t.jsx("input",{name:"id",className:"outline-none w-[100px] px-2 bg-transparent text-sm border-2 rounded-sm border-transparent hover:bg-[#ededed] focus:border-dark-blue"}),t.jsx("div",{className:"w-[2px] bg-[#dadce0] h-[50%] border-none"}),t.jsxs("div",{className:"flex items-center w-full",children:[t.jsx("i",{className:"icon-format-text text-[#a8a9a9] font-bold"}),t.jsx("input",{name:"content",className:"w-full border-none outline-none bg-transparent px-2 text-sm"})]})]}),ye=({selectedCell:d,onDoubleClick:w})=>{let{columnId:c,height:l,cellId:f,rowId:a,width:y,x:p,y:x}=d;return t.jsxs(i.Fragment,{children:[t.jsx("div",{className:"absolute flex text-sm bg-transparent border-2 border-blue p-1 z-10",style:{left:p,top:x,width:y,height:l},onDoubleClick:w}),t.jsx("div",{className:"absolute flex justify-center items-center top-0 h-[var(--row-height)] bg-light-blue border border-light-gray",style:{left:p,width:y},children:t.jsx("span",{className:"absolute text-xs font-medium",children:_(c)})}),t.jsx("div",{className:"absolute flex justify-center items-center left-0 w-[var(--col-width)] bg-light-blue border border-light-gray",style:{top:x,height:l},children:t.jsx("span",{className:"absolute text-xs font-medium",children:a})})]})},Ce=({cell:d,data:w,onWheel:c})=>{const l=i.useRef(null);let{x:f,y:a,rowId:y,height:p,columnId:x,width:v}=d,{color:N="#000000",backgroundColor:F="#FFFFFF",html:k=""}=w??{};i.useEffect(()=>{l.current&&g(l.current)},[d]);const g=L=>{let S=window.getSelection();if(!S)return;let b=document.createRange();b.setStart(L,L.childNodes.length),b.collapse(!0),S.removeAllRanges(),S.addRange(b)};return t.jsxs("div",{className:"absolute flex border-1 outline outline-3 outline-light-blue p-[2px] z-10",style:{width:v,height:p,left:f,top:a,backgroundColor:F,color:N},onWheel:c,children:[t.jsx("div",{ref:l,className:"w-full h-full text-sm outline outline-2 outline-dark-blue p-[2px]",contentEditable:!0,dangerouslySetInnerHTML:{__html:k}}),t.jsxs("div",{className:"absolute -top-7 left-0 bg-blue text-xs font-medium text-white rounded-sm px-2 py-1",children:[_(x),y]})]})},Ne=({columns:d,onClick:w,onResize:c})=>{const[l,f]=i.useState(null),[a,y]=i.useState(!1),[p,x]=i.useState(!1),v=i.useRef(null),N=i.useRef(null),F=h=>{!v.current||!l||(N.current=h.pageX,v.current.setPointerCapture(h.pointerId),v.current.addEventListener("pointermove",k),v.current.addEventListener("pointerup",g,{once:!0}),y(!0))},k=h=>{if(!v.current||!N.current||!l)return;let{pageX:m}=h,I=l.width+-(N.current-m);I<50||f({...l,width:I})},g=h=>{if(!v.current||!l||!N.current)return;let{pageX:m}=h;v.current.removeEventListener("pointermove",k);let I=l.width+-(N.current-m);c(l.columnId,Math.max(50,I)),N.current=null,f(null),y(!1)},L=()=>{x(!p)},S=h=>{let m=0,I=d.length-1,B=null;for(;m<=I;){let P=Math.floor((m+I)/2);d[P].x<=h?(m=P+1,B=P):I=P-1}return B===null?null:d[B]},b=h=>{if(a)return;let m=S(h.pageX);!m||(l==null?void 0:l.columnId)===m.columnId||f({...m})},j=()=>{f(null)};return t.jsxs(i.Fragment,{children:[t.jsx("div",{className:"absolute left-0 top-0 w-full h-[var(--row-height)] z-10",onMouseMove:b,onMouseLeave:j,children:l&&t.jsxs("div",{className:"absolute",style:{width:l.width,height:l.height,left:l.x,top:l.y},onClick:()=>w(l.columnId),children:[t.jsx("div",{className:"absolute top-0 -right-3 w-6 h-full bg-transparent",onMouseEnter:L}),t.jsxs("div",{ref:v,className:"absolute top-0 -right-[5px] flex gap-[5px] items-center h-full cursor-col-resize",onPointerDown:F,children:[t.jsx("div",{className:"bg-black rounded-md w-[3px] h-2/3"}),t.jsx("div",{className:"bg-black rounded-md w-[3px] h-2/3"})]})]})}),l&&a&&t.jsx("div",{className:"absolute w-[3px] h-full bg-slate-400 z-10",style:{left:l.x+l.width-2,top:0}})]})},Se=({rows:d,onClick:w,onResize:c})=>{const[l,f]=i.useState(null),[a,y]=i.useState(!1),p=i.useRef(null),x=i.useRef(null),v=i.useRef(null),N=b=>{!p.current||!l||(x.current=b.pageY,p.current.setPointerCapture(b.pointerId),p.current.addEventListener("pointermove",F),p.current.addEventListener("pointerup",k,{once:!0}),y(!0))},F=b=>{if(!p.current||!x.current||!l)return;let{pageY:j}=b,h=l.height+-(x.current-j);h<=25||f({...l,height:h})},k=b=>{if(!p.current||!l||!x.current)return;let{pageY:j}=b;p.current.removeEventListener("pointermove",F);let h=l.height+-(x.current-j);c(l.rowId,Math.max(25,h)),x.current=null,f(null),y(!1)},g=b=>{let j=0,h=d.length-1,m=null;for(;j<=h;){let I=Math.floor((j+h)/2);d[I].y<=b?(j=I+1,m=I):h=I-1}return m===null?null:d[m]},L=b=>{if(!v.current||a)return;let{top:j}=v.current.getBoundingClientRect(),h=g(b.pageY-j);!h||(l==null?void 0:l.rowId)===h.rowId||f({...h})},S=()=>{f(null)};return t.jsxs(i.Fragment,{children:[t.jsx("div",{ref:v,className:"absolute left-0 top-0 w-[var(--col-width)] h-full z-10",onMouseMove:L,onMouseLeave:S,children:l&&t.jsx("div",{className:"absolute",style:{width:l.width,height:l.height,left:l.x,top:l.y},onClick:()=>w(l.rowId),children:t.jsxs("div",{ref:p,className:"absolute left-0 -bottom-[5px] flex flex-col items-center gap-[5px] w-full cursor-row-resize",onPointerDown:N,children:[t.jsx("div",{className:"bg-black rounded-md h-[3px] w-3/5"}),t.jsx("div",{className:"bg-black rounded-md h-[3px] w-3/5"})]})})}),l&&a&&t.jsx("div",{className:"absolute h-[3px] w-full bg-slate-400 z-10",style:{left:0,top:l.y+l.height-2}})]})};var J={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(d){(function(){var w={}.hasOwnProperty;function c(){for(var l=[],f=0;f<arguments.length;f++){var a=arguments[f];if(a){var y=typeof a;if(y==="string"||y==="number")l.push(a);else if(Array.isArray(a)){if(a.length){var p=c.apply(null,a);p&&l.push(p)}}else if(y==="object"){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){l.push(a.toString());continue}for(var x in a)w.call(a,x)&&a[x]&&l.push(x)}}}return l.join(" ")}d.exports?(c.default=c,d.exports=c):window.classNames=c})()})(J);var Re=J.exports;const ke=we(Re),Fe=({cells:d})=>{let[w,c]=i.useState(!0),[l,f]=i.useState(0);const[a,y]=i.useState([]);let p=i.useMemo(()=>new Set(a),[a]);i.useEffect(()=>(window.addEventListener("keydown",x),()=>{window.removeEventListener("keydown",x)}),[]);const x=g=>{let{ctrlKey:L,key:S}=g;L&&S==="f"&&!w&&(g.preventDefault(),N())},v=g=>{console.log(g.target.value),y(["1,1","2,5","4,5","5,1","2,2"])},N=()=>{c(!w)},F=()=>{f(g=>(g++,g===a.length?0:g))},k=()=>{f(g=>(g--,g<0?a.length-1:g))};return w?t.jsxs(i.Fragment,{children:[t.jsxs("div",{className:"fixed flex items-center gap-2 top-6 right-6 border border-mild-gray rounded-md w-72 px-4 py-5",children:[t.jsx("input",{placeholder:"Find in sheet",className:"w-44 h-9 outline-dark-blue border border-mild-gray text-sm rounded px-2 py-2",onChange:xe(v,500)}),t.jsx("button",{className:"text-gray-400 text-xl disabled:opacity-50 disabled:cursor-not-allowed",disabled:!a.length,children:t.jsx("i",{className:"bx-chevron-up",onClick:k})}),t.jsx("button",{className:"text-gray-400 text-xl disabled:opacity-50 disabled:cursor-not-allowed",disabled:!a.length,children:t.jsx("i",{className:"bx-chevron-down ",onClick:F})}),t.jsx("button",{className:"text-xl text-dark-gray",children:t.jsx("i",{className:"bx-x",onClick:N})})]}),d.map(({cellId:g,columnId:L,height:S,rowId:b,width:j,x:h,y:m})=>p.has(g)?t.jsx("div",{className:ke("absolute",g===a[l]?"bg-[rgba(55,190,95,.702)] shadow-[0_0_0_2px_#146c2e] border border-white":"bg-[rgba(109,213,140,.4)]"),style:{width:j,height:S,left:h,top:m}},g):null)]}):null},Le={rows:[{height:200,rowId:1},{height:35,rowId:2},{height:39,rowId:3},{height:50,rowId:4},{height:128,rowId:5},{height:77,rowId:6},{height:99,rowId:7},{height:100,rowId:13},{height:35,rowId:15},{height:39,rowId:33},{height:50,rowId:24},{height:128,rowId:45},{height:150,rowId:50},{height:77,rowId:66},{height:99,rowId:37}],columns:[{width:350,columnId:1},{width:175,columnId:2},{width:220,columnId:3},{width:270,columnId:5},{width:125,columnId:9}],cells:[{rowId:1,columnId:5,html:"Loreum Ispum"},{rowId:2,columnId:2,html:"Loreum Ispum"},{backgroundColor:"#CADAF8",color:"white",html:"<span>Loreum Ispum</span><br><span style='font-size:20px; font-color: red'>Loreum Ispum</span>",rowId:50,columnId:2},{backgroundColor:"#EA9999",color:"white",rowId:1,columnId:1,html:"<span>Loreum Ispum</span><br><span style='font-size:20px; font-color: red'>Loreum Ispum</span>"},{backgroundColor:"#B7E1CD",html:"<b>Loreum Ispum</b>",rowId:4,columnId:2},{backgroundColor:"#CADAF8",html:"<span>Loreum Ispum</span>",columnId:3,rowId:6},{html:"Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#FEE599",rowId:5,columnId:5},{html:"Lorem Ipsum Lorem Ipsum is simply dummy text of the printing Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#B3A7D6",rowId:2,columnId:8},{backgroundColor:"#FFF2CC",html:"<b>Loreum Ispum</b>",rowId:12,columnId:6},{backgroundColor:"#B7B7B7",html:"<span>Loreum</span>",rowId:25,columnId:4},{html:"Loreum Ispum",rowId:9,columnId:3},{html:"Loreum Ispum",backgroundColor:"#766CEB",color:"white",rowId:80,columnId:5}]},De=({selectedColumn:d})=>{let{columnId:w,height:c,width:l,x:f,y:a}=d;return t.jsxs(i.Fragment,{children:[t.jsx("div",{className:"absolute flex justify-center items-center bg-dark-blue",style:{width:l,height:c,left:f,top:a},children:t.jsx("span",{className:"text-white text-xs",children:_(w)})}),t.jsx("div",{className:"absolute top-[var(--col-height)] left-0 w-[var(--col-width)] border-dark-blue border-r border-l bg-light-sky-blue h-full",style:{width:l,left:f,top:a}})]})},Me=({selectedRow:d})=>{let{rowId:w,height:c,width:l,x:f,y:a}=d;return t.jsxs(i.Fragment,{children:[t.jsx("div",{className:"absolute flex justify-center items-center bg-dark-blue",style:{width:l,height:c,left:f,top:a},children:t.jsx("span",{className:"text-white text-xs",children:w})}),t.jsx("div",{className:"absolute top-[var(--col-height)] left-0 w-full border-dark-blue border-t border-b bg-light-sky-blue",style:{height:c,left:f,top:a}})]})},z=46,T=25,O={width:100,height:25},Ee=()=>{const[d,w]=i.useState([]),[c,l]=i.useState([]),[f,a]=i.useState([]),[y,p]=i.useState(""),[x,v]=i.useState(1/0),[N,F]=i.useState(1/0),[k,g]=i.useState(null),[L,S]=i.useState(0),{current:b}=i.useRef({}),{current:j}=i.useRef({}),{current:h}=i.useRef({}),m=i.useRef(null),I=i.useRef(null),B=i.useMemo(()=>f.find(({cellId:e})=>e===y),[d,c,y]),P=i.useMemo(()=>d.find(({rowId:e})=>e===N),[d,N]),G=i.useMemo(()=>c.find(({columnId:e})=>e===x),[c,x]);i.useEffect(()=>{if(!m.current||!I.current)return;let e=I.current,{clientWidth:n,clientHeight:s}=m.current;e.width=n,e.height=s,Q()},[]);const Q=()=>{let{rows:e,cells:n,columns:s}=Le;for(let r of e)b[r.rowId]=r;for(let r of s)j[r.columnId]=r;for(let r of n){let o=`${r.columnId},${r.rowId}`;h[o]=r}};i.useEffect(()=>{$()},[L]),i.useEffect(()=>(window.addEventListener("resize",$),()=>{window.removeEventListener("resize",$)}),[d,c]);const $=()=>{if(!m.current||!I.current)return;let{clientWidth:e,clientHeight:n}=m.current,s=I.current;s.width=e,s.height=n;let{rowId:r=1,y:o=T}=d[0]??{},{columnId:u=1,x:C=z}=c[0]??{};W({offsetX:C,offsetY:o,rowStart:r,colStart:u})},Z=(e,{height:n,rowId:s,width:r,x:o,y:u})=>{e.clearRect(o,u,r,n),U(e,"#FFFFFF",{height:n,width:r,x:o,y:u}),e.save(),e.beginPath(),e.moveTo(o+r,u),e.lineTo(o+r,u+n),e.lineTo(o,u+n),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.textAlign="center",e.textBaseline="middle",e.font="12px Open-Sans",e.fillStyle="#575a5a",e.fillText(s.toString(),o+r/2+1,u+n/2+1),e.restore()},ee=(e,{columnId:n,height:s,width:r,x:o,y:u})=>{e.clearRect(o,u,r,s),U(e,"#FFFFFF",{height:s,width:r,x:o,y:u}),e.save(),e.beginPath(),e.moveTo(o,u),e.lineTo(o+r,u),e.lineTo(o+r,u+s),e.lineTo(o,u+s),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.textAlign="center",e.textBaseline="middle",e.font="12px Open-Sans",e.fillStyle="#575a5a",e.fillText(_(n),o+r/2+1,u+s/2+1),e.restore()},U=(e,n,{x:s,y:r,height:o,width:u})=>{e.save(),e.fillStyle=n,e.beginPath(),e.moveTo(s,r),e.fillRect(s,r,u,o),e.fill(),e.restore()},te=(e,{height:n,width:s,x:r,y:o})=>{e.save(),e.beginPath(),e.moveTo(r,o+n),e.lineTo(r+s,o+n),e.lineTo(r+s,o),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.restore()},le=(e,n,{height:s,width:r,x:o,y:u})=>{e.font="14px Open-Sans",e.beginPath(),e.fillText(n,o,u+14)},re=(e,{cellId:n,rowId:s,columnId:r,height:o,width:u,x:C,y:M})=>{let{backgroundColor:A="#FFFFFF",color:X="#000000",html:Y=""}=h[n]??{},H={x:C,y:M,width:u,height:o};e.clearRect(C,M,u,o),U(e,A,H),le(e,Y,H),te(e,H)},ne=e=>{e.save(),e.clearRect(0,0,z,T),e.fillStyle="#FFFFFF",e.fillRect(0,0,z,T),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.strokeRect(0,0,z,T),e.stroke(),e.restore()},W=({offsetX:e,offsetY:n,rowStart:s,colStart:r})=>{var Y,H;if(!m.current||!I.current)return;let o=I.current.getContext("2d"),{clientWidth:u,clientHeight:C}=m.current,M=[],A=[],X=[];for(let R=s,D=n;D<C;R++){let E=((Y=b[R])==null?void 0:Y.height)||O.height;D+E>T&&M.push({y:D,x:0,rowId:R,height:E,width:z}),D+=E}for(let R=r,D=e;D<u;R++){let E=((H=j[R])==null?void 0:H.width)||O.width;D+E>z&&A.push({x:D,y:0,columnId:R,width:E,height:T}),D+=E}for(let{rowId:R,height:D,y:E}of M)for(let{width:fe,x:ge,columnId:q}of A){let pe=`${q},${R}`;X.push({x:ge,y:E,rowId:R,columnId:q,width:fe,height:D,cellId:pe}),re(o,X.at(-1))}for(let R of M)Z(o,R);for(let R of A)ee(o,R);ne(o),w(M),l(A),a(X)},K=e=>{if(!m.current)return;let n=e.pageX,s=e.pageY-m.current.getBoundingClientRect().top,r=oe(n,s);r&&(p(r),g(null),v(1/0),F(1/0))},oe=(e,n)=>{let s=0,r=d.length-1,o=null;for(;s<=r;){let C=Math.floor((s+r)/2);d[C].y<=n?(s=C+1,o=d[C].rowId):r=C-1}if(!o)return null;s=0,r=c.length-1;let u=null;for(;s<=r;){let C=Math.floor((s+r)/2);c[C].x<=e?(s=C+1,u=c[C].columnId):r=C-1}return u?`${u},${o}`:null},se=e=>{var u;if(!d.length||!c.length)return;let{rowId:n,y:s}=d[0],{columnId:r,x:o}=c[0];if(e<0){for(s+=-e,n--;n>0&&s>T;)s-=((u=b[n])==null?void 0:u.height)??O.height,n--;W({offsetX:o,offsetY:Math.min(T,s),rowStart:n+1,colStart:r})}else W({offsetX:o,offsetY:s+-e,rowStart:n,colStart:r})},ie=e=>{var u;if(!d.length||!c.length)return;let{rowId:n,y:s}=d[0],{columnId:r,x:o}=c[0];if(e<0){for(o+=-e,r--;r>0&&o>z;)o-=((u=j[r])==null?void 0:u.width)??O.width,r--;W({offsetX:Math.min(z,o),offsetY:s,rowStart:n,colStart:r+1})}else W({offsetX:o+-e,offsetY:s,rowStart:n,colStart:r})},V=e=>{let{deltaX:n,deltaY:s}=e;n===0?se(s):ie(n)},ae=()=>{if(!m.current||!B)return;let{columnId:e,cellId:n,width:s,height:r,rowId:o,x:u,y:C}=B,{top:M}=m.current.getBoundingClientRect();g({cellId:n,columnId:e,width:s,height:r,rowId:o,x:Math.max(z,u),y:Math.max(T+M,C+M)})},de=e=>{e.preventDefault(),K(e)},ue=e=>{v(e),F(1/0),p(""),g(null)},ce=e=>{F(e),v(1/0),p(""),g(null)},he=(e,n)=>{j[e]?j[e].width=n:j[e]={columnId:e,width:n},S(Math.random())},me=(e,n)=>{b[e]?b[e].height=n:b[e]={rowId:e,height:n},S(Math.random())};return t.jsxs(i.Fragment,{children:[t.jsxs("div",{ref:m,className:"relative h-[var(--grid-height)] select-none overflow-hidden",onClick:K,onContextMenu:de,onWheel:V,children:[t.jsx("canvas",{ref:I,className:"relative"}),t.jsx("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-[var(--row-height)] border-b-4 border-r-4 border-t border-l border-light-gray bg-white z-20"}),t.jsx(Ne,{columns:c,onClick:ue,onResize:he}),t.jsx(Se,{rows:d,onClick:ce,onResize:me}),!k&&B&&t.jsx(ye,{selectedCell:B,onDoubleClick:ae}),G&&t.jsx(De,{selectedColumn:G}),P&&t.jsx(Me,{selectedRow:P}),t.jsx(Fe,{cells:f})]}),k&&t.jsx(Ce,{cell:k,data:h[k.cellId],onWheel:V})]})},ze=()=>t.jsx("div",{className:"fixed left-0 bottom-0 w-full h-[var(--bottom-bar-height)] bg-light-silver border-t border-mild-silver",children:"Bottom Bar"}),Be=()=>t.jsxs(i.Fragment,{children:[t.jsx(ve,{}),t.jsx(je,{}),t.jsx(Ee,{}),t.jsx(ze,{})]});export{Be as default};
