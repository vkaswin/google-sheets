import{m as U,n as y,j as e,r as o,P as C,i as D}from"./index-ba7c151b.js";import{c as h}from"./index-4b965531.js";import{u as G}from"./useSheet-c9dae6c7.js";import{T as c,P as v,a as S,b as w,C as F}from"./ColorPicker-923aeced.js";import{M as H,a as V,b as Y,c as $}from"./chunk-Z3VR2BFQ-0b86005e.js";import"./index-1d071ac4.js";import"./Sheet-62734aa1.js";import"./popper-f3391c26.js";var u=U("div");u.displayName="Box";var I=y(function(n,t){const{size:d,centerContent:r=!0,...i}=n,b=r?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return e.jsx(u,{ref:t,boxSize:d,__css:{...b,flexShrink:0,flexGrow:0},...i})});I.displayName="Square";var J=y(function(n,t){const{size:d,...r}=n;return e.jsx(I,{size:d,ref:t,borderRadius:"9999px",...r})});J.displayName="Circle";const p="bg-light-blue rounded",m="flex justify-center items-center w-[24px] h-[24px]",f={bold:!1,strike:!1,italic:!1,font:"open-sans",underline:!1,background:"#ffffff",color:"#000000"},le=()=>{const[l,n]=o.useState(f),{quill:t,config:d,editCell:r,selectedCell:i,activeHighLightIndex:b,highLightCells:j,getCellById:T,handleSearchSheet:z,handleFormatCell:P,handleSearchNext:B,handleSearchPrevious:E}=G();let{background:q}=T(i==null?void 0:i.cellId)||{};o.useEffect(()=>{if(t)return t.on("selection-change",N),()=>{t.off("selection-change",N)}},[t]),o.useEffect(()=>{i&&n({...f,background:q||f.background})},[i]);const N=()=>{if(!t)return;let{bold:s,strike:a,font:k,underline:R,color:_,italic:A}=t.getFormat();n({bold:!!s,strike:!!a,underline:!!R,italic:!!A,font:k||f.font,color:_||f.color})},x=(s,a)=>{t&&(s==="background"||s==="align"?(P(s,a),n({...l,[s]:a})):(t.format(s,a),(s==="bold"||s==="italic"||s==="strike"||s==="underline")&&n({...l,[s]:a})))},L=()=>{if(!t)return;let s=t.getSelection();s&&(t.removeFormat(s.index,s.length),N())},M=D(s=>z(s.target.value),500),g=()=>e.jsx("div",{className:"border border-r-[#c7c7c7] h-2/3"});return e.jsx(o.Fragment,{children:e.jsxs("div",{className:"flex items-center h-[calc(var(--toolbar-height)-10px)] bg-mild-blue rounded-full mx-4 mb-[10px]",children:[e.jsx("div",{children:e.jsx(H,{placement:"bottom-start",children:({isOpen:s})=>e.jsxs(o.Fragment,{children:[e.jsx(c,{label:"Font",placement:"bottom",className:"tooltip",children:e.jsx(V,{className:"w-40",disabled:!r,children:e.jsxs("div",{className:"flex justify-between items-center gap-4 pl-4 pr-2",children:[e.jsx("span",{children:d.fonts[l.font]}),e.jsx("i",{className:h("bx-chevron-down transition-transform",s?"rotate-180":"rotate-0")})]})})}),e.jsx(C,{children:e.jsx(Y,{className:"relative bg-white max-h-60 w-40 overflow-y-scroll",zIndex:999,children:d.customFonts.map((a,k)=>e.jsx($,{className:`ql-font-${a} py-1 px-4`,onClick:()=>x("font",a),children:d.fonts[a]},k))})})]})})}),e.jsx(g,{}),e.jsxs("div",{className:"flex items-center gap-3 px-4 text-xl",children:[e.jsx(c,{className:"tooltip",label:"Bold (Ctrl+B)",children:e.jsx("button",{className:h(m,{[p]:l.bold}),disabled:!r,onClick:()=>x("bold",!l.bold),children:e.jsx("i",{className:"bx-bold"})})}),e.jsx(c,{className:"tooltip",label:"Italic (Ctrl+I)",children:e.jsx("button",{className:h(m,{[p]:l.italic}),disabled:!r,onClick:()=>x("italic",!l.italic),children:e.jsx("i",{className:"bx-italic"})})}),e.jsx(c,{className:"tooltip",label:"Underline (Ctrl+U)",children:e.jsx("button",{className:h(m,{[p]:l.underline}),disabled:!r,onClick:()=>x("underline",!l.underline),children:e.jsx("i",{className:"bx-underline"})})}),e.jsx(c,{className:"tooltip",label:"Strikethrough (Ctrl+S)",children:e.jsx("button",{className:h(m,{[p]:l.strike}),disabled:!r,onClick:()=>x("strike",!l.strike),children:e.jsx("i",{className:"bx-strikethrough"})})})]}),e.jsx(g,{}),e.jsxs("div",{className:"flex items-center gap-3 px-4 text-xl",children:[e.jsx(v,{children:({onClose:s})=>e.jsxs(o.Fragment,{children:[e.jsx(c,{className:"tooltip",label:"Text color",children:e.jsx(u,{children:e.jsx(S,{children:e.jsxs("button",{className:h(m,"flex-col"),disabled:!r,children:[e.jsx("i",{className:"bx-font"}),e.jsx("span",{className:"w-full h-2 shadow-sm",style:{backgroundColor:l.color}})]})})})}),e.jsx(C,{children:e.jsx(u,{zIndex:999,className:"relative w-full h-full",children:e.jsx(w,{boxSize:"fit-content",children:e.jsx(F,{onClick:a=>{x("color",a),s()}})})})})]})}),e.jsx(v,{children:({onClose:s})=>e.jsxs(o.Fragment,{children:[e.jsx(c,{className:"tooltip",label:"Fill color",children:e.jsx(u,{children:e.jsx(S,{children:e.jsxs("button",{className:h(m,"flex-col"),disabled:!i,children:[e.jsx("i",{className:"bxs-color-fill"}),e.jsx("span",{className:"w-full h-2 shadow-sm",style:{backgroundColor:l.background}})]})})})}),e.jsx(C,{children:e.jsx(u,{zIndex:999,className:"relative w-full h-full",children:e.jsx(w,{boxSize:"fit-content",children:e.jsx(F,{onClick:a=>{x("background",a),s()}})})})})]})})]}),e.jsx(g,{}),e.jsx("div",{className:"flex items-center gap-3 px-4 text-xl",children:e.jsx(c,{className:"tooltip",label:"Remove format",children:e.jsx("button",{className:m,onClick:L,disabled:!r,children:e.jsx("i",{className:"bxs-eraser"})})})}),e.jsx(g,{}),e.jsxs("div",{className:"flex items-center gap-3 px-4",children:[e.jsxs("div",{className:"relative w-56 h-7",children:[e.jsx("input",{placeholder:"Find in sheet",className:"w-full h-full text-sm focus:outline-2 focus:outline-dark-blue pl-3 pr-8 rounded",onChange:M}),e.jsx("i",{className:"absolute right-2 top-1/2 -translate-y-1/2 bx-search text-gray-500 text-lg"})]}),!!j.length&&b!==null&&e.jsxs(o.Fragment,{children:[e.jsx("button",{disabled:!j.length,children:e.jsx("i",{className:"bx-chevron-up text-xl text-gray-500",onClick:E})}),e.jsx("button",{disabled:!j.length,children:e.jsx("i",{className:"bx-chevron-down text-xl text-gray-500",onClick:B})}),e.jsxs("span",{className:"text-xs text-light-gray",children:[b+1," of ",j.length]})]})]})]})})};export{le as default};
