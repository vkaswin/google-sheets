import{j as t,g as ce,r as d,c as X,a as ue,d as he}from"./index-b3267784.js";let me=[{label:"File"},{label:"Edit"},{label:"View"},{label:"Insert"},{label:"Format"},{label:"Data"},{label:"Tools"},{label:"Extensions"},{label:"Help"}];const fe=()=>{const f=b=>{console.log(b.target.innerText)};return t.jsxs("div",{className:"bg-light-silver h-[var(--toolbar-height)]",children:[t.jsxs("div",{className:"flex items-center h-[65px]",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{className:"w-[60px] h-[42px]",src:ce("/logo.png")}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-dark-gray font-medium text-base border border-transparent px-1 outline-none rounded-sm hover:border-gray-500 focus:border-gray-500",contentEditable:!0,onInput:f,dangerouslySetInnerHTML:{__html:"Untitled Spreadsheet"}}),t.jsx("i",{className:"icon-star-outline"}),t.jsx("i",{className:"icon-folder-move-outline"}),t.jsx("i",{className:"icon-cloud-check-outline"})]}),t.jsx("div",{className:"flex gap-1",children:me.map(({label:b},u)=>t.jsx("button",{className:"px-2 bg-transparent transition-background duration-100 hover:bg-light-gray text-[15px] rounded",children:b},u))})]})]}),t.jsx("div",{className:""})]}),t.jsx("div",{className:"flex items-center h-[45px] px-2 mx-[15px] rounded-full",children:"Toolbar"})]})},pe=()=>t.jsxs("div",{className:"flex gap-2 px-2 items-center h-[var(--typing-bar-height)]",children:[t.jsx("input",{name:"id",className:"outline-none w-[100px] px-2 bg-transparent text-sm border-2 rounded-sm border-transparent hover:bg-[#ededed] focus:border-dark-blue"}),t.jsx("div",{className:"w-[2px] bg-[#dadce0] h-[50%] border-none"}),t.jsxs("div",{className:"flex items-center w-full",children:[t.jsx("i",{className:"icon-format-text text-[#a8a9a9] font-bold"}),t.jsx("input",{name:"content",className:"w-full border-none outline-none bg-transparent px-2 text-sm"})]})]}),ge=({selectedGrid:{cell:f,column:b,row:u},onDoubleClick:r})=>{let{columnId:g,height:h,cellId:I,rowId:p,width:m,x:N,y:j}=f;return t.jsxs(d.Fragment,{children:[t.jsx("div",{className:"absolute flex text-sm bg-transparent border-2 border-blue p-1 z-10",style:{left:N,top:j,width:m,height:h},onDoubleClick:r}),t.jsx("div",{className:"absolute top-0 h-[var(--row-height)] bg-light-blue border border-light-gray",style:{left:N,width:m},children:t.jsx("span",{className:"absolute text-xs font-medium",style:{left:b.width/2-5,top:b.height/2-10},children:X(g)})}),t.jsx("div",{className:"absolute left-0 w-[var(--col-width)] bg-light-blue border border-light-gray",style:{top:j,height:h},children:t.jsx("span",{className:"absolute text-xs font-medium",style:{left:u.width/2-5,top:u.height/2-10},children:p})})]})},we=({cell:f,data:b,onWheel:u})=>{const r=d.useRef(null);let{x:g,y:h,rowId:I,height:p,columnId:m,width:N}=f,{color:j="#000000",backgroundColor:k="#FFFFFF",html:C=""}=b??{};d.useEffect(()=>{r.current&&a(r.current)},[f]);const a=w=>{let c=window.getSelection();if(!c)return;let x=document.createRange();x.setStart(w,w.childNodes.length),x.collapse(!0),c.removeAllRanges(),c.addRange(x)};return t.jsxs("div",{className:"absolute flex border-1 outline outline-3 outline-light-blue p-[2px] z-10",style:{width:N,height:p,left:g,top:h,backgroundColor:k,color:j},onWheel:u,children:[t.jsx("div",{ref:r,className:"w-full h-full text-sm outline outline-2 outline-dark-blue p-[2px]",contentEditable:!0,dangerouslySetInnerHTML:{__html:C}}),t.jsxs("div",{className:"absolute -top-7 left-0 bg-blue text-xs font-medium text-white rounded-sm px-2 py-1",children:[X(m),I]})]})},be=({columns:f,onClick:b,onResize:u})=>{const[r,g]=d.useState(null),[h,I]=d.useState(!1),p=d.useRef(null),m=d.useRef(null),N=a=>{!p.current||!r||(m.current=a.pageX,p.current.setPointerCapture(a.pointerId),p.current.addEventListener("pointermove",j),p.current.addEventListener("pointerup",k,{once:!0}),I(!0))},j=a=>{if(!p.current||!m.current||!r)return;let{pageX:w}=a,c=r.width+-(m.current-w);c<50||g({...r,width:c})},k=a=>{if(!p.current||!r||!m.current)return;let{pageX:w}=a;p.current.removeEventListener("pointermove",j);let c=r.width+-(m.current-w);u(r.columnId,Math.max(50,c)),m.current=null,g(null),I(!1)},C=a=>{g({...a})};return t.jsxs(d.Fragment,{children:[t.jsx("div",{className:"absolute left-0 top-0 w-full h-[var(--row-height)]",children:f.map(a=>{let{x:w,height:c,columnId:x,width:F,y:L}=a;return t.jsx("div",{className:"absolute",style:{width:F,height:c,left:w,top:L},onClick:()=>b(x),children:t.jsx("div",{className:"absolute top-0 -right-3 w-6 h-full bg-transparent z-10",onMouseEnter:()=>C(a)})},x)})}),r&&t.jsxs(d.Fragment,{children:[t.jsxs("div",{ref:p,className:"absolute flex gap-[5px] items-center cursor-col-resize z-10",style:{left:r.x+r.width-6,top:0,height:r.height},onPointerDown:N,children:[t.jsx("div",{className:"bg-black rounded-md w-[3px]",style:{height:r.height-8}}),t.jsx("div",{className:"bg-black rounded-md w-[3px]",style:{height:r.height-8}})]}),h&&t.jsx("div",{className:"absolute w-[3px] h-full bg-slate-400 z-10",style:{left:r.x+r.width-2,top:0}})]})]})},xe=({rows:f,onClick:b,onResize:u})=>{const[r,g]=d.useState(null),[h,I]=d.useState(!1),p=d.useRef(null),m=d.useRef(null),N=a=>{!p.current||!r||(m.current=a.pageY,p.current.setPointerCapture(a.pointerId),p.current.addEventListener("pointermove",j),p.current.addEventListener("pointerup",k,{once:!0}),I(!0))},j=a=>{if(!p.current||!m.current||!r)return;let{pageY:w}=a,c=r.height+-(m.current-w);c<=25||g({...r,height:c})},k=a=>{if(!p.current||!r||!m.current)return;let{pageY:w}=a;p.current.removeEventListener("pointermove",j);let c=r.height+-(m.current-w);u(r.rowId,Math.max(25,c)),m.current=null,g(null),I(!1)},C=a=>{g({...a})};return t.jsxs(d.Fragment,{children:[t.jsx("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-full",children:f.map(a=>{let{x:w,height:c,rowId:x,width:F,y:L}=a;return t.jsx("div",{className:"absolute",style:{width:F,height:c,left:w,top:L},onClick:()=>b(x),children:t.jsx("div",{className:"absolute left-0 -bottom-3 w-full h-6 bg-transparent z-10",onMouseEnter:()=>C(a)})},x)})}),r&&t.jsxs(d.Fragment,{children:[t.jsxs("div",{ref:p,className:"absolute flex flex-col items-center gap-[5px] cursor-row-resize z-10",style:{left:0,top:r.y+r.height-6,width:r.width},onPointerDown:N,children:[t.jsx("div",{className:"bg-black rounded-md h-[3px]",style:{width:r.width/2}}),t.jsx("div",{className:"bg-black rounded-md h-[3px]",style:{width:r.width/2}})]}),h&&t.jsx("div",{className:"absolute h-[3px] w-full bg-slate-400 z-10",style:{left:0,top:r.y+r.height-2}})]})]})};var U={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(f){(function(){var b={}.hasOwnProperty;function u(){for(var r=[],g=0;g<arguments.length;g++){var h=arguments[g];if(h){var I=typeof h;if(I==="string"||I==="number")r.push(h);else if(Array.isArray(h)){if(h.length){var p=u.apply(null,h);p&&r.push(p)}}else if(I==="object"){if(h.toString!==Object.prototype.toString&&!h.toString.toString().includes("[native code]")){r.push(h.toString());continue}for(var m in h)b.call(h,m)&&h[m]&&r.push(m)}}}return r.join(" ")}f.exports?(u.default=u,f.exports=u):window.classNames=u})()})(U);var ve=U.exports;const Ie=ue(ve),je=({cells:f})=>{let[b,u]=d.useState(!0),[r,g]=d.useState(0);const[h,I]=d.useState(["1,1","2,5","4,5","5,1","2,2"]);let p=d.useMemo(()=>new Set(h),[h]);d.useEffect(()=>(window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}),[]);const m=a=>{let{ctrlKey:w,key:c}=a;w&&c==="f"&&!b&&(a.preventDefault(),j())},N=a=>{console.log(a.target.value,h)},j=()=>{u(!b)},k=()=>{++r,r>h.length?g(0):g(r)},C=()=>{--r,r<0?g(h.length-1):g(r)};return b?t.jsxs(d.Fragment,{children:[t.jsxs("div",{className:"fixed flex items-center gap-2 top-6 right-6 border border-mild-gray rounded-md w-72 px-4 py-5",children:[t.jsx("input",{placeholder:"Find in sheet",className:"w-44 h-9 outline-dark-blue border border-mild-gray text-sm rounded px-2 py-2",onChange:he(N,500)}),t.jsx("i",{className:"bx-chevron-up text-gray-400 text-xl cursor-pointer",onClick:C}),t.jsx("i",{className:"bx-chevron-down text-gray-400 text-xl cursor-pointer",onClick:k}),t.jsx("i",{className:"bx-x text-xl text-dark-gray cursor-pointer",onClick:j})]}),f.map(({cellId:a,columnId:w,height:c,rowId:x,width:F,x:L,y:B})=>p.has(a)?t.jsx("div",{className:Ie("absolute",a===h[r]?"bg-[rgba(55,190,95,.702)]":"bg-[rgba(109,213,140,.4)]"),style:{width:F,height:c,left:`calc(${L}px - var(--col-width))`,top:`calc(${B}px - var(--row-height))`}},a):null)]}):null},Ce={rows:[{height:200,rowId:1},{height:35,rowId:2},{height:39,rowId:3},{height:50,rowId:4},{height:128,rowId:5},{height:77,rowId:6},{height:99,rowId:7},{height:100,rowId:13},{height:35,rowId:15},{height:39,rowId:33},{height:50,rowId:24},{height:128,rowId:45},{height:150,rowId:50},{height:77,rowId:66},{height:99,rowId:37}],columns:[{width:350,columnId:1},{width:175,columnId:2},{width:220,columnId:3},{width:270,columnId:5},{width:125,columnId:9}],cells:[{rowId:1,columnId:5,html:"Loreum Ispum"},{rowId:2,columnId:2,html:"Loreum Ispum"},{backgroundColor:"#CADAF8",color:"white",html:"<span>Loreum Ispum</span><br><span style='font-size:20px; font-color: red'>Loreum Ispum</span>",rowId:50,columnId:2},{backgroundColor:"#EA9999",color:"white",rowId:1,columnId:1,html:"<span>Loreum Ispum</span><br><span style='font-size:20px; font-color: red'>Loreum Ispum</span>"},{backgroundColor:"#B7E1CD",html:"<b>Loreum Ispum</b>",rowId:4,columnId:2},{backgroundColor:"#CADAF8",html:"<span>Loreum Ispum</span>",columnId:3,rowId:6},{html:"Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#FEE599",rowId:5,columnId:5},{html:"Lorem Ipsum Lorem Ipsum is simply dummy text of the printing Lorem Ipsum is simply dummy text of the printing",backgroundColor:"#B3A7D6",rowId:2,columnId:8},{backgroundColor:"#FFF2CC",html:"<b>Loreum Ispum</b>",rowId:12,columnId:6},{backgroundColor:"#B7B7B7",html:"<span>Loreum</span>",rowId:25,columnId:4},{html:"Loreum Ispum",rowId:9,columnId:3},{html:"Loreum Ispum",backgroundColor:"#766CEB",color:"white",rowId:80,columnId:5}]},M=46,T=25,W={width:100,height:25},ye=()=>{const[f,b]=d.useState([]),[u,r]=d.useState([]),[g,h]=d.useState([]),[I,p]=d.useState(""),[m,N]=d.useState(null),[j,k]=d.useState(0),{current:C}=d.useRef({}),{current:a}=d.useRef({}),{current:w}=d.useRef({}),c=d.useRef(null),x=d.useRef(null),F=d.useMemo(()=>{let e=g.find(({cellId:i})=>i===I);if(!e)return null;let[n,o]=I.split(","),l=f.find(i=>i.rowId===+o);return{column:u.find(i=>i.columnId===+n),row:l,cell:e}},[f,u,I]);d.useEffect(()=>{if(!c.current||!x.current)return;let e=x.current,{clientWidth:n,clientHeight:o}=c.current;e.width=n,e.height=o,L()},[]);const L=()=>{let{rows:e,cells:n,columns:o}=Ce;for(let l of e)C[l.rowId]=l;for(let l of o)a[l.columnId]=l;for(let l of n){let s=`${l.columnId},${l.rowId}`;w[s]=l}};d.useEffect(()=>{B()},[j]),d.useEffect(()=>(window.addEventListener("resize",B),()=>{window.removeEventListener("resize",B)}),[f,u]);const B=()=>{if(!c.current||!x.current)return;let{clientWidth:e,clientHeight:n}=c.current,o=x.current;o.width=e,o.height=n;let{rowId:l=1,y:s=T}=f[0]??{},{columnId:i=1,x:v=M}=u[0]??{};P({offsetX:v,offsetY:s,rowStart:l,colStart:i})},_=(e,{height:n,rowId:o,width:l,x:s,y:i})=>{e.clearRect(s,i,l,n),O(e,"#FFFFFF",{height:n,width:l,x:s,y:i}),e.save(),e.beginPath(),e.moveTo(s+l,i),e.lineTo(s+l,i+n),e.lineTo(s,i+n),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.textAlign="center",e.textBaseline="middle",e.font="12px Open-Sans",e.fillStyle="#575a5a",e.fillText(o.toString(),s+l/2,i+n/2),e.restore()},K=(e,{columnId:n,height:o,width:l,x:s,y:i})=>{e.clearRect(s,i,l,o),O(e,"#FFFFFF",{height:o,width:l,x:s,y:i}),e.save(),e.beginPath(),e.moveTo(s,i),e.lineTo(s+l,i),e.lineTo(s+l,i+o),e.lineTo(s,i+o),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.textAlign="center",e.textBaseline="middle",e.font="12px Open-Sans",e.fillStyle="#575a5a",e.fillText(X(n),s+l/2,i+o/2),e.restore()},O=(e,n,{x:o,y:l,height:s,width:i})=>{e.save(),e.fillStyle=n,e.beginPath(),e.moveTo(o,l),e.fillRect(o,l,i,s),e.fill(),e.restore()},V=(e,{height:n,width:o,x:l,y:s})=>{e.save(),e.beginPath(),e.moveTo(l,s+n),e.lineTo(l+o,s+n),e.lineTo(l+o,s),e.strokeStyle="#D5D5D5",e.lineWidth=2,e.stroke(),e.restore()},q=(e,n,{height:o,width:l,x:s,y:i})=>{e.font="14px Open-Sans",e.beginPath(),e.fillText(n,s,i+14)},J=(e,{cellId:n,rowId:o,columnId:l,height:s,width:i,x:v,y:R})=>{let{backgroundColor:D="#FFFFFF",color:A="#000000",html:H=""}=w[n]??{},z={x:v,y:R,width:i,height:s};e.clearRect(v,R,i,s),O(e,D,z),q(e,H,z),V(e,z)},P=({offsetX:e,offsetY:n,rowStart:o,colStart:l})=>{var H,z;if(!c.current||!x.current)return;let s=x.current.getContext("2d"),{clientWidth:i,clientHeight:v}=c.current,R=[],D=[],A=[];for(let y=o,S=n;S<v;y++){let E=((H=C[y])==null?void 0:H.height)||W.height;S+E>T&&R.push({y:S,x:0,rowId:y,height:E,width:M}),S+=E}for(let y=l,S=e;S<i;y++){let E=((z=a[y])==null?void 0:z.width)||W.width;S+E>M&&D.push({x:S,y:0,columnId:y,width:E,height:T}),S+=E}for(let{rowId:y,height:S,y:E}of R)for(let{width:ie,x:ae,columnId:G}of D){let de=`${G},${y}`;A.push({x:ae,y:E,rowId:y,columnId:G,width:ie,height:S,cellId:de}),J(s,A.at(-1))}for(let y of R)_(s,y);for(let y of D)K(s,y);b(R),r(D),h(A)},Y=e=>{if(!c.current)return;let n=e.pageX,o=e.pageY-c.current.getBoundingClientRect().top,l=Q(n,o);l&&(p(l),N(null))},Q=(e,n)=>{let o=0,l=f.length-1,s=null;for(;o<=l;){let v=Math.floor((o+l)/2);f[v].y<=n?(o=v+1,s=f[v].rowId):l=v-1}if(!s)return null;o=0,l=u.length-1;let i=null;for(;o<=l;){let v=Math.floor((o+l)/2);u[v].x<=e?(o=v+1,i=u[v].columnId):l=v-1}return i?`${i},${s}`:null},Z=e=>{var i;if(!f.length||!u.length)return;let{rowId:n,y:o}=f[0],{columnId:l,x:s}=u[0];if(e<0){for(o+=-e,n--;n>0&&o>T;)o-=((i=C[n])==null?void 0:i.height)??W.height,n--;P({offsetX:s,offsetY:Math.min(T,o),rowStart:n+1,colStart:l})}else P({offsetX:s,offsetY:o+-e,rowStart:n,colStart:l})},ee=e=>{var i;if(!f.length||!u.length)return;let{rowId:n,y:o}=f[0],{columnId:l,x:s}=u[0];if(e<0){for(s+=-e,l--;l>0&&s>M;)s-=((i=a[l])==null?void 0:i.width)??W.width,l--;P({offsetX:Math.min(M,s),offsetY:o,rowStart:n,colStart:l+1})}else P({offsetX:s+-e,offsetY:o,rowStart:n,colStart:l})},$=e=>{let{deltaX:n,deltaY:o}=e;n===0?Z(o):ee(n)},te=()=>{if(!c.current||!F)return;let{columnId:e,cellId:n,width:o,height:l,rowId:s,x:i,y:v}=F.cell,{top:R}=c.current.getBoundingClientRect();N({cellId:n,columnId:e,width:o,height:l,rowId:s,x:Math.max(M,i),y:Math.max(T+R,v+R)})},le=e=>{e.preventDefault(),Y(e)},re=e=>{console.log(e)},ne=e=>{console.log(e)},oe=(e,n)=>{a[e]?a[e].width=n:a[e]={columnId:e,width:n},k(Math.random())},se=(e,n)=>{C[e]?C[e].height=n:C[e]={rowId:e,height:n},k(Math.random())};return t.jsxs(d.Fragment,{children:[t.jsxs("div",{ref:c,className:"relative h-[var(--grid-height)] select-none overflow-hidden",onClick:Y,onContextMenu:le,onWheel:$,children:[t.jsx("canvas",{ref:x,className:"relative"}),t.jsx("div",{className:"absolute left-0 top-0 w-[var(--col-width)] h-[var(--row-height)] border-b-4 border-r-4 border-t border-l border-light-gray bg-white z-20"}),t.jsx(be,{columns:u,onClick:re,onResize:oe}),t.jsx(xe,{rows:f,onClick:ne,onResize:se}),!m&&F&&t.jsx(ge,{selectedGrid:F,onDoubleClick:te}),t.jsx("div",{className:"absolute left-[var(--col-width)] top-[var(--row-height)] w-full h-full overflow-hidden",children:t.jsx(je,{cells:g})})]}),m&&t.jsx(we,{cell:m,data:w[m.cellId],onWheel:$})]})},Ne=()=>t.jsx("div",{className:"fixed left-0 bottom-0 w-full h-[var(--bottom-bar-height)] bg-light-silver border-t border-mild-silver",children:"Bottom Bar"}),ke=()=>t.jsxs(d.Fragment,{children:[t.jsx(fe,{}),t.jsx(pe,{}),t.jsx(ye,{}),t.jsx(Ne,{})]});export{ke as default};
