import{j as t,g as ae,r as a,t as he}from"./index-795b1b4a.js";const ue=()=>{let C=[{label:"File"},{label:"Edit"},{label:"View"},{label:"Insert"},{label:"Format"},{label:"Data"},{label:"Tools"},{label:"Extensions"},{label:"Help"}];return t.jsxs("div",{className:"bg-light-silver h-[var(--toolbar-height)]",children:[t.jsxs("div",{className:"flex items-center h-[65px]",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{className:"w-[60px] h-[42px]",src:ae("/logo.png")}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-dark-gray font-medium text-base border border-transparent px-1 outline-none rounded-sm hover:border-gray-500 focus:border-gray-500",contentEditable:!0,children:"Untitled Spreadsheet"}),t.jsx("i",{className:"icon-star-outline"}),t.jsx("i",{className:"icon-folder-move-outline"}),t.jsx("i",{className:"icon-cloud-check-outline"})]}),t.jsx("div",{className:"flex gap-1",children:C.map(({label:A},F)=>t.jsx("button",{className:"px-2 bg-transparent transition-background duration-100 hover:bg-light-gray text-[15px] rounded",children:A},F))})]})]}),t.jsx("div",{className:""})]}),t.jsx("div",{className:"flex items-center bg-light-blue h-[45px] px-2 mx-[15px] rounded-full",children:"Toolbar"})]})},ce=()=>t.jsxs("div",{className:"flex gap-2 px-2 items-center h-[var(--typing-bar-height)]",children:[t.jsx("input",{name:"id",className:"outline-none w-[100px] px-2 bg-transparent text-sm border-2 rounded-sm border-transparent hover:bg-[#ededed] focus:border-dark-blue"}),t.jsx("div",{className:"w-[2px] bg-[#dadce0] h-[50%] border-none"}),t.jsxs("div",{className:"flex items-center w-full",children:[t.jsx("i",{className:"icon-format-text text-[#a8a9a9] font-bold"}),t.jsx("input",{name:"content",className:"w-full border-none outline-none bg-transparent px-2 text-sm"})]})]});let i={width:100,height:25};const me=({sheetDetail:{meta:{columnIds:C,totalRows:A},cells:F,columns:V,rows:$}})=>{let x=a.useRef(null),y=a.useRef(null),N=a.useRef(null),T=a.useRef([]),R=a.useRef([]),S=a.useRef([]),G=a.useRef(!1),B=a.useRef(!1),[s,D]=a.useState(),[f,P]=a.useState(),[g,M]=a.useState();a.useEffect(()=>{if(K(),!!N.current)return W({rowStart:1,colStart:1}),window.addEventListener("resize",U),()=>{window.addEventListener("resize",U)}},[]);let U=()=>{if(!x.current||!y.current)return;let{clientWidth:e,clientHeight:r}=x.current;y.current.width=e,y.current.height=r;let l=R.current[0].id,n=S.current[0].id;W({rowStart:l,colStart:n})},J=e=>{e.clearRect(0,0,i.width/2,i.height),k(e),e.beginPath(),e.moveTo(0,i.height),e.lineTo(i.width/2,i.height),e.lineTo(i.width/2,1),e.lineTo(0,1),e.fillStyle="#C7C7C7",e.fillRect(0,i.height-5,i.width/2,5),e.fillRect(i.width/2-5,0,5,i.height),e.stroke(),L(e)},K=()=>{if(!x.current||!y.current)return;let{clientWidth:e,clientHeight:r}=x.current,l=y.current,n=l.getContext("2d");n&&(N.current=n,l.width=e,l.height=r)},Q=(e,{x:r,width:l,id:n})=>{k(e),e.beginPath(),e.moveTo(r,1),e.lineTo(r+l,1),e.lineTo(r+l,i.height),e.lineTo(r,i.height),e.fillText(n,r+l/2,i.height/2),e.stroke(),L(e)},Z=(e,{x:r,y:l,height:n,id:h})=>{k(e),e.beginPath(),e.moveTo(r,l+n),e.lineTo(i.width/2,l+n),e.fillText(h.toString(),i.width/4,l+n/2),e.stroke(),L(e)},H=e=>{e.fillStyle="#000000",e.font="10px sans-serif",e.textAlign="start",e.textBaseline="alphabetic"},k=e=>{e.strokeStyle="silver",e.fillStyle="#545454",e.font="14px Open-Sans",e.textAlign="center",e.textBaseline="middle"},L=e=>{e.strokeStyle="#000000",e.fillStyle="#000000",e.font="10px sans-serif",e.textAlign="start",e.textBaseline="alphabetic"},q=(e,{x:r,y:l,width:n,height:h})=>{k(e),e.beginPath(),e.moveTo(r,l),e.lineTo(r,l+h),e.lineTo(r+n,l+h),e.stroke(),L(e)},_=(e,r,l)=>{let{x:n,y:h,width:o,height:d}=r;if(e.clearRect(n,h+1,o,d),q(e,r),!l)return;let{text:c,color:v,backgroundColor:w}=l;e.font="14px Open-Sans",e.textBaseline="middle",w&&(e.beginPath(),e.fillStyle=w||"#000000",e.fillRect(n,h,o,d),e.fill()),c&&(e.beginPath(),e.fillStyle=v||"#000000",e.fillText(c,n+5,h+d-10),e.fill()),H(e)},ee=(e,{x:r,y:l})=>{k(e),e.beginPath(),e.moveTo(r,l),e.lineTo(r,e.canvas.height),e.stroke(),H(e),B.current=!0},te=(e,{x:r,y:l})=>{k(e),e.beginPath(),e.moveTo(r,l),e.lineTo(r,e.canvas.width),e.stroke(),H(e),G.current=!0},le=()=>{if(s){let e=T.current.find(({id:r})=>r===s.id);D(e?{...e,hidden:!1}:{...s,hidden:!0})}if(g){let e=S.current.find(({id:r})=>r===g.id);M(e?{...e,hidden:!1}:{...g,hidden:!0})}if(f){let e=R.current.find(({id:r})=>r===f.id);P(e?{...e,hidden:!1}:{...f,hidden:!0})}},W=({colStart:e,rowStart:r})=>{var v,w;let l=N.current;if(!l)return;let n=l.canvas.width,h=l.canvas.height,o=i.height;T.current=[],R.current=[],S.current=[],l.clearRect(0,0,n,h);let d=!1;B.current=!1,G.current=!1;let c=A+1;for(let u=r;u<=c&&o<h;u++){if(u===c){te(l,{x:0,y:o});break}let b=((v=$[u])==null?void 0:v.height)||i.height,m=i.width/2,p={x:0,y:o,height:b,id:u,width:i.width/2};Z(l,p),R.current.push(p);for(let j=e;j<=C.length&&m<n;j++){let E=C[j-1];if(E==="null"){if(B.current)break;ee(l,{x:m,y:i.height});break}let X=`${E}${u}`,I=((w=V[E])==null?void 0:w.width)||i.width,de=F[X],Y={x:m,y:0,width:I,id:j,height:i.height},z={x:m,y:o,width:I,height:b,row:p,column:Y,id:X};d||(Q(l,{x:m,width:I,id:E}),S.current.push(Y)),_(l,z,de),T.current.push(z),m+=I}o+=b,d=!0}J(l),le()};const re=e=>{if(!N.current)return;let{deltaY:l,deltaX:n}=e,h=l===0?"left":"top",o=R.current[0].id,d=S.current[0].id;if(h==="top"){if(l>0&&G.current)return;let c=2;o=Math.max(1,l>0?o+c:o-c)}else{if(n>0&&B.current)return;let c=1;d=Math.max(1,n>0?d+c:d-c)}W({rowStart:o,colStart:d})},ie=e=>{e.preventDefault()};let ne=e=>{if(!x.current)return;let{top:r,left:l}=x.current.getBoundingClientRect(),{clientX:n,clientY:h}=e,o=n-l,d=h-r,c,v,w;if(d<=i.height){let u=S.current.find(({x:b,y:m,width:p})=>o>=b&&o<=b+p&&d>=m&&d<=m+i.height);u&&(v={...u,hidden:!1})}else if(o<=i.width/2){let u=R.current.find(({x:b,y:m,height:p})=>o>=b&&o<=b+i.width&&d>=m&&d<=m+p);u&&(w={...u,hidden:!1})}else{let u=T.current.find(({width:b,height:m,x:p,y:j})=>o>=p&&o<=p+b&&d>=j&&d<=j+m);u&&(c={...u,hidden:!1})}D(c),P(w),M(v)},O=a.useMemo(()=>s?{cell:{width:s.width+"px",height:s.height+"px",top:s.y+"px",left:s.x+"px"},row:{width:s.row.width+"px",height:s.row.height+"px",top:s.row.y+"px",left:s.row.x+"px"},column:{width:s.column.width+"px",height:s.column.height+"px",top:s.column.y+"px",left:s.column.x+"px"}}:{},[s]),se=a.useMemo(()=>f?{left:f.x+"px",top:f.y+"px",height:f.height+"px","--cell-width":f.width+"px"}:{},[f]),oe=a.useMemo(()=>g?{width:g.width+"px",left:g.x+"px",top:g.y+"px","--cell-height":g.height+"px"}:{},[g]);return t.jsxs("div",{ref:x,className:"relative h-[var(--grid-height)] overflow-hidden",onContextMenu:ie,onClick:ne,onWheel:he(re,50),children:[s&&!s.hidden&&t.jsxs(a.Fragment,{children:[t.jsx("div",{className:"absolute border-2 border-medium-light-blue",style:O.cell}),t.jsx("div",{className:"absolute flex items-center justify-center bg-mild-blue text-dark-gray text-sm border-1 border-silver",style:O.row,children:t.jsx("b",{children:s.row.id})}),t.jsx("div",{className:"absolute flex items-center justify-center bg-mild-blue text-dark-gray text-sm border-1 border-silver",style:O.column,children:t.jsx("b",{children:C[s.column.id-1]})})]}),f&&!f.hidden&&t.jsxs("div",{className:"absolute flex w-full border-t border-b border-medium-light-blue",style:se,children:[t.jsx("div",{className:"flex w-[var(--cell-width)] justify-center items-center bg-dark-blue text-white text-sm",children:t.jsx("b",{children:f.id})}),t.jsx("div",{className:"bg-medium-light-blue opacity-10 w-[calc(100%-var(--cell-width))]"})]}),g&&!g.hidden&&t.jsxs("div",{className:"absolute w-[calc(--cell-width)] h-full border-l border-r border-medium-light-blue",style:oe,children:[t.jsx("div",{className:"flex h-[var(--cell-height)] justify-center items-center bg-dark-blue text-white text-sm",children:t.jsx("b",{children:C[g.id-1]})}),t.jsx("div",{className:"bg-medium-light-blue opacity-10 h-[calc(100%-var(--cell-height))]"})]}),t.jsx("canvas",{ref:y})]})},fe=()=>t.jsx("div",{className:"fixed left-0 bottom-0 w-full h-[var(--bottom-bar-height)] bg-light-silver border-t border-mild-silver",children:"Bottom Bar"}),ge={meta:{totalRows:1e3,dimension:{width:26*100,height:100*25},columnIds:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","null"]},rows:{1:{height:100},2:{height:35},3:{height:39},4:{height:50},5:{height:128},6:{height:77},7:{height:99},13:{height:100},15:{height:35},33:{height:39},24:{height:50},45:{height:128},50:{height:150},66:{height:77},37:{height:99}},columns:{A:{width:150},B:{width:175},C:{width:220},E:{width:270},H:{width:125}},cells:{B50:{text:"Loreum Ispum Loreum Ispum",backgroundColor:"#CADAF8",color:"white"},A1:{text:"Loreum Ispum Loreum Ispum",backgroundColor:"#EA9999",color:"white"},B4:{text:"Loreum Ispum",backgroundColor:"#B7E1CD"},C6:{text:"Loreum Ispum",backgroundColor:"#CADAF8"},E5:{text:"Loreum Ispum",backgroundColor:"#FEE599"},H2:{text:"Loreum Ispum",backgroundColor:"#B3A7D6"},F12:{text:"Loreum Ispum Loreum Ispum",backgroundColor:"#FFF2CC"},D25:{text:"Loreum",backgroundColor:"#B7B7B7"},C9:{text:"Loreum Ispum"},E80:{text:"Loreum Ispum",backgroundColor:"#766CEB",color:"white"}}},pe=()=>t.jsxs(a.Fragment,{children:[t.jsx(ue,{}),t.jsx(ce,{}),t.jsx(me,{sheetDetail:ge}),t.jsx(fe,{})]});export{pe as default};
